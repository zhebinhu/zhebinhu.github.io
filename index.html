<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="eUR5SKlr43nnaOTR9jYvH7hmuRFkEWSOzCOoR7kUeNk" />
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>huzb的小书斋</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一枚前行的小码农">
<meta property="og:type" content="website">
<meta property="og:title" content="huzb的小书斋">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="huzb的小书斋">
<meta property="og:description" content="一枚前行的小码农">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="huzb的小书斋">
<meta name="twitter:description" content="一枚前行的小码农">
  
    <link rel="alternative" href="/atom.xml" title="huzb的小书斋" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/headicon.jpg">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

  <script src="https://cdn.bootcss.com/pangu/3.3.0/pangu.min.js"></script>
</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/headicon.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">huzb</a></h1>
		</hgroup>
		
		<p class="header-subtitle">念念不忘，必有回响</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/photos/">相册</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/zhebinhu" title="github"><i class="icon-github"></i></a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/hu-zhe-bin-91/activities" title="zhihu"><i class="icon-zhihu"></i></a>
		        
					<a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=huzhebin2017@gmail.com" title="mail"><i class="icon-mail"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/headicon.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">huzb</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>念念不忘，必有回响<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/zhebinhu" title="github"><i class="icon-github"></i></a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/hu-zhe-bin-91/activities" title="zhihu"><i class="icon-zhihu"></i></a>
			        
						<a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=huzhebin2017@gmail.com" title="mail"><i class="icon-mail"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 50%"><a href="/">主页</a></li>
		        
					<li style="width: 50%"><a href="/photos/">相册</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-Spring 源码浅析——创建单例 bean 对象" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/04/Spring 源码浅析——创建单例 bean 对象/">Spring 源码浅析——创建单例 bean 对象</a>
    </h1>
  

        
        <a href="/2019/03/04/Spring 源码浅析——创建单例 bean 对象/" class="archive-article-date">
  	<time datetime="2019-03-04T09:52:47.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-03-04</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>上一篇概览了源码中容器刷新的部分，但是略过了其中最重要的对象初始化和注入部分。这一篇就以一个普通单例对象为例，看它是如何加入到容器中的。</p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>首先定义一个类：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在配置类中加入如下配置：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">person</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Person();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>那么 Spring 会把一个 Person 类型的对象注入容器中</p>
<h2 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h2><p>直接进入上一篇中略过的<code>finishBeanFactoryInitialization(beanFactory)</code>方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finishBeanFactoryInitialization</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 为容器设置一个全局类型转换器，默认没有；类型转换器可以自定义，常见的有 String 转 Date 的类型转换器</span></span><br><span class="line">    <span class="keyword">if</span> (beanFactory.containsBean(CONVERSION_SERVICE_BEAN_NAME) &amp;&amp;</span><br><span class="line">            beanFactory.isTypeMatch(CONVERSION_SERVICE_BEAN_NAME, ConversionService.class)) &#123;</span><br><span class="line">        beanFactory.setConversionService(</span><br><span class="line">                beanFactory.getBean(CONVERSION_SERVICE_BEAN_NAME, ConversionService.class));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 检查 beanFactory 是否没有内嵌值解析器，默认是有的</span></span><br><span class="line">    <span class="keyword">if</span> (!beanFactory.hasEmbeddedValueResolver()) &#123;</span><br><span class="line">        beanFactory.addEmbeddedValueResolver(strVal -&gt; getEnvironment().resolvePlaceholders(strVal));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 加载第三方模块，如 AspectJ；默认没有</span></span><br><span class="line">    String[] weaverAwareNames = beanFactory.getBeanNamesForType(LoadTimeWeaverAware.class, <span class="keyword">false</span>, <span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">for</span> (String weaverAwareName : weaverAwareNames) &#123;</span><br><span class="line">        getBean(weaverAwareName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 停用临时类加载器</span></span><br><span class="line">    beanFactory.setTempClassLoader(<span class="keyword">null</span>);</span><br><span class="line">    <span class="comment">// 禁止对除了 bean definition metadata 缓存之外的配置进行修改</span></span><br><span class="line">    beanFactory.freezeConfiguration();</span><br><span class="line">    <span class="comment">// 实例化所有剩余的不指定懒加载的单例对象（核心部分）</span></span><br><span class="line">    beanFactory.preInstantiateSingletons();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到核心的函数就是最后一行<code>beanFactory.preInstantiateSingletons();</code>，它会对所有剩余的不指定懒加载的单例对象进行实例化操作。我们进入<code>beanFactory.preInstantiateSingletons();</code>中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preInstantiateSingletons</span><span class="params">()</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">    <span class="comment">// 获取所有的 bean 定义信息</span></span><br><span class="line">    List&lt;String&gt; beanNames = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="keyword">this</span>.beanDefinitionNames);</span><br><span class="line">    <span class="comment">// 开始实例化所有还未实例化的不指定懒加载的单例对象</span></span><br><span class="line">    <span class="keyword">for</span> (String beanName : beanNames) &#123;</span><br><span class="line">        <span class="comment">// 合并父 BeanDefinition 与子 BeanDefinition，见附录</span></span><br><span class="line">        RootBeanDefinition bd = getMergedLocalBeanDefinition(beanName);</span><br><span class="line">        <span class="comment">// 判断 bean 是否抽象、是否单例、是否懒加载</span></span><br><span class="line">        <span class="keyword">if</span> (!bd.isAbstract() &amp;&amp; bd.isSingleton() &amp;&amp; !bd.isLazyInit()) &#123;</span><br><span class="line">            <span class="comment">// FactoryBean 类型的 bean 进行实例化</span></span><br><span class="line">            <span class="keyword">if</span> (isFactoryBean(beanName)) &#123;</span><br><span class="line">                <span class="comment">// 获取 FactoryBean 的工厂本身（以&amp;开头），如果没有则创建</span></span><br><span class="line">                Object bean = getBean(FACTORY_BEAN_PREFIX + beanName);</span><br><span class="line">                <span class="keyword">if</span> (bean <span class="keyword">instanceof</span> FactoryBean) &#123;</span><br><span class="line">                    <span class="keyword">final</span> FactoryBean&lt;?&gt; factory = (FactoryBean&lt;?&gt;) bean;</span><br><span class="line">                    <span class="keyword">boolean</span> isEagerInit;</span><br><span class="line">                    <span class="comment">// 这里需要判断是不是 SmartFactoryBean，因为 SmartFactoryBean 会定义一个 isEagerInit() 方法来决定 getObject() 的实例对象是否懒加载</span></span><br><span class="line">                    <span class="keyword">if</span> (System.getSecurityManager() != <span class="keyword">null</span> &amp;&amp; factory <span class="keyword">instanceof</span> SmartFactoryBean) &#123;</span><br><span class="line">                        isEagerInit = AccessController.doPrivileged((PrivilegedAction&lt;Boolean&gt;)</span><br><span class="line">                                        ((SmartFactoryBean&lt;?&gt;) factory)::isEagerInit,</span><br><span class="line">                                getAccessControlContext());</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        isEagerInit = (factory <span class="keyword">instanceof</span> SmartFactoryBean &amp;&amp;</span><br><span class="line">                                ((SmartFactoryBean&lt;?&gt;) factory).isEagerInit());</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 对非懒加载的 bean 实例化</span></span><br><span class="line">                    <span class="keyword">if</span> (isEagerInit) &#123;</span><br><span class="line">                        getBean(beanName);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 没有实现 FactoryBean 接口的直接实例化</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                getBean(beanName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用所有 SmartInitializingSingleton 类型的实现类的 afterSingletonsInstantiated 方法；通过名字可以知道它表示单例对象实例化后需要做的操作</span></span><br><span class="line">    <span class="keyword">for</span> (String beanName : beanNames) &#123;</span><br><span class="line">        Object singletonInstance = getSingleton(beanName);</span><br><span class="line">        <span class="keyword">if</span> (singletonInstance <span class="keyword">instanceof</span> SmartInitializingSingleton) &#123;</span><br><span class="line">            <span class="keyword">final</span> SmartInitializingSingleton smartSingleton = (SmartInitializingSingleton) singletonInstance;</span><br><span class="line">            <span class="keyword">if</span> (System.getSecurityManager() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                AccessController.doPrivileged((PrivilegedAction&lt;Object&gt;) () -&gt; &#123;</span><br><span class="line">                    smartSingleton.afterSingletonsInstantiated();</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                &#125;, getAccessControlContext());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                smartSingleton.afterSingletonsInstantiated();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可看出，不管是 FactoryBean 对象本身、FactoryBean 的 getObject() 创建的对象还是普通单例对象，最终都会依赖<code>getBean(beanName)</code>这个方法来实例化对象。我们进入这个方法来看：<br>```java</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">Java</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Spring</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/03/04/Spring 源码浅析——创建单例 bean 对象/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Spring 源码浅析——容器刷新流程概览" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/03/Spring 源码浅析——容器刷新流程概览/">Spring 源码浅析——容器刷新流程概览</a>
    </h1>
  

        
        <a href="/2019/03/03/Spring 源码浅析——容器刷新流程概览/" class="archive-article-date">
  	<time datetime="2019-03-03T09:08:49.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-03-03</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>本文是 Spring 源码浅析系列的第一篇。Spring 版本是 Spring Boot 2.1.2.RELEASE （即 Spring 5.1.4），以默认配置启动，分析框架工作的原理。</p>
<p>众所周知，Spring 以容器管理所有的 bean 对象，容器的实体是一个 BeanFactory 对象。但我们常用的容器是另一个 ApplicationContext ，它在内部持有了 BeanFactory，所有和 BeanFactory 相关的操作都会委托给内部的 BeanFactory 来完成。</p>
<p>ApplicationContext 的继承关系如下图所示：</p>
<p><img src="/2019/03/03/Spring 源码浅析——容器刷新流程概览/ApplicationContext 继承关系.png"></p>
<p>ApplicationContext 是一个接口，<strong>ClassPathXmlApplicationContext</strong>和<strong>AnnotationConfigApplicationContext</strong>是两个比较常用的实现类，前者基于 xml 使用，后者基于注解使用。SpringBoot 中默认后面一种。</p>
<p>ApplicationContext 也继承了 BeanFactory 接口，BeanFactory 的继承关系如下图所示：</p>
<p><img src="/2019/03/03/Spring 源码浅析——容器刷新流程概览/BeanFactory 继承关系.png"></p>
<p>从继承关系我们可以获得以下信息：</p>
<ul>
<li>ApplicationContext 继承了 ListableBeanFactory，这个 Listable 的意思就是，通过这个接口，我们可以获取多个 Bean，最顶层 BeanFactory 接口的方法都是获取单个 Bean 的。</li>
<li>ApplicationContext 继承了 HierarchicalBeanFactory，Hierarchical 的意思是说我们可以在应用中起多个 BeanFactory，然后可以将各个 BeanFactory 设置为父子关系。</li>
</ul>
<p>ApplicationContext 非常重要，所以我们第一篇就看一下 ApplicationContext 初始化的过程。默认配置下，SpringBoot 中的 ApplicationContext 初始化在 refresh() 方法中，为什么叫 refresh() 而不是 init() 呢？因为 ApplicationContext 建立起来以后，其实我们是可以通过调用 refresh() 这个方法重建的，这样会将原来的 ApplicationContext 销毁，然后再重新执行一次初始化操作。</p>
<h2 id="1、容器刷新概览"><a href="#1、容器刷新概览" class="headerlink" title="1、容器刷新概览"></a>1、容器刷新概览</h2><p>refresh() 是个总览全局的方法，我们可以通过这个方法概览容器刷新的过程：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> <span class="keyword">throws</span> BeansException, IllegalStateException </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="keyword">this</span>.startupShutdownMonitor) &#123;</span><br><span class="line">        <span class="comment">// 准备工作，记录下容器的启动时间、标记“已启动”状态、检验配置文件格式</span></span><br><span class="line">        prepareRefresh();</span><br><span class="line">        <span class="comment">// ClassPathXmlApplicationContext 会在这里解析 xml 配置；AnnotationConfigApplicationContext 的解析发在初始化，这里只是简单的获取</span></span><br><span class="line">        <span class="comment">// 这里的解析是指把配置信息都提取出来了，保存在了一个 Map&lt;String,BeanDefinition&gt; 中</span></span><br><span class="line">        ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</span><br><span class="line">        <span class="comment">// 设置 BeanFactory 的类加载器，添加几个 BeanPostProcessor，手动注册几个特殊的 bean 等</span></span><br><span class="line">        prepareBeanFactory(beanFactory);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// BeanFactory 准备工作完成后进行的后置处理工作，子类可以自定义实现，Spring Boot 中是个空方法</span></span><br><span class="line">            postProcessBeanFactory(beanFactory);</span><br><span class="line">            <span class="comment">//=======以上是 BeanFactory 的预准备工作=======</span></span><br><span class="line">            <span class="comment">// 调用 BeanFactoryPostProcessor 各个实现类的 postProcessBeanFactory(factory) 方法</span></span><br><span class="line">            invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class="line">            <span class="comment">// 注册 BeanPostProcessor 的实现类（注意和之前的 BeanFactoryPostProcessor 的区别）</span></span><br><span class="line">            registerBeanPostProcessors(beanFactory);</span><br><span class="line">            <span class="comment">// 初始化 MessageSource 组件（做国际化功能；消息绑定，消息解析）</span></span><br><span class="line">            initMessageSource();</span><br><span class="line">            <span class="comment">// 初始化当前 ApplicationContext 的事件广播器</span></span><br><span class="line">            initApplicationEventMulticaster();</span><br><span class="line">            <span class="comment">// 具体的子类可以在这里初始化一些特殊的 Bean（在初始化 singleton beans 之前），Spring Boot 中默认没有定义</span></span><br><span class="line">            onRefresh();</span><br><span class="line">            <span class="comment">// 注册事件监听器，监听器需要实现 ApplicationListener 接口</span></span><br><span class="line">            registerListeners();</span><br><span class="line">            <span class="comment">// 初始化所有的 singleton beans（lazy-init 的除外）</span></span><br><span class="line">            finishBeanFactoryInitialization(beanFactory);</span><br><span class="line">            <span class="comment">// 容器刷新完成操作</span></span><br><span class="line">            finishRefresh();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (BeansException ex) &#123;</span><br><span class="line">            <span class="keyword">if</span> (logger.isWarnEnabled()) &#123;</span><br><span class="line">                logger.warn(<span class="string">"Exception encountered during context initialization - "</span> +</span><br><span class="line">                        <span class="string">"cancelling refresh attempt: "</span> + ex);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Destroy already created singletons to avoid dangling resources.</span></span><br><span class="line">            destroyBeans();</span><br><span class="line">            <span class="comment">// Reset 'active' flag.</span></span><br><span class="line">            cancelRefresh(ex);</span><br><span class="line">            <span class="comment">// Propagate exception to caller.</span></span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// Reset common introspection caches in Spring's core, since we</span></span><br><span class="line">            <span class="comment">// might not ever need metadata for singleton beans anymore...</span></span><br><span class="line">            resetCommonCaches();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>通过上面的代码和注释我们总览了容器刷新的整个流程，下面我们来一步步探索每个环节都做了什么。</p>
<h2 id="2、刷新前的准备工作：prepareRefresh"><a href="#2、刷新前的准备工作：prepareRefresh" class="headerlink" title="2、刷新前的准备工作：prepareRefresh()"></a>2、刷新前的准备工作：prepareRefresh()</h2><p>这步比较简单，直接看代码中的注释即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">prepareRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 记录启动时间，</span></span><br><span class="line">    <span class="comment">// 将 active 属性设置为 true，closed 属性设置为 false，它们都是 AtomicBoolean 类型</span></span><br><span class="line">    <span class="keyword">this</span>.startupDate = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">this</span>.closed.set(<span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">this</span>.active.set(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initialize any placeholder property sources in the context environment</span></span><br><span class="line">    <span class="comment">// Spring Boot 中是个空方法</span></span><br><span class="line">    initPropertySources();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 校验配置属性的合法性</span></span><br><span class="line">    getEnvironment().validateRequiredProperties();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记录早期的事件</span></span><br><span class="line">    <span class="keyword">this</span>.earlyApplicationEvents = <span class="keyword">new</span> LinkedHashSet&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3、获取-Bean-容器"><a href="#3、获取-Bean-容器" class="headerlink" title="3、获取 Bean 容器"></a>3、获取 Bean 容器</h2><p>前面说过 ApplicationContext 内部持有了一个 BeanFactory，这步就是获取 ApplicationContext 中的 BeanFactory。在 ClassPathXmlApplicationContext 中会做很多工作，因为一开始 ClassPathXmlApplicationContext 中的 BeanFactory 并没有创建，但在 AnnotationConfigApplicationContext 比较简单，直接返回即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> ConfigurableListableBeanFactory <span class="title">obtainFreshBeanFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 通过 cas 设置刷新状态</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.refreshed.compareAndSet(<span class="keyword">false</span>, <span class="keyword">true</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(</span><br><span class="line">                <span class="string">"GenericApplicationContext does not support multiple refresh attempts: just call 'refresh' once"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 设置序列号</span></span><br><span class="line">    <span class="keyword">this</span>.beanFactory.setSerializationId(getId());</span><br><span class="line">    <span class="comment">// 返回已创建的 BeanFactory</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.beanFactory;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4、准备-Bean-容器：prepareBeanFactory"><a href="#4、准备-Bean-容器：prepareBeanFactory" class="headerlink" title="4、准备 Bean 容器：prepareBeanFactory()"></a>4、准备 Bean 容器：prepareBeanFactory()</h2><p>BeanFactory 获取之后并不能马上使用，还要在 BeanFactory 中做一些准备工作，包括类加载器、表达式解析器的设置，几个特殊的 BeanPostProcessor 的添加等。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我们大致浏览了一遍 Spring 容器刷新的过程，通过源码我们可以总结出以下几点：</p>
<ul>
<li>Spring 容器在启动的时候，先会将所有注册进来的 Bean 的定义信息保存在 beanDefinitionMap 中，然后在合适的时机创建这些 bean：<br>　　用到这个 bean 的时候，利用 getBean() 创建 bean，创建好以后保存在容器中；<br>　　finishBeanFactoryInitialization() 统一创建剩下所有的 bean；</li>
<li>Spring 的诸多功能都依赖于后置处理器（BeanFactoryPostProcessor 和 BeanPostProcessor）的实现，后置处理器工作在各种时期（容器准备完成、bean 初始化之前、bean 初始化之后、容器刷新完成等等），常见的有：<br>　　AutowiredAnnotationBeanPostProcessor：处理自动注入；<br>　　AnnotationAwareAspectJAutoProxyCreator：来做 AOP 功能；<br>　　InstantiationAwareBeanPostProcessor：对象初始化前后；<br>　　DestructionAwareBeanPostProcessor：对象销毁前；</li>
<li>容器的刷新过程分为两个阶段：容器准备和对象初始化注入。<br>　　容器准备阶段会对 BeanFactory 进行一些设置，然后执行 BeanFactory 的后置处理器；<br>　　对象初始化注入会依次：注册 bean 的后置处理器——初始化 MessageSource 组件——注册事件派发器——注册事件监听器——初始化和注入剩下的单例 bean——完成刷新工作；</li>
<li>事件驱动模型：<br>　　ApplicationListener：事件监听；<br>　　ApplicationEventMulticaster：事件派发；<br>　　ApplicationContext.publishEvent()：事件发布；</li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">Java</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Spring</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/03/03/Spring 源码浅析——容器刷新流程概览/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Redis 高可用和分布式" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/23/Redis 高可用和分布式/">Redis 高可用和分布式</a>
    </h1>
  

        
        <a href="/2019/02/23/Redis 高可用和分布式/" class="archive-article-date">
  	<time datetime="2019-02-23T08:20:24.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-23</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>Redis 可以单机部署，但会带来单点问题和性能瓶颈。为此 Redis 提供了主从复制、哨兵和集群的方式来解决这些问题。</p>
<h2 id="一、主从复制"><a href="#一、主从复制" class="headerlink" title="一、主从复制"></a>一、主从复制</h2><p>主从复制可以将两台或者多台服务器之间的数据同步，这样在主服务器下线后，从服务器可以继续对外提供服务，保证了系统的高可用；另外主从复制也可以进行读写分离，主服务器只提供写操作或少量的读，把多余读请求通过负载均衡算法分流到单个或多个从服务器上。</p>
<p>Redis 的复制功能分为同步和命令传播两个操作，同步操作用于将从服务器的状态更新至主服务器当前的状态；命令传播操作用于在主服务状态被修改时，让主从状态重新保持一致。</p>
<h3 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h3><p>可以通过使用<code>SLAVEOF &lt;host&gt; &lt;port&gt;</code>命令来让一个服务器成为另一个服务器的从服务器。此时从服务器会自动向主服务器发送 SYNC 的命令进行同步操作，步骤如下：</p>
<ul>
<li>1）主服务器收到 SYNC 命令后执行 BGSAVE 命令，在后台生成一个 RDB 快照文件，并用一个缓冲区记录从现在开始执行的所有写命令。</li>
<li>2）从服务器从主服务器接收到 RDB 文件后，丢弃所有旧数据，载入主服务器发来的快照文件。</li>
<li>3）主服务器把记录在缓冲区的命令发送给从服务器，从服务器执行这些命令，同步完成。</li>
</ul>
<p>但是这种同步方式会带来一个断线后重复值效率低的问题：如果从服务器短暂掉线后重连主服务器，主从之间不得不重新同步所有数据，这是没有必要的，因为从服务器仍然保留了大部分数据。Redis 2.8 推出了部分重同步的方式解决了这个问题。</p>
<h3 id="部分重同步"><a href="#部分重同步" class="headerlink" title="部分重同步"></a>部分重同步</h3><p>部分重同步用于处理断线后复制的情况。Redis 部分重同步的实现由以下三个部分构成：</p>
<ul>
<li>主服务器和从服务器的复制偏移量：复制偏移量表示当前从服务器从主服务器中接收了多少字节的数据。</li>
<li>主服务器的复制积压缓冲区：复制积压缓冲区以 FIFO 的形式保存了最近的写命令。</li>
<li>服务器运行 id：用于标识服务器</li>
</ul>
<p>当从服务器断线重连之后，会向主服务器发送一个<code>PSYNC &lt;runid&gt; &lt;offset&gt;</code>的命令，offset 即当前从服务器的复制偏移量，runid 是从服务器记录的掉线之前的主服务器 id。主服务器在收到 PSYNC 后，会首先对比自己的 runid 和传过来的 runid 是否一致，如果一致，说明这台从服务器之前和自己同步过数据，然后根据 offset 的差值把复制积压缓冲区的数据同步给从服务器。这样就实现了增量更新。</p>
<h3 id="命令传播"><a href="#命令传播" class="headerlink" title="命令传播"></a>命令传播</h3><p>在同步完成之后，主从服务器就进入了命令传播阶段。在这个阶段，主服务器发生写操作后，会把相应的命令发送给从服务器执行，这样主从之间就保持了数据一致性。</p>
<p>从服务器也会向主服务器发送命令<code>REPLCONF ACK &lt;replication_offset&gt;</code>，这是一个心跳检测命令，每隔 1 秒就会发一次，它有以下两个作用：</p>
<ul>
<li>检测主从服务器的网络连接状态：主服务器会记录从服务器上次心跳检测的时间，如果超过 1 秒，就说明连接出了故障。如果主服务器和大量从服务器之间的连接出了故障，比如有 3 台以上的从服务器超过 10 秒没有心跳检测，则会拒绝执行写命令。</li>
<li>检测命令丢失：和部分重同步类似，心跳检测也会发送从服务器的当前复制偏移量（replication_offset），主服务器在接收到心跳检测后会检查这个偏移量是否和自己的一致，如果不一致会补发缺失的数据。</li>
</ul>
<h2 id="二、Sentinel（哨兵）"><a href="#二、Sentinel（哨兵）" class="headerlink" title="二、Sentinel（哨兵）"></a>二、Sentinel（哨兵）</h2><p>Sentinel（哨兵）是 Redis 高可用的解决方案：由一个或多个 Sentinel 实例组成的 Sentinel 系统可以监视任意多个主服务器以及这些服务器下的所有从服务器。在主服务器进入下线状态时，自动将下线服务器下的某个从服务器升级成主服务器。</p>
<p><img src="/2019/02/23/Redis 高可用和分布式/哨兵 1.png"></p>
<p>Sentinel 系统是由 Sentinel 实例组成的，彼此间通过命令连接相互通信：</p>
<p><img src="/2019/02/23/Redis 高可用和分布式/哨兵 2.png"></p>
<p>Sentinel 实例会以每秒一次的频率向自己监控的主服务器发送 PING 命令，主服务器会回复该命令，以此来监控主服务器的在线状态。当 Sentinel 实例发送 PING 命令之后等待超过配置指定时间之后，Sentinel 实例会判定该主服务器处于主观下线状态。</p>
<p>当一个 Sentinel 实例判定自己监控的某个主服务器为主观下线之后，它会询问其它监控该服务器的 Sentinel 实例，当超过配置指定数量的 Sentinel 实例也认为该服务器已下线时，Sentinel 实例会判定该服务器为客观下线。</p>
<p>当有超过配置指定数量的 Sentinel 实例认为该服务器客观下线之后，监视该服务器的各个 Sentinel 会进行协商，通过 Raft 算法选举出一个领头 Sentinel 对下线主服务器执行故障转移操作。</p>
<p>故障转移操作包括三个部分：</p>
<ul>
<li>1）在已下线主服务器属下的所有从服务器中挑选一个从服务器，将其转换为主服务器。</li>
<li>2）让其它从服务器改为复制新的主服务器（发送 SLAVEOF 命令）。</li>
<li>3）将原来的主服务器设置为从服务器。</li>
</ul>
<h2 id="三、集群"><a href="#三、集群" class="headerlink" title="三、集群"></a>三、集群</h2><p>Redis 集群是 Redis 提供的分布式数据库方案，集群通过分片的方式进行数据共享，并提供复制和转移功能。</p>
<p>集群中的节点可以通过向其它节点发送<code>CLUSTER MEET &lt;ip&gt; &lt;port&gt;</code>命令邀请其它节点加入集群。</p>
<p><img src="/2019/02/23/Redis 高可用和分布式/集群-握手.png"></p>
<p>集群的整个数据库被分为 16384 个槽，数据库中的每一个键都属于这 16384 个槽中的一个，只有当集群中的每个槽都有节点在处理时，集群才处于上线状态。</p>
<p>我们可以通过<code>CLUSTER ADDSLOTS [slot...]</code>命令将一个或多个槽指派给节点。每个节点会记录自己和集群中其它节点被指派的槽。</p>
<p>节点在接到一个命令请求时，会先检查这个命令请求要处理的键所在的槽是否由自己负责，如果不是的话，节点将向客户端返回一个 MOVED 错误，MOVED 错误携带的信息可以指引客户端转向正确的节点。</p>
<p>除了可以指派槽以外，我们还可以通过 redis-trib 这个软件将槽重新分片。重新分片的关键是将属于某个槽的所有键值对从一个节点转移至另一个节点。</p>
<p>在重新分片期间，如果客户端向原来的节点请求键 k，而 k 已经被转移到另一个节点时，节点会返回一个 ASK 错误，指引客户端到新的节点。</p>
<p>MOVED 错误表示槽的负责权已经永远转移了，而 ASK 错误只是两个节点在槽迁移时的临时措施。</p>
<h3 id="故障转移"><a href="#故障转移" class="headerlink" title="故障转移"></a>故障转移</h3><p>为了集群的高可用，集群中的节点也分主节点和从节点，从节点复制主节点的数据。</p>
<p><img src="/2019/02/23/Redis 高可用和分布式/集群-主从.png"></p>
<p>主节点之间通过 PING 消息来互相确认对方的在线状态，如果没有在规定时间内收到对方的 PONG，则会把对方标记为疑似下线状态，并将这个消息告知给集群中的其它主节点。当某个主节点发现集群中有超过半数主节点认为某个主节点疑似下线，它就会把这个主节点标记为下线，并广播给集群中其它的节点（主节点+从节点）。</p>
<p>当从节点发现自己正在复制的主节点已下线时，会通过 raft 算法选举出新的主节点。选举的候选节点是已下线主节点的所有从节点，投票节点是其它所有主节点。最后一个从节点会被推选为新的主节点，接管由已下线节点负责处理的槽。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Redis</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/02/23/Redis 高可用和分布式/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-CMS-G1 和 ZGC" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/21/CMS-G1 和 ZGC/">CMS,G1 和 ZGC</a>
    </h1>
  

        
        <a href="/2019/02/21/CMS-G1 和 ZGC/" class="archive-article-date">
  	<time datetime="2019-02-21T11:23:54.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-21</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>本文主要介绍比较常用的垃圾收集器：CMS，G1 和 ZGC。CMS 是服务器使用比较多的收集器，侧重点在低停顿；JDK 9 以后，G1 成为了默认收集器，它的设计目标是停顿可控；最新的 JDK 11 中，加入了实验性质的 ZGC，这个收集器可以将停顿时间降至 10ms 以下。</p>
<h2 id="1、JDK1-8-之前默认的垃圾收集器"><a href="#1、JDK1-8-之前默认的垃圾收集器" class="headerlink" title="1、JDK1.8 之前默认的垃圾收集器"></a>1、JDK1.8 之前默认的垃圾收集器</h2><p>JDK1.8 之前（包括 1.8），默认的垃圾收集器是 Parallel Scavenge（新生代）+Parallel Old（老年代）。</p>
<p>Parallel Scavenge 是一款基于复制算法的新生代垃圾处理器，它的设计目标是吞吐量优先。所谓吞吐量就是指：用户运行时间/(用户运行时间+垃圾回收时间)。很显然吞吐量越大越好。用户需要给 Parallel Scavenge 设置一个吞吐量的目标，然后 Parallel Scavenge 会自动控制每一次垃圾回收的时间。另外 Parallel Scavenge 还有自适应调节策略，只要打开-XX:+UseAdaptiveSizePolicy，它就会动态调整新生代大小、Eden 与 Survivor 的比例、晋升老年代对象大小等参数，以达到最大的吞吐量。</p>
<p>和 Parallel Scavenge 配套使用的老年代收集器是 Parallel Old，这是一款基于标记-整理算法的垃圾处理器。</p>
<p><strong>为什么不用 CMS 作为老年代收集器？</strong> </p>
<blockquote>
<p>这是因为 Parallel Scavenge 的作者没有使用 HotSpot VM 给定的代码框架，而是自己独立实现了一个。这就导致 Parallel Scavenge 和当时大部分收集器都不兼容，其中就包括 CMS。所以在 1.8 时代，比较流行的有两套收集器，一套是 Parallel Scavenge（新生代）+Parallel Old（老年代），另一套是 ParNew（使用复制算法，新生代）+ CMS（老年代）</p>
</blockquote>
<h2 id="2、低停顿的-CMS"><a href="#2、低停顿的-CMS" class="headerlink" title="2、低停顿的 CMS"></a>2、低停顿的 CMS</h2><p>CMS，Concurrent Mark Sweep，是一款老年代的收集器，它关注的是垃圾回收最短的停顿时间。命名中 Concurrent 说明这个收集器是有与工作执行并发的能力的，Mark Sweep 则代表算法用的是标记-清除算法。</p>
<p>CMS 的工作原理分为四步：</p>
<ul>
<li>初始标记：单线程执行，仅仅把 GC Roots 的直接关联可达的对象标记一下，速度很快，需要停顿。</li>
<li>并发标记：对于初始标记过程所标记的初始对象，进行并发追踪标记，不需要停顿。</li>
<li>重新标记：为了修正并发标记期间因用户程序继续运作而导致标记产生变动的那一部分对象的标记记录，需要停顿。</li>
<li>并发清除：清除之前标记的垃圾，不需要停顿。</li>
</ul>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/CMS.png"></p>
<p>由于最耗费时间的并发标记与并发清除阶段都不需要暂停工作，所以整体的回收是低停顿的。</p>
<p>由于 CMS 以上特性，缺点也是比较明显的：</p>
<ul>
<li>标记-清除算法会导致内存碎片比较多。</li>
<li>CMS 的并发能力依赖于 CPU 资源，所以在 CPU 数少和 CPU 资源紧张的情况下，性能较差。</li>
<li>无法处理浮动垃圾。浮动垃圾是指在并发清除阶段用户线程继续运行而产生的垃圾，这部分垃圾只能等下次 GC 时处理。由于浮动垃圾的存在，CMS 不能等待内存耗尽的时候才进行 GC，而要预留一部分内存空间给用户线程。这里会浪费一些空间。</li>
</ul>
<p><strong>为什么不用标记-整理？</strong></p>
<blockquote>
<p>因为在并发清除阶段，其它用户线程还在工作，要保证它们运行的资源不受影响。而标记-整理算法会移动对象，所以不能使用标记-整理。</p>
</blockquote>
<h2 id="3、停顿可控的-G1"><a href="#3、停顿可控的-G1" class="headerlink" title="3、停顿可控的 G1"></a>3、停顿可控的 G1</h2><p>G1 是一款可以掌管所有堆内存空间的收集器。G1 把堆划分成多个大小相等的独立区域（Region），新生代和老年代不再物理隔离。</p>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/G1-1.png"></p>
<p>通过引入 Region 的概念，将原来的一整块内存空间划分成多个的小空间，使得每个小空间可以单独进行垃圾回收。这种划分方法避免了空间碎片化，也提高了回收的灵活性——G1 会根据平均每个 Region 回收需要的时间（经验预测）和各个 Region 的回收收益，制定回收计划。</p>
<p>每个 Region 都有一个 Remembered Set，用来记录该 Region 对象的引用对象所在的 Region。通过使用 Remembered Set，在做可达性分析的时候就可以避免全堆扫描。</p>
<p>三种 GC 模式：</p>
<ul>
<li>Young GC，发生于新生代空间不足时，回收全部新生代，可以通过控制新生代 Region 的个数来控制 Young GC 的时间开销。</li>
<li>Mixed GC，当堆中内存使用超过整个堆大小的 InitiatingHeapOccupancyPercent（默认 45）时启动。 回收全部新生代，并根据预期停顿时间回收部分收益较高的老年代。</li>
<li>Full GC（JDK 9 引入），发生于老年代空间不足时，相当于执行一次 STW 的 full gc。</li>
</ul>
<p>整体的执行流程：</p>
<ul>
<li>初始标记：标记了从 GC Root 开始直接关联可达的对象，速度很快，单线程，需停顿。</li>
<li>并发标记：对于初始标记过程所标记的初始对象，进行并发追踪标记，并记录下每个 Region 中的存活对象信息用于计算收益，不需要停顿。</li>
<li>最终标记：为了修正并发标记期间因用户程序继续运作而导致标记产生变动的那一部分对象的标记记录，需要停顿。</li>
<li>筛选回收：根据 GC 模式、回收时间和回收收益确定回收计划，回收后的空 Region 会加入到空闲列表，需要停顿。</li>
</ul>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/G1-2.png"></p>
<p>由于 G1 会把存活的对象集中起来放到 Survivor Region 中，并通过空闲列表整理所有的空 Region，所以整体来看是基于“标记 - 整理”算法实现的收集器；但从局部（两个 Region 之间）上来看又是基于“复制”算法实现的。但不论如何，这两种算法都需要移动对象，所以 G1 的回收阶段是需要停顿的。</p>
<h2 id="4、几乎无停顿的-ZGC"><a href="#4、几乎无停顿的-ZGC" class="headerlink" title="4、几乎无停顿的 ZGC"></a>4、几乎无停顿的 ZGC</h2><p>在 JDK 11 当中，加入了实验性质的 ZGC。它的回收耗时平均不到 2 毫秒。它是一款低停顿高并发的收集器。ZGC 几乎在所有地方并发执行的，除了初始标记的是 STW 的。所以停顿时间几乎就耗费在初始标记上，这部分的实际是非常少的。那么其他阶段是怎么做到可以并发执行的呢？ZGC 主要新增了两项技术，一个是着色指针 Colored Pointer，另一个是读屏障 Load Barrier。</p>
<p><strong>着色指针 Colored Pointer</strong></p>
<p>ZGC 利用指针的 64 位中的几位表示 Finalizable、Remapped、Marked1、Marked0（ZGC 仅支持 64 位平台），以标记该指向内存的存储状态。相当于在对象的指针上标注了对象的信息。注意，这里的指针相当于 Java 术语当中的引用。</p>
<p>在这个被指向的内存发生变化的时候（内存在整理时被移动），颜色就会发生变化。</p>
<p><strong>读屏障 Load Barrier</strong></p>
<p>由于着色指针的存在，在程序运行时访问对象的时候，可以轻易知道对象在内存的存储状态（通过指针访问对象），若请求读的内存在被着色了。那么则会触发读屏障。读屏障会更新指针再返回结果，此过程有一定的耗费，从而达到与用户线程并发的效果。</p>
<p>把这两项技术联合下理解，引用 R 大（RednaxelaFX）的话</p>
<blockquote>
<p>与标记对象的传统算法相比，ZGC 在指针上做标记，在访问指针时加入 Load Barrier（读屏障），比如当对象正被 GC 移动，指针上的颜色就会不对，这个屏障就会先把指针更新为有效地址再返回，也就是，永远只有单个对象读取时有概率被减速，而不存在为了保持应用与 GC 一致而粗暴整体的 Stop The World。</p>
</blockquote>
<p>ZGC 和 G1 一样将堆划分为 Region 来清理、移动，稍有不同的是 ZGC 中 Region 的大小是会动态变化的。</p>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/ZGC-1.png"></p>
<p>ZGC 的回收流程如下：</p>
<p><strong>1、初始停顿标记</strong></p>
<p>停顿 JVM 地标记 Root 对象，1，2，4 三个被标为 live。</p>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/ZGC-2.png"></p>
<p><strong>2、并发标记</strong></p>
<p>并发地递归标记其他对象，5 和 8 也被标记为 live。</p>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/ZGC-3.png"></p>
<p><strong>3、移动对象</strong></p>
<p>对比发现 3、6、7 是过期对象，也就是中间的两个灰色 region 需要被压缩清理，所以陆续将 4、5、8  对象移动到最右边的新 Region。移动过程中，有个 forward table 纪录这种转向。</p>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/ZGC-4.png"></p>
<p>活的对象都移走之后，这个 region 可以立即释放掉，并且用来当作下一个要扫描的 region 的 to region。所以理论上要收集整个堆，只需要有一个空 region 就 OK 了。</p>
<p><strong>4、修正指针</strong></p>
<p>最后将指针都妥帖地更新指向新地址。</p>
<p><img src="/2019/02/21/CMS-G1 和 ZGC/ZGC-5.png"></p>
<p>ZGC 虽然目前还在 JDK 11 还在实验阶段，但由于算法与思想是一个非常大的提升，相信在未来不久会成为主流的 GC 收集器使用。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">Java</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/02/21/CMS-G1 和 ZGC/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Redis 事件、事务和 pipeline" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/12/Redis 事件、事务和 pipeline/">Redis 事件、事务和 pipeline</a>
    </h1>
  

        
        <a href="/2019/02/12/Redis 事件、事务和 pipeline/" class="archive-article-date">
  	<time datetime="2019-02-12T11:34:57.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-12</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>本文介绍了 Redis 中事件的类型和事件的调度与执行，以及对批量事件处理的两种方式：事务和 pipeline。</p>
<h2 id="一、事件"><a href="#一、事件" class="headerlink" title="一、事件"></a>一、事件</h2><p>Redis 服务器是一个事件驱动程序。Redis 的事件有两类：</p>
<ul>
<li>文件事件：服务器通过套接字与客户端连接，文件事件就是服务器对套接字操作的抽象。</li>
<li>时间事件：服务器对定时操作的抽象。</li>
</ul>
<h3 id="文件事件"><a href="#文件事件" class="headerlink" title="文件事件"></a>文件事件</h3><p>Redis 包装了底层的 select、epoll 等来实现自己的网络事件处理器。它使用 I/O 多路复用程序来同时监听多个套接字，并将到达的事件传送给文件事件分派器，分派器会根据套接字产生的事件类型调用相应的事件处理器。</p>
<p><img src="/2019/02/12/Redis 事件、事务和 pipeline/文件事件分派器.png"></p>
<h3 id="时间事件"><a href="#时间事件" class="headerlink" title="时间事件"></a>时间事件</h3><p>服务器有一些操作需要在给定的时间点执行，时间事件是对这类定时操作的抽象。</p>
<p>时间事件又分为：</p>
<ul>
<li>定时事件：是让一段程序在指定的时间之内执行一次；</li>
<li>周期性事件：是让一段程序每隔指定时间就执行一次。</li>
</ul>
<p>时间事件中的属性 when 会记录下次执行的时间，周期性事件在执行后会更新 when 的值，而定时事件会被删除。</p>
<p>Redis 将所有时间事件都放在一个无序链表中，由时间事件执行器通过遍历整个链表查找出已到达的时间事件，并调用相应的事件处理器。</p>
<h3 id="事件的调度与执行"><a href="#事件的调度与执行" class="headerlink" title="事件的调度与执行"></a>事件的调度与执行</h3><p>服务器需要不断监听文件事件的套接字才能得到待处理的文件事件，但是不能一直监听，否则时间事件无法在规定的时间内执行，因此监听时间应该根据距离现在最近的时间事件来决定。</p>
<p>事件调度与执行由 aeProcessEvents 函数负责，伪代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aeProcessEvents</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 获取到达时间离当前时间最接近的时间事件</span></span><br><span class="line">    time_event = aeSearchNearestTimer()</span><br><span class="line">    <span class="comment"># 计算最接近的时间事件距离到达还有多少毫秒</span></span><br><span class="line">    remaind_ms = time_event.when - unix_ts_now()</span><br><span class="line">    <span class="comment"># 如果事件已到达，那么 remaind_ms 的值可能为负数，将它设为 0</span></span><br><span class="line">    <span class="keyword">if</span> remaind_ms &lt; <span class="number">0</span>:</span><br><span class="line">        remaind_ms = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 根据 remaind_ms 的值，创建 timeval</span></span><br><span class="line">    timeval = create_timeval_with_ms(remaind_ms)</span><br><span class="line">    <span class="comment"># 阻塞并等待文件事件产生，最大阻塞时间由传入的 timeval 决定</span></span><br><span class="line">    aeApiPoll(timeval)</span><br><span class="line">    <span class="comment"># 处理所有已产生的文件事件</span></span><br><span class="line">    procesFileEvents()</span><br><span class="line">    <span class="comment"># 处理所有已到达的时间事件</span></span><br><span class="line">    processTimeEvents()</span><br></pre></td></tr></table></figure></p>
<p>将 aeProcessEvents 函数置于一个循环里面，加上初始化和清理函数，就构成了 Redis 服务器的主函数，伪代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 初始化服务器</span></span><br><span class="line">    init_server()</span><br><span class="line">    <span class="comment"># 一直处理事件，直到服务器关闭为止</span></span><br><span class="line">    <span class="keyword">while</span> server_is_not_shutdown():</span><br><span class="line">        aeProcessEvents()</span><br><span class="line">    <span class="comment"># 服务器关闭，执行清理操作</span></span><br><span class="line">    clean_server()</span><br></pre></td></tr></table></figure>
<p>从事件处理的角度来看，服务器运行流程如下：</p>
<p><img src="/2019/02/12/Redis 事件、事务和 pipeline/事件的调度与执行.png"></p>
<h2 id="二、事务"><a href="#二、事务" class="headerlink" title="二、事务"></a>二、事务</h2><p>Redis 通过 MULTI、EXEC、WATCH 等命令来实现事务功能。事务提供了一种将多个命令请求打包，然后一次性、按顺序地执行多个命令的机制，并且在事务执行期间，服务器不会中断事务而改去执行其他客户端的命令请求，它会将事务中的所有命令都执行完毕，然后才去处理其他客户端的命令请求。</p>
<p>一个事务包括三个步骤：</p>
<ul>
<li>事务开始：事务以 MULTI 开始，返回 OK 命令。</li>
<li>命令入队：每个事务命令成功进入队列后，返回 QUEUED。</li>
<li>事务执行：EXEC 执行事务。</li>
</ul>
<p>Redis 不支持事务回滚功能，事务中的一个 Redis 命令执行失败以后，会继续执行后续的命令。</p>
<h2 id="三、pipeline"><a href="#三、pipeline" class="headerlink" title="三、pipeline"></a>三、pipeline</h2><p>多个命令被一次性发送给服务器，而不是一条一条发送，这种方式被称为流水线，它可以减少客户端与服务器之间的网络通信次数从而提升性能。</p>
<p>可以通过<code>redis-cli --pipe</code>的方式批量发送命令。如<code>cat commands.txt | redis-cli --pipe</code>，commands.txt 中的命令会被以 RESP 协议（这是一个 Redis 自行规定的协议，用于命令的批量执行）的格式发给服务器，服务器也会返回一个 RESP 格式的结果。</p>
<p>当然我们不用自己去实现这个协议，Jedis 为我们实现好了，我们可以很方便地调用：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"localhost"</span>, <span class="number">6379</span>);</span><br><span class="line"><span class="comment">//使用 pipeline</span></span><br><span class="line">Pipeline pipeline = jedis.pipelined();</span><br><span class="line"><span class="comment">//删除 lists</span></span><br><span class="line">pipeline.del(<span class="string">"lists"</span>);</span><br><span class="line"><span class="comment">//循环添加 10000 个元素</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">    pipeline.rpush(<span class="string">"lists"</span>, i + <span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//执行</span></span><br><span class="line">pipeline.sync();</span><br></pre></td></tr></table></figure></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Redis</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/02/12/Redis 事件、事务和 pipeline/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Redis 持久化和过期机制" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/08/Redis 持久化和过期机制/">Redis 持久化和过期机制</a>
    </h1>
  

        
        <a href="/2019/02/08/Redis 持久化和过期机制/" class="archive-article-date">
  	<time datetime="2019-02-08T06:12:30.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-08</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>本文主要介绍了 Redis 持久化的两种机制：RDB 和 AOF，以及键过期的策略：惰性删除和定期删除，还有 RDB、AOF 和复制功能对过期键的处理。</p>
<h2 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h2><p>RDB 是 Redis 持久化的第一种方式。有两个 Redis 命令可以用于生成 RDB 文件，一个是 SAVE，另一个是 BGSAVE。<br>SAVE 会阻塞 Redis 服务器进程，执行时 Redis 服务器会阻塞所有客户端发送的命令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; SAVE</span><br><span class="line">OK</span><br></pre></td></tr></table></figure></p>
<p>BGSAVE 会派生出一个子进程执行，执行时仍可继续处理客户端的命令，但会拒绝客户端 SAVE 和 BGSAVE 的命令，延迟 BGREWRITEAOF 命令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis&gt; BGSAVE</span><br><span class="line">Background saving started</span><br></pre></td></tr></table></figure></p>
<h3 id="执行条件"><a href="#执行条件" class="headerlink" title="执行条件"></a>执行条件</h3><p>SAVE 命令会阻塞服务器，所以只能手动执行。BGSAVE 可以在不阻塞的情况下执行，所以可以配置 save 选项让服务器每隔一段时间自动执行一次。</p>
<p>比如我们可以向服务器提供以下配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">save  900  1</span><br><span class="line">save  300  10</span><br><span class="line">save  60  10000</span><br></pre></td></tr></table></figure></p>
<p>那么只要满足以下三个条件中的任意一个即可被执行：</p>
<ul>
<li>服务器在 900 秒之内对数据库进行了至少 1 次修改。</li>
<li>服务器在 300 秒之内对数据库进行了至少 10 次修改。</li>
<li>服务器在 60 秒之内对数据库进行了至少 10000 次修改。</li>
</ul>
<p>为了实现这一功能，服务器会维持一个记录距离上次保存之后修改的次数的 dirty 计数器和一个记录上次保存时间的 lastsave 属性。</p>
<p>周期操作函数 serverCron 默认每个 100 毫秒就会执行一次，它的其中一项工作就是检查 save 选项设置的条件是否满足，如果满足的话就会执行 BGSAVE 命令。</p>
<h3 id="文件内容"><a href="#文件内容" class="headerlink" title="文件内容"></a>文件内容</h3><p>RDB 文件有多个部分，包括握手字段 ‘REDIS’ 字符串，版本号，数据库，’EOF’ 和校验字段。</p>
<p>核心部分是数据库字段，数据库字段包括了握手字段 ‘SELECTDB’，数据库编号和键值对，数据库编号指示了这是第几个数据库，而键值对则保存了各项数据。</p>
<p>键值对中除了类型和数据，还可能会有过期时间。对于不同类型的键值对，RDB 文件会用不同的方式来保存它们。</p>
<p>RDB 文件本身是一个经过压缩的二进制文件，每次 SAVE 或者 BGSAVE 都会创建一个新的 RDB 文件，不支持追加操作。</p>
<h2 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h2><p>AOF 是 Redis 持久化的第二种方式，在 AOF 和 RDB 同时开启时，服务器会优先考虑从 AOF 恢复数据，因为 AOF 每次记录间隔的时间更短。</p>
<p>和 RDB 直接记录键值对不同，AOF 记录的是命令。服务器在执行完一个写命令以后，会把这条命令追加到服务器 aof_buf 缓冲区的末尾，并在一个适当的时候写入文件。重建时服务器会创建一个伪客户端，依次执行文件中的命令即可完成数据的载入。</p>
<h3 id="文件的写入与同步"><a href="#文件的写入与同步" class="headerlink" title="文件的写入与同步"></a>文件的写入与同步</h3><p>AOF 在持久化时会调用操作系统的 write 函数，但通常该函数会把数据保存在一个内存缓冲区里面而不是立刻刷入磁盘。这就带来一个安全问题。为了避免这个问题操作系统又提供了 fsync 和 fdatasync 两个强制刷盘的同步函数。我们把 write 称为写入，把 fsync 和 fdatasync 称为同步。</p>
<p>服务器会在每次事件循环结束之前根据 appendfsync 选项写入和同步 aof_buf 中的数据：</p>
<ul>
<li>always：写入并同步</li>
<li>everysec：写入，如果距离上次同步超过 1 秒，则同步</li>
<li>no：只写入，何时同步由操作系统决定</li>
</ul>
<h3 id="AOF-重写"><a href="#AOF-重写" class="headerlink" title="AOF 重写"></a>AOF 重写</h3><p>随着服务器运行时间的流逝，AOF 文件中的内容会越来越多，文件的体积也会越来越大，不仅会对宿主计算机造成影响，也拖慢了数据恢复所需要的时间。</p>
<p>AOF 重写是指重新生成一个 AOF 文件替换原来的 AOF 文件。但这里的重写不会对原有的文件进行读取、分析或者写入，而是把数据库中的键值对折算成命令，重新写入新的文件。</p>
<p>重写是一个耗时的操作，因此 Redis 把它放到后台去操作，对应的指令是 BGREWRITEAOF。在重写过程中服务器还可能接收新的指令，因此 Redis 会维护一个 AOF 重写缓冲区，记录重写期间的写命令，在重写完成后追加到 AOF 文件末尾。</p>
<h2 id="RDB-和-AOF-对比"><a href="#RDB-和-AOF-对比" class="headerlink" title="RDB 和 AOF 对比"></a>RDB 和 AOF 对比</h2><p><strong>RDB 的优点</strong>：</p>
<ul>
<li>RDB 是一个非常紧凑的文件，它的体积更小，且可以选择持久化的时间，适合做备份的文件。比如每天的备份，每月的备份。</li>
<li>RDB 对主进程更友好，父进程只需要 fork 出一个子进程，无须执行任何磁盘 I/O 操作。</li>
<li>RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。</li>
</ul>
<p><strong>RDB 的缺点</strong>：</p>
<ul>
<li>因为 RDB 文件需要保存整个数据集的状态， 所以它并不是一个轻松的操作。 因此你可能会至少 5 分钟才保存一次 RDB 文件，间隔时间比较长。</li>
<li>RDB 虽然会把持久化的操作交给子进程，但每次都会从头开始，在数据集比较庞大时， fork() 可能会非常耗时，造成服务器在某某毫秒内停止处理客户端； 如果数据集非常巨大，并且 CPU 时间非常紧张的话，那么这种停止时间甚至可能会长达整整一秒。 </li>
</ul>
<p><strong>AOF 的优点</strong>：</p>
<ul>
<li>AOF 使用追加的方式，每次写入时间很短，因此可以允许更短间隔的持久化操作，比如 1 秒。</li>
<li>AOF 文件的可读性比较好，如果你不小心执行了一条命令，只要 AOF 文件未被重写，那么只要停止服务器，移除 AOF 文件里的该条命令然后重启 Redis 即可。</li>
</ul>
<p><strong>AOF 的缺点</strong>：</p>
<ul>
<li>对于相同的数据集来说，AOF 文件的体积通常要大于 RDB 文件的体积。</li>
<li>使用 fsync 会降低 Redis 的性能，导致 AOF 的速度可能会慢于 RDB 。</li>
</ul>
<p>RDB 和 AOF 各有所长，RDB 体积小，恢复速度快，而且可以生成快照；AOF 频率更高，可以保存更新的数据。一般来说，推荐同时使用。</p>
<h2 id="Redis-过期机制"><a href="#Redis-过期机制" class="headerlink" title="Redis 过期机制"></a>Redis 过期机制</h2><p>Redis 采取的是惰性删除和定期删除配合使用的方式。</p>
<p>惰性删除是指 Redis 会在访问某个键的时候检查该键是否过期，如果过期，就会将输入键从数据库中删除。但惰性删除不能及时清理内存，因此 Redis 还有定期删除的机制。</p>
<p>定期删除是另一种过期键删除方式。Redis 会维护一个过期字典（如下图所示），所有声明了过期时间的键都会被添加进这个字典中。周期操作函数 serverCron 执行时，会在规定时间内随机检查一部分键的过期时间，并删除其中的过期键。</p>
<p><img src="/2019/02/08/Redis 持久化和过期机制/过期键的保存.png"></p>
<h2 id="RDB、AOF-和复制功能对过期键的处理"><a href="#RDB、AOF-和复制功能对过期键的处理" class="headerlink" title="RDB、AOF 和复制功能对过期键的处理"></a>RDB、AOF 和复制功能对过期键的处理</h2><h2 id="RDB-对过期键的处理"><a href="#RDB-对过期键的处理" class="headerlink" title="RDB 对过期键的处理"></a>RDB 对过期键的处理</h2><p>RDB 文件在生成时会检查每个键的过期时间，过期键不会被添加进 RDB 文件里。</p>
<p>载入 RDB 文件时，如果该服务器是主服务器，则不会载入文件中过期的键；如果该服务器是从服务器，则不论过期与否都会被载入。不过，因为主从服务器在同步的时候，从服务器的数据库会被清空，所以一般来讲，过期键对载入 RDB 文件的从服务器不会造成影响。</p>
<h2 id="AOF-对过期键的处理"><a href="#AOF-对过期键的处理" class="headerlink" title="AOF 对过期键的处理"></a>AOF 对过期键的处理</h2><p>AOF 文件写入时，如果数据库中的某个键已过期，但它还没被删除，那么 AOF 文件不会因为这个键产生任何影响。当它被惰性删除或者定期删除之后，程序会向 AOF 文件追加一条 DEL 命令显示记录该键已被删除。</p>
<p>AOF 重写时，和生成 RDB 文件一样，会过滤掉已经过期的键。</p>
<h2 id="复制功能对过期键的处理"><a href="#复制功能对过期键的处理" class="headerlink" title="复制功能对过期键的处理"></a>复制功能对过期键的处理</h2><p>主服务器在删除一个过期键后，会显式地向所有从服务器发送一个 DEL 命令，告知从服务器删除这个过期键。</p>
<p>为了保持主从一致性，从服务器在执行客户端发送的读命令时，即使碰到过期键也不会将过期键删除，而是继续像处理未过期键一样处理过期键。</p>
<p>从服务器只有在接到主服务器发来的 DEL 命令之后，才会删除过期键。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Redis</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/02/08/Redis 持久化和过期机制/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Redis 数据结构和对象" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/05/Redis 数据结构和对象/">Redis 数据结构和对象</a>
    </h1>
  

        
        <a href="/2019/02/05/Redis 数据结构和对象/" class="archive-article-date">
  	<time datetime="2019-02-05T05:45:44.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-05</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>本文主要介绍了 Redis 的 6 种数据结构：SDS、链表、字典、跳跃表、整数集合、压缩列表，和 5 种对象：字符串、列表、哈希、集合、有序集合。</p>
<h2 id="一、数据结构"><a href="#一、数据结构" class="headerlink" title="一、数据结构"></a>一、数据结构</h2><h3 id="SDS"><a href="#SDS" class="headerlink" title="SDS"></a>SDS</h3><p>SDS 是对 C 字符串的封装，用于表示字符串</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/SDS.png"></p>
<p>SDS 使用预分配的方式为字符串分配空间，free 字段表示当前未使用的空间，当字符串增长时，会优先使用未使用的空间，如果未使用的空间不足，Redis 会为 SDS 分配额外的空间。分配算法具体为：1）如果增长后的字符串长度小于 1MB，Redis 将额外分配等同于增长后的字符串长度的空间，此时 free 和 len 的大小相等；2）如果增长后的字符串长度大于 1MB，Redis 将额外分配 1MB 大小的空间。</p>
<p>分配后的空间不会被回收，如果字符串缩短，缩短的空间会被加入到 free 空间中。</p>
<h3 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h3><p><img src="/2019/02/05/Redis 数据结构和对象/链表.png"></p>
<p>Redis 的链表是一个双向链表，它的特性如下：</p>
<ul>
<li>双端：链表节点带有 prev 和 next 指针，获取某个节点的前置和后置节点的复杂度都是 O(1)。</li>
<li>无环：表头节点的 prev 和表尾节点的 next 指针都指向 NULL。</li>
<li>带表头指针和表尾指针：通过 head 和 tail 指针获取表头和表尾节点的复杂度为 O(1)。</li>
<li>计数器：获取节点个数复杂度为 O(1)</li>
<li>多态：利用 dup（复制节点保存的值）、free(释放节点保存的值) 和 match（比较节点的值和输入的值是否相等），来实现保存不同的值。</li>
</ul>
<h3 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h3><p>字典是一个散列表结构，使用 MurmurHash2 算法计算哈希值，使用拉链法保存哈希冲突。</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/字典.png"></p>
<p>Redis 的字典 dict 中包含两个哈希表 dictht，这是为了方便进行 rehash 操作。在扩容时，将其中一个 dictht 上的键值对 rehash 到另一个 dictht 上面，完成之后释放空间并交换两个 dictht 的角色。</p>
<p>渐进式 rehash 通过记录 dict 的 rehashidx 完成，它从 0 开始，然后每执行一次 rehash 都会递增。例如在一次 rehash 中，要把 dict[0] rehash 到 dict[1]，这一次会把 dict[0] 上 table[rehashidx] 的键值对 rehash 到 dict[1] 上，dict[0] 的 table[rehashidx] 指向 null，并令 rehashidx++。</p>
<p>在 rehash 期间，每次对字典执行添加、删除、查找或者更新操作时，都会执行一次渐进式 rehash。</p>
<p>采用渐进式 rehash 会导致字典中的数据分散在两个 dictht 上，因此对字典的查找操作也需要到对应的 dictht 去执行。</p>
<h3 id="跳跃表"><a href="#跳跃表" class="headerlink" title="跳跃表"></a>跳跃表</h3><p>跳跃表是有序集合的底层实现之一。</p>
<p>跳跃表是基于多指针有序链表实现的，可以看成多个有序链表。每个跳跃表节点的层高都是 1-32 之间的随机数。</p>
<p>跳跃表中的节点按照分数大小排列，当分值相同时，节点按照成员对象的大小进行排序。</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/跳跃表 1.png"></p>
<p>在查找时，从上层指针开始查找，找到对应的区间之后再到下一层去查找。下图演示了查找 22 的过程。</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/跳跃表 2.png"></p>
<p>与红黑树等平衡树相比，跳跃表具有以下优点：</p>
<ul>
<li>插入速度非常快速，因为不需要进行旋转等操作来维护平衡性；</li>
<li>并发插入时只需锁住少数节点</li>
<li>支持范围查找</li>
<li>更容易实现</li>
</ul>
<p>跳跃表的缺点：</p>
<ul>
<li>重复存储分层节点，消耗内存</li>
</ul>
<h3 id="整数集合"><a href="#整数集合" class="headerlink" title="整数集合"></a>整数集合</h3><p>整数集合是集合键的底层实现之一，它的底层是一个数组，这个数组以有序、无重复的方式保存集合元素。元素的类型可以为 int16_t,int32_t 或者 int64_t。程序会根据新添加元素的类型，改变数组中元素的类型。</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/整数集合.png"></p>
<p>encoding 表示元素的类型，数组中所有元素的类型是一样的。当有更大的数加入进来的时候，数组会进行升级操作，比如从 int16_t 升级到 int32_t。</p>
<p>整数集合只能升级，不能降级。</p>
<h3 id="压缩列表"><a href="#压缩列表" class="headerlink" title="压缩列表"></a>压缩列表</h3><p>压缩列表被用作列表和哈希的底层实现之一，是一种为节约内存而开发的，由任意多个节点组成的顺序数据结构。每个节点可以保存一个字节数组或一个整数值。</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/压缩列表 1.png"></p>
<p>entry1、entry2…是实际存储数据的节点，除此之外还有些字段记录列表的信息：zlbytes 记录整个压缩列表占用的内存字节数，zltail 指向压缩列表表尾节点，zllen 记录包含的节点数量，zlend 是个特殊值字段（0xFF）用于标记末端。</p>
<p>每个节点由 previous_entry_length、encoding、content 三部分组成。previous_entry_length 保存了前一个节点的长度，由此可以实现从表尾向表头的遍历。encoding 是个复用字段，记录了 content 的编码和长度。下图的 encoding 最高两位 00 表示节点保存的是一个字节数组，后六位 001011 记录了字节数组长度 11。content 保存着节点的值”hello world”。</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/压缩列表 2.png"></p>
<h2 id="二、对象"><a href="#二、对象" class="headerlink" title="二、对象"></a>二、对象</h2><p>Redis 并没有使用以上的数据结构来实现键值对数据库，而是基于这些数据结构创建了一个对象系统。</p>
<table>
<thead>
<tr>
<th>对象类型</th>
<th>底层实现</th>
<th>可以存储的值</th>
<th>操作</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING</td>
<td>int，sds</td>
<td>字符串、整数或者浮点数</td>
<td>对整个字符串或者字符串的其中一部分执行操作 <br> 对整数和浮点数执行自增或者自减操作</td>
</tr>
<tr>
<td>LIST</td>
<td>链表，压缩列表</td>
<td>列表</td>
<td>从两端压入或者弹出元素 <br> 对单个或者多个元素 <br> 进行修剪，只保留一个范围内的元素</td>
</tr>
<tr>
<td>HASH</td>
<td>字典，压缩列表</td>
<td>包含键值对的无序散列表</td>
<td>添加、获取、移除单个键值对 <br> 获取所有键值对 <br> 检查某个键是否存在</td>
</tr>
<tr>
<td>SET</td>
<td>整数集合，字典</td>
<td>无序集合</td>
<td>添加、获取、移除单个元素 <br> 检查一个元素是否存在于集合中 <br> 计算交集、并集、差集 <br> 从集合里面随机获取元素</td>
</tr>
<tr>
<td>ZSET</td>
<td>（字典+跳跃表），压缩列表</td>
<td>有序集合</td>
<td>添加、获取、删除元素 <br> 根据分值范围或者成员来获取元素 <br> 计算一个键的排名</td>
</tr>
</tbody>
</table>
<p>SET 对象使用整数集合保存只包含整数的集合，使用字典保存含有字符串的集合。使用字典保存集合时，字典的键是一个元素的成员，字典的值为 NULL。</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/集合对象.png"></p>
<p>ZSET 对象同时使用字典和跳跃表保存有序集合，使用字典保存有序集合时，字典的键保存了元素的成员，字典的值保存了元素的分值。ZSET 集合元素会同时共享在字典和跳跃表中（保存的是指针，不会造成数据的重复）</p>
<p><img src="/2019/02/05/Redis 数据结构和对象/有序集合.png"></p>
<p><strong>为什么有序集合需要同时使用字典和跳跃表来实现？</strong></p>
<blockquote>
<p>在理论上，有序集合可以单独使用字典或者跳跃表来实现。但两者都有不可替代的地方：字典可以在 O(1) 时间复杂度查找成员的分值，跳跃表可以执行范围型操作。因此为了同时获得这两个特性，Redis 使用了字典和跳跃表来实现有序集合。</p>
</blockquote>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Redis</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/02/05/Redis 数据结构和对象/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-HTTP2-0 和 QUIC" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/01/HTTP2-0 和 QUIC/">HTTP2.0 和 QUIC</a>
    </h1>
  

        
        <a href="/2019/02/01/HTTP2-0 和 QUIC/" class="archive-article-date">
  	<time datetime="2019-02-01T05:23:15.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-01</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>HTTP1.1 在应用层以纯文本的形式进行通信。每次通信都要带完整的 HTTP 的头，而且不考虑 pipeline 模式的话，每次都是一去一回。这样在实时性、并发性上都存在问题。http2.0 通过首部压缩、多路复用、二进制分帧、服务端推送等方式获得了更高的并发和更低的延迟。</p>
<h2 id="首部压缩"><a href="#首部压缩" class="headerlink" title="首部压缩"></a>首部压缩</h2><p>HTTP 2.0 将原来每次都要携带的大量请求头中的 key value 保存在服务器和客户端两端，对相同的头只发送索引表中的索引。</p>
<p>如果首部发生变化了，那么只需要发送变化了数据在 Headers 帧里面，新增或修改的首部帧会被追加到“首部表”。首部表在 HTTP 2.0 的连接存续期内始终存在,由客户端和服务器共同渐进地更新 。</p>
<h2 id="多路复用"><a href="#多路复用" class="headerlink" title="多路复用"></a>多路复用</h2><p>原先的 http 会为每一个请求建立一个 tcp 连接。但由于<strong>客户端对单个域名的允许的最大连接数有限</strong>，以及<strong>三次握手</strong>和<strong>慢启动</strong>等问题，导致效率很低。pipeline 模式是一个比较好的解决办法，但同样会带来<strong>队头阻塞</strong>问题：同时发出的请求必须按顺序接收，如果第一个请求被阻塞了，则后面的请求即使处理完毕了，也需要等待。</p>
<p>http2.0 的多路复用完美解决了这个问题。一个 request 对应一个 stream 并分配一个 id，这样一个连接上可以有多个 stream，每个 stream 的 frame 可以随机的混杂在一起，接收方可以根据 stream id 将 frame 再归属到各自不同的 request 里面。</p>
<p>http2.0 还可以为每个 stream 设置优先级（Priority）和依赖（Dependency）。优先级高的 stream 会被 server 优先处理和返回给客户端，stream 还可以依赖其它的 sub streams。优先级和依赖都是可以动态调整的。动态调整在有些场景下很有用，假想用户在用你的 app 浏览商品的时候，快速的滑动到了商品列表的底部，但前面的请求先发出，如果不把后面的请求优先级设高，用户当前浏览的图片要到最后才能下载完成，而如果设置了优先级，则可以先加载后面的商品，体验会好很多。</p>
<h2 id="二进制分帧"><a href="#二进制分帧" class="headerlink" title="二进制分帧"></a>二进制分帧</h2><p>HTTP 1.x 在应用层以纯文本的形式进行通信，而 HTTP 2.0 将所有的传输信息分割为更小的消息和帧，并对它们采用二进制格式编码。二进制格式的好处在于解析更快，而且文本的表现形式有多样性，要做到健壮性考虑的场景必然很多，二进制则不同，只认 0 和 1 的组合，因此健壮性更好。</p>
<h2 id="服务端推送"><a href="#服务端推送" class="headerlink" title="服务端推送"></a>服务端推送</h2><p>服务端可以在发送页面 HTML 时主动推送其它资源，而不用等到浏览器解析到相应位置，发起请求再响应。例如服务端可以主动把 JS 和 CSS 文件推送给客户端，而不需要客户端解析 HTML 时再发送这些请求。</p>
<p>服务端可以主动推送，客户端也有权利选择是否接收。如果服务端推送的资源已经被浏览器缓存过，浏览器可以通过发送 RST_STREAM 帧来拒收。主动推送也遵守同源策略，服务器不会随便推送第三方资源给客户端。</p>
<h2 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h2><p>HTTP2.0 虽然大大增加了并发性，但还是有问题的。因为 HTTP2.0 也是基于 TCP 协议的，TCP 协议在处理包时是有严格顺序的。</p>
<p>当其中一个数据包遇到问题，TCP 连接需要等待这个包完成重传之后才能继续进行。虽然 HTTP2.0 通过多个 stream，使得逻辑上一个 TCP 连接上的并行内容，进行多路数据的传输，然而这中间没有关联的数据。一前一后，前面 stream2 的帧没有收到，后面 stream1 的帧也会因此阻塞。</p>
<p>于是，就有了从 TCP 切换到 UDP 的时候。这就是 Google 的 QUIC 协议。</p>
<h3 id="机制一：自定义连接机制"><a href="#机制一：自定义连接机制" class="headerlink" title="机制一：自定义连接机制"></a>机制一：自定义连接机制</h3><p>我们都知道，一条 TCP 连接是由四元组标识的，分别是源 IP、源端口、目的 IP、目的端口。一旦一个元素发生变化时，就需要断开重连，重新连接。在移动互联的情况下，当手机信号不稳定或者在 WIFI 和移动网络切换时，都会导致重连，从而进行再次的三次握手，导致一定的时延。</p>
<p>QUIC 使用一个 64 位的随机数作为 ID 来标识，由于 UDP 是无连接的，所以当 IP 或者端口发生变化时，只要 ID 不变，就不需要重新建立连接。</p>
<h3 id="机制二：自定义重传机制"><a href="#机制二：自定义重传机制" class="headerlink" title="机制二：自定义重传机制"></a>机制二：自定义重传机制</h3><p>TCP 为了保证可靠性，通过使用序号和应答机制，来解决顺序问题和丢包问题。</p>
<p>任何一个序号的包发过去，都要在一定的时间内得到应答，否则一旦超时，就会重发。超时时间是通过采样往返时间 RTT 不断调整的。这就会带来一个采样不准确的问题。例如：发送一个包，序号为 100，发现没有返回，于是再发送一个 100，过一阵返回一个 ACK101。这个时候客户端知道这个包肯定收到了，但往返时间是多少呢？是 ACK 达到的时间减去后一个 100 发送的时间，还是减去前一个 100 发送的时间呢？</p>
<p>QUIC 也有个序列号，是递增的。任何一个序列号的包只发送一次，下次就要加一了。例如，发送一个包，序号是 100，发现没有返回；再次发送的时候，序号就是 101 了；如果返回的 ACK100，就是对第一个包的响应，如果返回 ACK101 就是对第二个包的响应，RTT 计算相对准确。</p>
<p>但是这里有一个问题，就是这么知道包 100 和包 101 发送的是同样的内容呢？QUIC 定义了一个 stream offset 的概念。QUIC 既然面向连接，也就像 TCP 一样，是一个数据流，发送的数据在这个数据流里面有个偏移量 stream offset，可以通过 stream offset 查看数据发送到了哪里，这样只要这个 stream offset 的包没有来，就要重发；如果来了，按照 stream offset 拼接，还是能够拼成一个流。<br><img src="/2019/02/01/HTTP2-0 和 QUIC/自定义消息重传.png"></p>
<h3 id="无阻塞的多路复用"><a href="#无阻塞的多路复用" class="headerlink" title="无阻塞的多路复用"></a>无阻塞的多路复用</h3><p>有了自定义的连接和重传机制，我们可以解决上面 HTTP2.0 的多路复用问题。</p>
<p>同 HTTP2.0 一样，同一条 QUIC 连接上可以创建多个 stream，来发送多个 HTTP 请求。但是，QUIC 是基于 UDP 的，一个连接上的多个 stream 之间没有依赖。这样，假如 stream2 丢了一个 UDP 包，后面跟着 stream3 的一个 UDP 包，虽然 stream2 的那个包需要重传，但是 stream3 的包无需等待，就可以发给用户。</p>
<h3 id="自定义流量控制"><a href="#自定义流量控制" class="headerlink" title="自定义流量控制"></a>自定义流量控制</h3><p>TCP 的流量控制是通过滑动窗口协议。QUIC 的流量控制也是通过 window_update，来告诉对端它可以接受的字节数。但是 QUIC 的窗口是适应自己的多路复用机制的，不但在一个连接上控制窗口，还在一个连接中的每个 stream 控制窗口。</p>
<p>在 TCP 协议中，接受端的窗口的起始点是下一个要接收并且 ACK 的包，即使后来的包都到了，放在缓存里，窗口也不能右移，因为 TCP 的 ACK 机制是基于系列号的累计应答，一旦 ACK 了一个系列号，就说明前面的都到了，所以只要前面的没到，后面的到了也不能 ACK，就会导致后面的到了，也有可能超时重传，浪费带宽。</p>
<p>QUIC 的 ACK 是基于 offset 的，每个 offset 的包来了，进了缓存，就可以应答，应答后就不会重发，中间的空档会等待到来或者重发即可，而窗口的起始位置为当前收到的最大 offset，从这个 offset 到当前的 stream 所能容纳的最大缓存，是真正的窗口大小。显然，这样更加准确。<br><img src="/2019/02/01/HTTP2-0 和 QUIC/自定义流量控制.png"></p>
<p>另外，还有整个连接的窗口，需要对于所有的 stream 的窗口做一个统计。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">计算机网络</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/02/01/HTTP2-0 和 QUIC/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-InnoDB 中的锁和 MVCC" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/27/InnoDB 中的锁和 MVCC/">InnoDB 中的锁和 MVCC</a>
    </h1>
  

        
        <a href="/2019/01/27/InnoDB 中的锁和 MVCC/" class="archive-article-date">
  	<time datetime="2019-01-27T13:20:11.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-01-27</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>锁和 MVCC 是 MySQL 控制并发访问的两种手段。InnoDB 在 MySQL 的基础上提供了更细粒度的行级锁，使用了 next-key 算法解决了幻读的问题。另外 InnoDB 提供了一套基于 MVCC 的一致性非锁定读方式，实现了“读不加锁，读写不冲突”的快照读方式。</p>
<h2 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h2><h3 id="1、表锁"><a href="#1、表锁" class="headerlink" title="1、表锁"></a>1、表锁</h3><p>InnoDB 直接沿用了ＭySQL 提供的表锁。事实上，表锁的加锁和解锁都是在 MySQL server 层面的，和存储引擎没有关系。加锁的方式如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LOCK</span> <span class="keyword">TABLES</span> orders <span class="keyword">READ</span>; // 加读锁</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(total) <span class="keyword">FROM</span> orders;</span><br><span class="line"><span class="keyword">UNLOCK</span> <span class="keyword">TABLES</span>; // 解锁</span><br></pre></td></tr></table></figure></p>
<h3 id="2、行级锁"><a href="#2、行级锁" class="headerlink" title="2、行级锁"></a>2、行级锁</h3><p>顾名思义，行级锁锁定的是某一行数据。InnoDB 中的所有数据项都保存在聚簇索引中，所以行级锁实质上锁住的是索引项。如果表中有多个索引存在，一行数据会对应到多个索引项，此时行级锁会锁住所有索引上的相应索引项。</p>
<p>行级锁分为共享锁（S 锁）和排他锁（X 锁）。S 锁和 S 锁可以兼容；S 锁和 X 锁，X 锁和 X 锁不能兼容。（InnoDB 存储引擎默认采用行级锁，所以下文如无指明，S 锁和 X 锁均指行锁）</p>
<h3 id="3、意向锁"><a href="#3、意向锁" class="headerlink" title="3、意向锁"></a>3、意向锁</h3><p>在没有引入意向锁之前，行级锁和表锁之间的兼容有点麻烦：如果要对一张表加 X 表锁，那么首先要判断这张表是否加了 X 表锁和 S 表锁，其次要判断每一行是否加了 X 锁和 S 锁，如果表的行数比较多的话，这种判断方式会比较损失性能。因此 InnoDB 引入了意向锁。</p>
<p>和行锁一样，意向锁也分为意向共享锁（IS 锁）和意向排他锁（IX 锁）。事务在申请 S 或 X 锁之前，必须先申请到 IS 或 IX 锁。InnoDB 中的意向锁是一种特殊的表锁：意向锁之间互不冲突，意向锁和表锁之间会冲突，此时意向锁相当于同类型的表锁。</p>
<h2 id="MVCC"><a href="#MVCC" class="headerlink" title="MVCC"></a>MVCC</h2><p>MVCC 是一种非锁定读的一致性读机制。它的特点是读不加锁，读写不冲突。InnoDB 利用 undo log 实现了 MVCC。undo log 的数据结构如图所示：</p>
<p><img src="/2019/01/27/InnoDB 中的锁和 MVCC/undo log.png"></p>
<p>前四行是数据列，后三列是隐藏列。隐藏列的含义如下：</p>
<ul>
<li>DB_ROW_ID：行 ID。占 7 字节，他就项自增主键一样随着插入新数据自增。如果表中不存主键或者唯一索引，那么数据库就会采用 DB_ROW_ID 生成聚簇索引。否则 DB_ROW_ID 不会出现在索引中。</li>
<li>DB_TRX_ID：事务 ID。占 6 字节，表示这一行数据最后插入或修改的事务 id。此外删除在内部也被当作一次更新，在行的特殊位置添加一个删除标记（记录头信息有一个字节存储是否删除的标记）。</li>
<li>DB_ROLL_PTR：回滚指针。占 7 字节，每次对数据进行更新操作时，都会 copy 当前数据，保存到 undo log 中。并修改当前行的回滚指针指向 undo log 中的旧数据行。</li>
</ul>
<p>MVCC 只有在隔离级别是 READ COMMITED 和 REPEATABLE READ 两个隔离级别下工作。MVCC 可以通过比较数据行的事务 ID 和当前事务 ID 来判断该记录是否对当前事务可见。但仅有 undo log 还不够。试想这样一种情况：事务 599 开始——事务 600 开始——事务 600 查询了表 A——事务 599 更新了表 A——事务 599 提交——事务 600 再次查询表 A。可知事务 600 的两次查询会得到不同的结果，无法满足 RR 隔离级别的要求。这是因为事务 599 的事务 ID 虽然比事务 600 小，但事务 599 还未结束，仍有可能改变数据项的值。</p>
<h3 id="read-view"><a href="#read-view" class="headerlink" title="read view"></a>read view</h3><p>InnoDB 使用了 read view 解决了这个问题。read view 是一张表，记录了当前活跃的事务 ID。InnoDB 在查询时会先对比数据行的事务 ID 和 read view 中的事务 ID。具体如下：</p>
<ul>
<li>如果数据行事务 ID 大于 read view 中最大的 ID，表示数据行一定是在当前事务之后修改的，对当前事务不可见；</li>
<li>如果数据行事务 ID 小于 read view 中最小的 ID，表示数据行一定是在当前事务开始之前修改并且已提交，所以对当前事务可见。</li>
<li>如果数据行事务 ID 落在 read view 最大最小 ID 的区间中，则要判断数据行事务 ID 和当前事务 ID 的关系：<ul>
<li>如果数据行事务 ID 不在活跃事务数组中，表示该事务已提交，此时和当前事务 ID 比较，若小于则可见，大于则不可见；</li>
<li>如果数据行事务 ID 在活跃事务数组中，表示该事务未提交，这里要判断一下数据行事务 ID 是否为当前事务 ID，若是，虽然未提交但同一事务内的修改可见，若不是，则不可见。</li>
</ul>
</li>
</ul>
<p>当前数据行若是不可见，InnoDB 会沿着 DB_ROLL_PTR 往下查找，直到找到第一个可见的数据行或者 null。</p>
<p>可见与否只是第一步，实际返回的数据还要经过判断。因为删除和更新共用一个字段，区别只是删除有一个字节的删除标记，那么在返回的时候 InnoDB 就要判断当前的数据行是否被标记为删除。如果标记了删除，就不会返回。</p>
<p>MVCC 在 READ COMMITED 和 REPEATABLE READ 两个隔离级别下共用一套逻辑，区别只是在于<strong>RC 隔离级别是在读操作开始时刻创建 read view 的，而 RR 隔离级别是在事务开始时刻，确切地说是第一个读操作创建 read view 的。</strong>由于这一点上的不同，使得 MVCC 在 RC 隔离级别下读取的是最新提交的数据，而 RR 隔离级别下读取的是事务开始前提交的数据。</p>
<h2 id="next-key-解决幻读问题"><a href="#next-key-解决幻读问题" class="headerlink" title="next-key 解决幻读问题"></a>next-key 解决幻读问题</h2><p>幻读是指一个事务内连续进行两次相同的 SQL 语句可能导致不同的结果，第二次的 SQL 语句可能会返回之前不存在的行。发生这种现象的原因是事务 A 两次查找的间隔中事务 B 插入了一条或多条数据并提交，导致事务 A 的第二次查询查到了新插入的数据。</p>
<p>InnoDB 中有三种锁算法：</p>
<ul>
<li>Record Lock：单个行记录上的锁</li>
<li>Gap Lock：间隙锁，锁住一个范围，但不包含记录本身</li>
<li>Next-Key Lock：Record Lock+Gap Lock，锁定一个范围，并且锁定记录本身</li>
</ul>
<p>幻读现象问题的根本原因是 Record Lock 只锁住记录本身而不锁范围，导致其它事务可以在记录间插入数据。InnoDB 使用了 Next-Key Lock 来解决这个问题。Next-Key Lock 会锁住一个范围，例如一个索引有 10,11,13,20 这四个值，那么该索引可能被 Next-Key Locking 的区间为：<br>(-∞,10]<br>(10,11]<br>(11,13]<br>(13,20]<br>(20,+∞)</p>
<p>当然，如果查询的索引是唯一索引的话，就不用担心被插入的问题，InnoDB 会对 Next-Key Lock 进行优化，将其降级为 Record Lock。</p>
<h2 id="innodb-加锁处理分析"><a href="#innodb-加锁处理分析" class="headerlink" title="innodb 加锁处理分析"></a>innodb 加锁处理分析</h2><p>以上是理论部分，那么实际 innodb 怎么加锁呢？我们结合 SQL 语句来分析。</p>
<p>在支持 MVCC 并发控制的系统中，读操作可以分成两类：快照读 (snapshot read) 与当前读 (current read)。快照读，读取的是记录的可见版本 (有可能是历史版本)，不用加锁。当前读，读取的是记录的最新版本，并且，当前读返回的记录，都会加上锁，保证其他事务不会再并发修改这条记录。</p>
<ul>
<li>快照读：<ul>
<li>select * from table where ?;</li>
</ul>
</li>
<li>当前读：<ul>
<li>select * from table where ? lock in share mode;</li>
<li>select * from table where ? for update;</li>
<li>insert into table values (…);</li>
<li>update table set ? where ?;</li>
<li>delete from table where ?;</li>
</ul>
</li>
</ul>
<p>简而言之，所有的插入/更新/删除操作都是当前读，且都加了 X 锁；读取操作默认是快照读，但可以声明加 X 锁或者 S 锁。</p>
<h3 id="一条简单-SQL-的加锁实现分析"><a href="#一条简单-SQL-的加锁实现分析" class="headerlink" title="一条简单 SQL 的加锁实现分析"></a>一条简单 SQL 的加锁实现分析</h3><p>我们拿一条 SQL 语句：delete from t1 where id = 10; 来分析 innodb 的加锁情况。但光有这一条 SQL 是不够的，我们还需要知道一些前提：</p>
<ul>
<li>前提 1：id 列是不是主键？</li>
<li>前提 2：当前系统的隔离级别是什么？</li>
<li>前提 3：如果 id 列不是主键，那么 id 列上有索引吗？</li>
<li>前提 4：如果 id 列上有二级索引，那么这个索引是唯一索引吗？</li>
</ul>
<p>基于这些前提的不同，我们可以组合出以下几种情况（隔离级别只考虑 RC 和 RR 的情况）：</p>
<ul>
<li>组合 1：id 列是主键，RC 隔离级别</li>
<li>组合 2：id 列是二级唯一索引，RC 隔离级别</li>
<li>组合 3：id 列是二级非唯一索引，RC 隔离级别</li>
<li>组合 4：id 列上没有索引，RC 隔离级别</li>
<li>组合 5：id 列是主键，RR 隔离级别</li>
<li>组合 6：id 列是二级唯一索引，RR 隔离级别</li>
<li>组合 7：id 列是二级非唯一索引，RR 隔离级别</li>
<li>组合 8：id 列上没有索引，RR 隔离级别</li>
</ul>
<h3 id="组合-1：id-列是主键，RC-隔离级别"><a href="#组合-1：id-列是主键，RC-隔离级别" class="headerlink" title="组合 1：id 列是主键，RC 隔离级别"></a>组合 1：id 列是主键，RC 隔离级别</h3><p>这个组合，是最简单，最容易分析的组合。id 是主键，Read Committed 隔离级别，给定 SQL：delete from t1 where id = 10; 只需要将主键上，id = 10 的记录加上 X 锁即可。如下图所示：</p>
<p><img src="/2019/01/27/InnoDB 中的锁和 MVCC/组合一.jpg"></p>
<p>id 是主键时，此 SQL 只需要在 id=10 这条记录上加 X 锁即可。</p>
<h3 id="组合-2：id-列是二级唯一索引，RC-隔离级别"><a href="#组合-2：id-列是二级唯一索引，RC-隔离级别" class="headerlink" title="组合 2：id 列是二级唯一索引，RC 隔离级别"></a>组合 2：id 列是二级唯一索引，RC 隔离级别</h3><p>这个组合，id 不是主键，而是一个 unique 的二级索引键值。那么在 RC 隔离级别下，delete from t1 where id = 10; 需要加什么锁呢？见下图：</p>
<p><img src="/2019/01/27/InnoDB 中的锁和 MVCC/组合二.jpg"></p>
<p>此组合中，id 是 unique 索引，而主键是 name 列。此时，加锁的情况由于组合一有所不同。由于 id 是 unique 索引，因此 delete 语句会选择走 id 列的索引进行 where 条件的过滤，在找到 id=10 的记录后，首先会将 unique 索引上的 id=10 索引记录加上 X 锁，同时，会根据读取到的 name 列，回主键索引 (聚簇索引)，然后将聚簇索引上的 name = ‘d’ 对应的主键索引项加 X 锁。为什么聚簇索引上的记录也要加锁？试想一下，如果并发的一个 SQL，是通过主键索引来更新：update t1 set id = 100 where name = ‘d’; 此时，如果 delete 语句没有将主键索引上的记录加锁，那么并发的 update 就会感知不到 delete 语句的存在，违背了同一记录上的更新/删除需要串行执行的约束。</p>
<h3 id="组合-3：id-列是二级非唯一索引，RC-隔离级别"><a href="#组合-3：id-列是二级非唯一索引，RC-隔离级别" class="headerlink" title="组合 3：id 列是二级非唯一索引，RC 隔离级别"></a>组合 3：id 列是二级非唯一索引，RC 隔离级别</h3><p>相对于组合一、二，组合三又发生了变化，隔离级别仍旧是 RC 不变，但是 id 列上的约束又降低了，id 列不再唯一，只有一个普通的索引。假设 delete from t1 where id = 10; 语句，仍旧选择 id 列上的索引进行过滤 where 条件，那么此时会持有哪些锁？同样见下图：</p>
<p><img src="/2019/01/27/InnoDB 中的锁和 MVCC/组合三.jpg"></p>
<p>可以看到，首先，id 列索引上，满足 id = 10 查询条件的记录，均已加锁。同时，这些记录对应的主键索引上的记录也都加上了锁。与组合二唯一的区别在于，组合二最多只有一个满足等值查询的记录，而组合三会将所有满足查询条件的记录都加锁。</p>
<h3 id="组合-4：id-列上没有索引，RC-隔离级别"><a href="#组合-4：id-列上没有索引，RC-隔离级别" class="headerlink" title="组合 4：id 列上没有索引，RC 隔离级别"></a>组合 4：id 列上没有索引，RC 隔离级别</h3><p>相对于前面三个组合，这是一个比较特殊的情况。id 列上没有索引，where id = 10;这个过滤条件，没法通过索引进行过滤，那么只能走全表扫描做过滤。对应于这个组合，SQL 会加什么锁？或者是换句话说，全表扫描时，会加什么锁？这个答案也有很多：有人说会在表上加 X 锁；有人说会将聚簇索引上，选择出来的 id = 10;的记录加上 X 锁。那么实际情况呢？请看下图：</p>
<p><img src="/2019/01/27/InnoDB 中的锁和 MVCC/组合四.jpg"></p>
<p>由于 id 列上没有索引，因此只能走聚簇索引，进行全部扫描。从图中可以看到，满足删除条件的记录有两条，但是，聚簇索引上所有的记录，都被加上了 X 锁。无论记录是否满足条件，全部被加上 X 锁。既不是加表锁，也不是在满足条件的记录上加行锁。</p>
<p>有人可能会问？为什么不是只在满足条件的记录上加锁呢？这是由于 MySQL 的实现决定的。如果一个条件无法通过索引快速过滤，那么存储引擎层面就会将所有记录加锁后返回，然后由 MySQL Server 层进行过滤。因此也就把所有的记录，都锁上了。</p>
<h3 id="组合-5：id-列是主键，RR-隔离级别"><a href="#组合-5：id-列是主键，RR-隔离级别" class="headerlink" title="组合 5：id 列是主键，RR 隔离级别"></a>组合 5：id 列是主键，RR 隔离级别</h3><p>上面的四个组合，都是在 Read Committed 隔离级别下的加锁行为，接下来的四个组合，是在 Repeatable Read 隔离级别下的加锁行为。</p>
<p>组合五，id 列是主键列，Repeatable Read 隔离级别，针对 delete from t1 where id = 10; 这条 SQL，加锁与组合一：[id 主键，Read Committed] 一致。</p>
<h3 id="组合-6：id-列是二级唯一索引，RR-隔离级别"><a href="#组合-6：id-列是二级唯一索引，RR-隔离级别" class="headerlink" title="组合 6：id 列是二级唯一索引，RR 隔离级别"></a>组合 6：id 列是二级唯一索引，RR 隔离级别</h3><p>与组合五类似，组合六的加锁，与组合二：[id 唯一索引，Read Committed] 一致。两个 X 锁，id 唯一索引满足条件的记录上一个，对应的聚簇索引上的记录一个。</p>
<h3 id="组合-7：id-列是二级非唯一索引，RR-隔离级别"><a href="#组合-7：id-列是二级非唯一索引，RR-隔离级别" class="headerlink" title="组合 7：id 列是二级非唯一索引，RR 隔离级别"></a>组合 7：id 列是二级非唯一索引，RR 隔离级别</h3><p>组合七，Repeatable Read 隔离级别，id 上有一个非唯一索引，执行 delete from t1 where id = 10; 假设选择 id 列上的索引进行条件过滤，最后的加锁行为，是怎么样的呢？同样看下面这幅图：</p>
<p><img src="/2019/01/27/InnoDB 中的锁和 MVCC/组合七.jpg"></p>
<p>此图，相对于组合三多了一个 GAP 锁，这是因为 RR 级别区别于 RC 级别的一点是 RR 级别要防止幻读。我们在前一节讲过 innodb 基于 Next-Lock 防止幻读，而 Next-Lock 就是 GAP Lock+Record Lock。加在索引上的是 Record Lock，而在中间的就是 GAP Lock。</p>
<p>那么为什么组合五、组合六，也是 RR 隔离级别，却不需要加 GAP 锁呢？这是因为组合五，id 是主键；组合六，id 是 unique 键，都能够保证唯一性。一个等值查询，最多只能返回一条记录，而且新的相同取值的记录，一定不会再新插入进来，因此也就避免了 GAP 锁的使用。</p>
<h3 id="组合-8：id-列上没有索引，RR-隔离级别"><a href="#组合-8：id-列上没有索引，RR-隔离级别" class="headerlink" title="组合 8：id 列上没有索引，RR 隔离级别"></a>组合 8：id 列上没有索引，RR 隔离级别</h3><p>组合八，Repeatable Read 隔离级别下的最后一种情况，id 列上没有索引。此时 SQL：delete from t1 where id = 10; 没有其他的路径可以选择，只能进行全表扫描。最终的加锁情况，如下图所示：</p>
<p><img src="/2019/01/27/InnoDB 中的锁和 MVCC/组合八.jpg"></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">MySQL</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/01/27/InnoDB 中的锁和 MVCC/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-TCP 协议回顾" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/23/TCP 协议回顾/">TCP 协议回顾</a>
    </h1>
  

        
        <a href="/2019/01/23/TCP 协议回顾/" class="archive-article-date">
  	<time datetime="2019-01-23T13:28:32.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-01-23</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<p>本科的时候面向考试学习计算机网络，TCP 是重点中的重点，可惜当时不知道 TCP 在网络世界中的重要，考完试就把知识点扔了。最近在复习计算机网络，看到 TCP 这章，就像看到了一个老朋友。就想把它记录下来，便于复习。</p>
<p>TCP 协议非常复杂，标准也非常多，但核心内容就以下几个部分：</p>
<ul>
<li>三次握手</li>
<li>四次挥手</li>
<li>可靠性传输</li>
<li>流量控制</li>
<li>拥塞控制</li>
</ul>
<h2 id="TCP-协议头"><a href="#TCP-协议头" class="headerlink" title="TCP 协议头"></a>TCP 协议头</h2><p>要想了解 TCP 协议首先就必须了解 TCP 的协议头：<br><img src="/2019/01/23/TCP 协议回顾/TCP 协议头.png"></p>
<p>首先，源端口号和目标端口号是不可少的，这一点和 UDP 是一样的。如果没有这两个端口号。 数据就不知道应该发给哪个应用。</p>
<p>接下来是包的序号和确认序号。为了保证消息的顺序性到达，TCP 给每个包编了一个序号。初始序号在建立连接时指定，此后每个包的序号为上一个包的序号+上一个包的字节数。服务器会返回一个确认号，表示这个序号之前的包都收到了。</p>
<p>然后是一些状态位。例如 SYN 是发起一个连接，ACK 是回复，RST 是重新连接，FIN 是结束连接。TCP 是面向连接的，这些带状态位的包可以改变双方的状态。</p>
<p>窗口大小是跟流量控制有关。TCP 是全双工的协议，通信双方都会维护一个缓存空间。这个窗口大小就是告诉对方我还有多少剩余的缓存空间。</p>
<h2 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h2><p>TCP 是面向连接的协议，所以在建立连接前有一系列的动作，被称为三次握手：<br><img src="/2019/01/23/TCP 协议回顾/三次握手.png"></p>
<p>一开始，客户端和服务端都处于 CLOSED 状态。先是服务端主动监听某个端口，处于 LISTEN 状态。然后客户端主动发起连接 SYN，之后处于 SYN-SENT 状态。服务端收到发起的连接，返回 SYN，并且 ACK 客户端的 SYN，之后处于 SYN-RCVD 状态。客户端收到服务端发送的 SYN 和 ACK 之后，发送 ACK 的 ACK，之后处于 ESTABLISHED 状态，因为它一发一收成功了。服务端收到 ACK 的 ACK 之后，处于 ESTABLISHED 状态，因为它也一发一收了。</p>
<p>三次握手除了双方建立连接外，还要沟通一件事情，就是 TCP 包的序号的问题。</p>
<p>双方在发送 SYN 包的时候，各自需要指定一个针对这次连接的序号 seq。这个 seq 实质上可以看出一个 32 位的计时器，每 4ms 加一。为什么要这么做呢？主要是为了防止在网络中被延迟的分组在以后被重复传输，而导致某个连接的一端对它作错误的判断。如果序号不按这种方式分配，而是从 1 开始，则会出现这样的情况：AB 建立连接之后，A 发送了 1,2,3 三个包，然后掉线了。由于网络的原因三个包没有到达 B，在网络中游荡。然后 A 重连了，序号重新从 1 开始，他又发送了 1,2 两个包，但没有发送 3 号包。此时上一次连接发送的 3 号包却到达了 B，B 以为是 A 这次发送的，就产生了误判。为了避免这种情况的发生，TCP 协议规定了这种方式生成初始 seq。以这种方式生成的初始 seq，需要 4 个多小时才会重复，此时早已过了 3 号包的生存时间（TTL）。</p>
<p><strong>为什么要三次握手而不是两次？</strong></p>
<blockquote>
<p>原因一：服务器会收到客户端很早以前发送的，但因为延迟导致现在才到达的 SYN 报文。如果不采用三次握手，则服务器会认为新的连接已经建立，会白白浪费缓存等资源。<br>原因二：三次握手需要交流双方的初始序号 seq，服务器发送的第二次握手是针对客户端在第一次握手中约定的客户端初始 seq 的确认，客户端的第三次握手是针对服务器在第二次握手中约定的服务器初始 seq 的确认。如果没有第三次握手，万一服务器的 SYN 包丢了，那么客户端无法得知服务器的初始序号，此时客户端就没法接收服务器的包，因为客户端没法辨别这个包是本次连接中发送的，还是上一次连接中发送的。</p>
</blockquote>
<p><strong>SYN 洪泛攻击</strong></p>
<blockquote>
<p>因为服务器在收到一个 SYN 报文后，会初始化连接变量和缓存，如果攻击方会发送大量 SYN 报文，而不完成第三次握手，那么就会导致服务器的连接资源被消耗殆尽。<br>针对 SYN 洪泛攻击有一种有效的防御手段，称为<strong>SYN cookie</strong>：当服务器接收到一个 SYN 报文时，它不知道这是来自一个合法的请求还是 SYN 洪泛攻击的一部分。所以它不会为其分配资源，而是将该报文中的源、目的 IP 地址和端口和服务器自己的秘密数做哈希，将（秒级时间（5 位）+最长分段大小（3 位）+哈希（24 位））作为初始 seq 返回给客户端。<br>如果是一个合法用户，会返回一个 ACK 包，服务器可以通过将 ACK 包中的源、目的 IP 地址和端口，和 ACK-1 对比，得知这是否是一个合法的 SYN 确认包。然后可以通过秒级时间确定这是否是一个新的包。如果是新的包且合法，服务器才会分配资源。这样就有效防止了 SYN 洪泛攻击的发生。</p>
</blockquote>
<h2 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h2><p>有建立连接，必然也有断开连接。断开连接的动作被称为四次挥手：<br><img src="/2019/01/23/TCP 协议回顾/四次挥手.png"></p>
<p>区别于三次握手，四次挥手的发起方可以是客户端也可以是服务端。因此不区分客户端和服务端而是用 AB 代替。</p>
<p>一开始，A 和 B 都处于 ESTABLISHED 的状态。然后 A 发送 FIN 表示请求断开连接，之后 B 处于 FIN-WAIT-1 的状态。</p>
<p>B 在接收到 FIN 请求后，会发送一个 ACK 包表示收到了 FIN 请求，之后 B 处于 CLOSED-WAIT 状态。需要注意的是此时 B 发送的是 ACK 包而不是 FIN 包，之所以不像三次握手一样直接回应一个 FIN 包，是因为此时 B 可能还有些事情没有做完，还可能发送数据，所以称为半关闭状态。</p>
<p>这个时候 A 可以选择不再接收数据，也可以选择最后再接收一段数据，等待 B 也主动关闭。不论如何，A 在收到 ACK 包后都进入了 FIN-WAIT2 阶段。此时如果 B 下线，A 将永远在这个状态。TCP 协议里没有对这个状态的处理，但 Linux 有，可以调整 tcp_fin_timeout 这个参数，设置一个超时时间。</p>
<p>B 处理完了所有的事情，终于也准备关闭，此时会发送一个 FIN 包。之后 B 进入 LAST-ACK 状态，等待 A 的 ACK 包。</p>
<p>A 在收到服务器的 FIN 包后会发送一个 ACK 包表示收到了 B 的 FIN 包。按理说此时 A 就可以关闭了，但由于 A 最后的 ACK 存在丢包的可能，B 没有收到最后的 ACK 包的话，就会重发一个 FIN 包，如果这时候 A 关闭了，B 就再也收不到 ACK 了。因而 TCP 协议要求 A 最后等待一段时间 TIME_WAIT，这个时间要足够长，长到 B 没收到 ACK 的话，重发的 FIN 包还能到达 A。</p>
<p>A 直接关闭还有一个问题是，A 的端口就直接空出来了，但是 B 不知道，B 原来发过的很多包很可能还在路上，如果 A 的端口被一个新的应用占用了，这个新的应用会收到上个连接中 B 发过来的包，虽然序列号是重新生成的，但是这里要上一个双保险，防止产生混乱，因而也需要等足够长的时间，等到原来 B 发送的所有的包都过期了，再空出端口来。</p>
<p>等待的时间设为 2MSL，MSL 是 Maximum Segment Lifetime（报文最大生存时间），它是任何报文在网络上存在的最长时间，超过这个时间报文将被丢弃。因为 TCP 报文基于是 IP 协议的， 而 IP 头中有一个 TTL 域，是 IP 数据报可以经过的最大路由数，每经过一个处理他的路由器此值就减 1，当此值为 0 则数据报将被丢弃，同时发送 ICMP 报文通知源主机。协议规定 MSL 为 2 分钟，实际应用中常用的是 30 秒，1 分钟和 2 分钟等。</p>
<p><strong>服务器大量 CLOSE_WAIT\TIME_WAIT 状态的原因</strong></p>
<blockquote>
<p>如果服务器出现异常，百分之八九十都是下面两种情况：<br>1、服务器保持了大量 CLOSE_WAIT 状态。产生的原因在于：TCP Server 已经 ACK 了过来的 FIN 数据包，但是上层应用程序迟迟没有发命令关闭 Server 到 client 端的连接。所以 TCP 一直在那等啊等…..所以说如果发现自己的服务器保持了大量的 CLOSE_WAIT，问题的根源十有八九是自己的 server 端程序代码的问题。<br>2、服务器保持了大量 TIME_WAIT 状态。产生的原因在于：服务器处理大量高并发短连接并主动关闭连接时容易出现 TIME_WAIT 积压。这是因为关闭的发起方在 TIME_WAIT 阶段需要等待 1-4 分钟才能回收资源。如果连接过多将导致资源来不及回收。解决方案是修改 Linux 内核，允许将 TIME-WAIT sockets 重新用于新的 TCP 连接，并开启 TCP 连接中 TIME-WAIT sockets 的快速回收，这些默认都是关闭的。</p>
</blockquote>
<h2 id="可靠性传输"><a href="#可靠性传输" class="headerlink" title="可靠性传输"></a>可靠性传输</h2><p>TCP 协议为了保证顺序性，每一个包都有一个 ID。在建立连接的时候，会商定起始的 ID 是什么，然后按照 ID 一个个发送。为了保证不丢包，对于发送的包都要进行应答，但是这个应答也不是一个一个来的，而是会应答某个之前的 ID，表示都收到了，这种模式称为累计确认或者累计应答（cumulative acknowledgment）。</p>
<p>为了记录所有发送的包和接收的包，TCP 也需要发送端和接收端分别都有缓存来保存这些记录。发送端的缓存里是按照包的 ID 一个个排列，根据处理的情况分成四个部分。</p>
<ul>
<li>第一部分：发送了并且已经确认的。</li>
<li>第二部分：发送了并且尚未确认的。</li>
<li>第三部分：没有发送，但是已经等待发送的。</li>
<li>第四部分：没有发送，并且暂时还不会发送的。</li>
</ul>
<p>为什么会有三、四部分的区分呢？这是因为接受端有个处理极限，就是剩余缓冲区的大小，如果给接收端发送的包的大小超过了剩余缓冲区的大小，那么有一部分包就会被丢弃，这是不合适的。所以超出剩余缓冲区大小的包，发送端暂时不会发。</p>
<p>于是，发送端需要保持下面的数据结构：<br><img src="/2019/01/23/TCP 协议回顾/发送端滑动窗口.png"></p>
<p>对于接收端来讲，它的缓存里记录的内容要简单一些：</p>
<ul>
<li>第一部分：接收并且确认过的。</li>
<li>第二部分：还没接收，但尚在接收能力范围之内的。</li>
<li>第三部分：还没接收，超过能力范围的。</li>
</ul>
<p>对应的数据结构像这样：<br><img src="/2019/01/23/TCP 协议回顾/接收端滑动窗口.png"></p>
<h3 id="顺序与丢包问题"><a href="#顺序与丢包问题" class="headerlink" title="顺序与丢包问题"></a>顺序与丢包问题</h3><p>还是刚才的图，在发送端来看，1、2、3 已经发送并确认；4、5、6、7、8、9 都是发送了还没确认；10、11、12 是还没发出的；13、14、15 是接收方没有空间，不准备发的。</p>
<p>在接收端来看，1、2、3、4、5 是已经完成 ACK，但是没读取的；6、7 是等待接收的；8、9 是已经接收，但是没有 ACK 的。</p>
<p>发送端和接收端当前的状态如下：</p>
<ul>
<li>1、2、3 没有问题，双方达成了一致。</li>
<li>4、5 接收方说 ACK 了，但是发送方还没收到，有可能丢了，有可能在路上。</li>
<li>6、7、8、9 肯定都发了，但是 8、9 已经到了，但是 6、7 没到，出现了乱序，缓存着但是没办法 ACK。</li>
</ul>
<p>根据这个例子，我们可以知道，顺序问题和丢包问题都有可能发生，所以我们先来看确认与重发的机制。</p>
<p>假设 4 的确认到了，不幸的是，5 的 ACK 丢了，6、7 的数据包丢了，这该怎么办呢？</p>
<p>一种方法就是超时重试，TCP 会为当前最小未应答的包绑定一个定时器，当收到 ACK 时会重启定时器，并绑定到现在最小未应答的包上。若当前无未应答包，则关闭定时器。等下一个包发出去后再启动并绑定到新的包上。</p>
<p>如何设置往返时间 RTT 呢？TCP 采用了加权的自适应重传算法：EstimatedRTT=0.875<em>EstimatedRTT+0.125</em>SampleRTT 其中 EstimatedRTT 为平均往返时间，SampleRTT 为某次采样的往返时间。</p>
<p>如果过一段时间，5、6、7 都超时了，就会重新发送。接收方发现 5 原来接收过，于是丢弃 5；6 收到了，发送 ACK，要求下一个是 7，7 不幸又丢了。当 7 再次超时的时候，有需要重传的时候，TCP 的策略是超时间隔加倍。每当遇到一次超时重传的时候，都会将下一次超时时间间隔设为先前值的两倍。两次超时，就说明网络环境差，不宜频繁反复发送。</p>
<p>超时触发重传存在的问题是，超时周期可能相对较长。那是不是可以有更快的方式呢？</p>
<p>有一个叫<strong>快速重传</strong>的机制：当接收方收到一个序号大于下一个所期望的报文段时，就检测到了数据流中的一个间格，于是发送三个冗余的 ACK，客户端收到后，就在定时器过期之前，重传丢失的报文段。</p>
<p>例如，接收方发现 6、8、9 都已经接收了，就是 7 没来，那肯定是丢了，于是发送三个 6 的 ACK，要求下一个是 7。客户端收到 3 个，就会发现 7 的确又丢了，不等超时，马上重发。</p>
<p>还有一种方式称为<strong>Selective Acknowledgment （SACK）</strong>。这种方式需要在 TCP 头里加一个 SACK 的东西，可以将缓存的地图发送给发送方。例如可以发送 ACK6、SACK8、SACK9，有了地图，发送方一下子就能看出来是 7 丢了。</p>
<h2 id="流量控制"><a href="#流量控制" class="headerlink" title="流量控制"></a>流量控制</h2><p>流量控制是为了平衡发送端与接收端的速度，避免出现包处理不过来的情况。在协议头里面，有一个窗口大小字段，这个就是用来进行流量控制的。</p>
<p>我们先假设窗口不变的情况，窗口始终为 9。4 的确认来的时候，会右移一个，这个时候第 13 个包也可以发送了。<br><img src="/2019/01/23/TCP 协议回顾/流量控制 1.png"></p>
<p>这个时候，假设发送端发送过猛，会将第三部分的 10、11、12、13 全部发送完毕，之后就停止发送了，未发送可发送部分 0。<br><img src="/2019/01/23/TCP 协议回顾/流量控制 2.png"></p>
<p>当对于包 5 的确认到达的时候，在客户端相当于窗口再滑动了一格，这个时候，才可以有更多的包可以发送了，例如第 14 个包才可以发送。<br><img src="/2019/01/23/TCP 协议回顾/流量控制 3.png"></p>
<p>如果接收方实在处理的太慢，导致缓存中没有空间了，可以通过确认信息修改窗口的大小，甚至可以设置为 0，则发送方将暂时停止发送。</p>
<p>我们假设一个极端情况，接收端的应用一直不读取缓存中的数据，当数据包 6 确认后，窗口大小就不能再是 9 了，就要缩小一个变为 8。<br><img src="/2019/01/23/TCP 协议回顾/流量控制 4.png"></p>
<p>这个新的窗口 8 通过 6 的确认消息到达发送端的时候，你会发现窗口没有平行右移，而是仅仅左面的边右移了，窗口的大小从 9 改成了 8。<br><img src="/2019/01/23/TCP 协议回顾/流量控制 5.png"></p>
<p>如果接收端还是一直不处理数据，则随着确认的包越来越多，窗口越来越小，直到为 0。<br><img src="/2019/01/23/TCP 协议回顾/流量控制 6.png"></p>
<p>当这个窗口通过包 14 的确认到达发送端的时候，发送端的窗口也调整为 0，停止发送。<br><img src="/2019/01/23/TCP 协议回顾/流量控制 7.png"></p>
<p>如果这样的话，发送方会定时发送窗口探测数据包，看是否有机会调整窗口的大小。当接收方比较慢的时候，要防止低能窗口综合征，别空出一个字节来就赶快告诉发送方，然后马上又填满 了，可以当窗口太小的时候，不更新窗口，直到达到一定大小，或者缓冲区一半为空，才更新窗口。</p>
<h2 id="拥塞控制"><a href="#拥塞控制" class="headerlink" title="拥塞控制"></a>拥塞控制</h2><p>拥塞控制是为了避免网络中传输着太多的包导致网络拥挤。这里有一个公式，即：发送但还未确认的包要小于等于滑动窗口（rwnd）和拥塞窗口（cwnd）的最小值。前者在流量控制中已经讲过，剩下的就是后者。</p>
<p>拥塞控制有三个时期：<strong>慢启动、拥塞避免和快速恢复。</strong></p>
<p>当开始时，cwnd 设置为一个报文段，一次只能发送一个；当收到这一个确认的时候，cwnd 加一，于是一次能发送两个；当这两个确认到来的时候，每个确认 cwnd 加一，两个确认 cwnd 加二，于是一次能发送四个。当这四个的确认到来的时候，每个确认 cwnd 加一，四个确认 cwnd 加四，于是一次能够发送八个。依次类推，此时，cwnd 的增长速度是指数型的增长。</p>
<p>涨到什么时候是个头呢？有一个值 ssthresh 初始为 65535 个字节，当超过这个值的时候，就进入了拥塞避免状态。此时不再是一个确认对应一个 cwnd 的增长，而是一个确认对应 1/cwnd 的增长。我们接着上面的过程来，一次发送八个，当八个确认到来的时候，每个确认增加 1/8，八个确认一共 cwnd 增加 1，于是一次能够发送九个，变成了线性增长。</p>
<p>但 cwnd 不可能无限增长，总有一个时候网络会拥挤，拥挤的表现形式是丢包。发送端有两种方式感知到丢包：超时和收到三个相同 ACK（快速重传）。针对这两种情况的丢包，发送端的处理方式也不一样。</p>
<p>第一种是超时丢包，这种情况下，发送端会认为当前网络非常拥挤，因此会采取激进的限制措施：将 sshresh 设为 cwnd/2，将 cwnd 设为 1，重新开始慢启动。</p>
<p>第二种是三个相同 ACK 丢包，发送端会认为这个丢包是个偶然事件，因此网络并不非常拥挤，采取的措施也会温和一些：sshresh 设为 cwnd/2，cwnd 设为 cwnd/2，又因为返回了三个确认包，cwnd 再加 3。之后进入快速恢复阶段，因为当前 cwnd 仍在比较高的值，这个阶段中 cwnd 也是线性增长。</p>
<p>两种方式的比较如下：<br><img src="/2019/01/23/TCP 协议回顾/传统算法和快速恢复比较.png"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>TCP 协议的核心部分在于：三次握手、四次挥手、可靠性传输、流量控制、拥塞控制，掌握好这些知识点对网络编程很有帮助。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">计算机网络</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2019/01/23/TCP 协议回顾/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


          </div>
        </div>
      </div>
      <script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-right">
    		<!-- &copy; 2019 huzb -->
		<span id="busuanzi_container_site_pv">本站总访问量		<span id="busuanzi_value_site_pv"></span>次</span>
    	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: true
	}
</script>
<script>!function (t) {
    function n(e) {
      if (r[e]) return r[e].exports;
      var i = r[e] = {exports: {}, id: e, loaded: !1};
      return t[e].call(i.exports, i, i.exports, n), i.loaded = !0, i.exports
    }

    var r = {};
    n.m = t, n.c = r, n.p = "./", n(0)
  }([function (t, n, r) {
    r(195), t.exports = r(191)
  }, function (t, n, r) {
    var e = r(3), i = r(52), o = r(27), u = r(28), c = r(53), f = "prototype", a = function (t, n, r) {
      var s, l, h, v, p = t & a.F, d = t & a.G, y = t & a.S, g = t & a.P, b = t & a.B,
        m = d ? e : y ? e[n] || (e[n] = {}) : (e[n] || {})[f], x = d ? i : i[n] || (i[n] = {}), w = x[f] || (x[f] = {});
      d && (r = n);
      for (s in r) l = !p && m && void 0 !== m[s], h = (l ? m : r)[s], v = b && l ? c(h, e) : g && "function" == typeof h ? c(Function.call, h) : h, m && u(m, s, h, t & a.U), x[s] != h && o(x, s, v), g && w[s] != h && (w[s] = h)
    };
    e.core = i, a.F = 1, a.G = 2, a.S = 4, a.P = 8, a.B = 16, a.W = 32, a.U = 64, a.R = 128, t.exports = a
  }, function (t, n, r) {
    var e = r(6);
    t.exports = function (t) {
      if (!e(t)) throw TypeError(t + " is not an object!");
      return t
    }
  }, function (t, n) {
    var r = t.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")();
    "number" == typeof __g && (__g = r)
  }, function (t, n) {
    t.exports = function (t) {
      try {
        return !!t()
      } catch (t) {
        return !0
      }
    }
  }, function (t, n) {
    var r = t.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")();
    "number" == typeof __g && (__g = r)
  }, function (t, n) {
    t.exports = function (t) {
      return "object" == typeof t ? null !== t : "function" == typeof t
    }
  }, function (t, n, r) {
    var e = r(126)("wks"), i = r(76), o = r(3).Symbol, u = "function" == typeof o;
    (t.exports = function (t) {
      return e[t] || (e[t] = u && o[t] || (u ? o : i)("Symbol." + t))
    }).store = e
  }, function (t, n) {
    var r = {}.hasOwnProperty;
    t.exports = function (t, n) {
      return r.call(t, n)
    }
  }, function (t, n, r) {
    var e = r(94), i = r(33);
    t.exports = function (t) {
      return e(i(t))
    }
  }, function (t, n, r) {
    t.exports = !r(4)(function () {
      return 7 != Object.defineProperty({}, "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n, r) {
    var e = r(2), i = r(167), o = r(50), u = Object.defineProperty;
    n.f = r(10) ? Object.defineProperty : function (t, n, r) {
      if (e(t), n = o(n, !0), e(r), i) try {
        return u(t, n, r)
      } catch (t) {
      }
      if ("get" in r || "set" in r) throw TypeError("Accessors not supported!");
      return "value" in r && (t[n] = r.value), t
    }
  }, function (t, n, r) {
    t.exports = !r(18)(function () {
      return 7 != Object.defineProperty({}, "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n, r) {
    var e = r(14), i = r(22);
    t.exports = r(12) ? function (t, n, r) {
      return e.f(t, n, i(1, r))
    } : function (t, n, r) {
      return t[n] = r, t
    }
  }, function (t, n, r) {
    var e = r(20), i = r(58), o = r(42), u = Object.defineProperty;
    n.f = r(12) ? Object.defineProperty : function (t, n, r) {
      if (e(t), n = o(n, !0), e(r), i) try {
        return u(t, n, r)
      } catch (t) {
      }
      if ("get" in r || "set" in r) throw TypeError("Accessors not supported!");
      return "value" in r && (t[n] = r.value), t
    }
  }, function (t, n, r) {
    var e = r(40)("wks"), i = r(23), o = r(5).Symbol, u = "function" == typeof o;
    (t.exports = function (t) {
      return e[t] || (e[t] = u && o[t] || (u ? o : i)("Symbol." + t))
    }).store = e
  }, function (t, n, r) {
    var e = r(67), i = Math.min;
    t.exports = function (t) {
      return t > 0 ? i(e(t), 9007199254740991) : 0
    }
  }, function (t, n, r) {
    var e = r(46);
    t.exports = function (t) {
      return Object(e(t))
    }
  }, function (t, n) {
    t.exports = function (t) {
      try {
        return !!t()
      } catch (t) {
        return !0
      }
    }
  }, function (t, n, r) {
    var e = r(63), i = r(34);
    t.exports = Object.keys || function (t) {
      return e(t, i)
    }
  }, function (t, n, r) {
    var e = r(21);
    t.exports = function (t) {
      if (!e(t)) throw TypeError(t + " is not an object!");
      return t
    }
  }, function (t, n) {
    t.exports = function (t) {
      return "object" == typeof t ? null !== t : "function" == typeof t
    }
  }, function (t, n) {
    t.exports = function (t, n) {
      return {enumerable: !(1 & t), configurable: !(2 & t), writable: !(4 & t), value: n}
    }
  }, function (t, n) {
    var r = 0, e = Math.random();
    t.exports = function (t) {
      return "Symbol(".concat(void 0 === t ? "" : t, ")_", (++r + e).toString(36))
    }
  }, function (t, n) {
    var r = {}.hasOwnProperty;
    t.exports = function (t, n) {
      return r.call(t, n)
    }
  }, function (t, n) {
    var r = t.exports = {version: "2.4.0"};
    "number" == typeof __e && (__e = r)
  }, function (t, n) {
    t.exports = function (t) {
      if ("function" != typeof t) throw TypeError(t + " is not a function!");
      return t
    }
  }, function (t, n, r) {
    var e = r(11), i = r(66);
    t.exports = r(10) ? function (t, n, r) {
      return e.f(t, n, i(1, r))
    } : function (t, n, r) {
      return t[n] = r, t
    }
  }, function (t, n, r) {
    var e = r(3), i = r(27), o = r(24), u = r(76)("src"), c = "toString", f = Function[c], a = ("" + f).split(c);
    r(52).inspectSource = function (t) {
      return f.call(t)
    }, (t.exports = function (t, n, r, c) {
      var f = "function" == typeof r;
      f && (o(r, "name") || i(r, "name", n)), t[n] !== r && (f && (o(r, u) || i(r, u, t[n] ? "" + t[n] : a.join(String(n)))), t === e ? t[n] = r : c ? t[n] ? t[n] = r : i(t, n, r) : (delete t[n], i(t, n, r)))
    })(Function.prototype, c, function () {
      return "function" == typeof this && this[u] || f.call(this)
    })
  }, function (t, n, r) {
    var e = r(1), i = r(4), o = r(46), u = function (t, n, r, e) {
      var i = String(o(t)), u = "<" + n;
      return "" !== r && (u += " " + r + '="' + String(e).replace(/"/g, "&quot;") + '"'), u + ">" + i + "</" + n + ">"
    };
    t.exports = function (t, n) {
      var r = {};
      r[t] = n(u), e(e.P + e.F * i(function () {
        var n = ""[t]('"');
        return n !== n.toLowerCase() || n.split('"').length > 3
      }), "String", r)
    }
  }, function (t, n, r) {
    var e = r(115), i = r(46);
    t.exports = function (t) {
      return e(i(t))
    }
  }, function (t, n, r) {
    var e = r(116), i = r(66), o = r(30), u = r(50), c = r(24), f = r(167), a = Object.getOwnPropertyDescriptor;
    n.f = r(10) ? a : function (t, n) {
      if (t = o(t), n = u(n, !0), f) try {
        return a(t, n)
      } catch (t) {
      }
      if (c(t, n)) return i(!e.f.call(t, n), t[n])
    }
  }, function (t, n, r) {
    var e = r(24), i = r(17), o = r(145)("IE_PROTO"), u = Object.prototype;
    t.exports = Object.getPrototypeOf || function (t) {
      return t = i(t), e(t, o) ? t[o] : "function" == typeof t.constructor && t instanceof t.constructor ? t.constructor.prototype : t instanceof Object ? u : null
    }
  }, function (t, n) {
    t.exports = function (t) {
      if (void 0 == t) throw TypeError("Can't call method on  " + t);
      return t
    }
  }, function (t, n) {
    t.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")
  }, function (t, n) {
    t.exports = {}
  }, function (t, n) {
    t.exports = !0
  }, function (t, n) {
    n.f = {}.propertyIsEnumerable
  }, function (t, n, r) {
    var e = r(14).f, i = r(8), o = r(15)("toStringTag");
    t.exports = function (t, n, r) {
      t && !i(t = r ? t : t.prototype, o) && e(t, o, {configurable: !0, value: n})
    }
  }, function (t, n, r) {
    var e = r(40)("keys"), i = r(23);
    t.exports = function (t) {
      return e[t] || (e[t] = i(t))
    }
  }, function (t, n, r) {
    var e = r(5), i = "__core-js_shared__", o = e[i] || (e[i] = {});
    t.exports = function (t) {
      return o[t] || (o[t] = {})
    }
  }, function (t, n) {
    var r = Math.ceil, e = Math.floor;
    t.exports = function (t) {
      return isNaN(t = +t) ? 0 : (t > 0 ? e : r)(t)
    }
  }, function (t, n, r) {
    var e = r(21);
    t.exports = function (t, n) {
      if (!e(t)) return t;
      var r, i;
      if (n && "function" == typeof(r = t.toString) && !e(i = r.call(t))) return i;
      if ("function" == typeof(r = t.valueOf) && !e(i = r.call(t))) return i;
      if (!n && "function" == typeof(r = t.toString) && !e(i = r.call(t))) return i;
      throw TypeError("Can't convert object to primitive value")
    }
  }, function (t, n, r) {
    var e = r(5), i = r(25), o = r(36), u = r(44), c = r(14).f;
    t.exports = function (t) {
      var n = i.Symbol || (i.Symbol = o ? {} : e.Symbol || {});
      "_" == t.charAt(0) || t in n || c(n, t, {value: u.f(t)})
    }
  }, function (t, n, r) {
    n.f = r(15)
  }, function (t, n) {
    var r = {}.toString;
    t.exports = function (t) {
      return r.call(t).slice(8, -1)
    }
  }, function (t, n) {
    t.exports = function (t) {
      if (void 0 == t) throw TypeError("Can't call method on  " + t);
      return t
    }
  }, function (t, n, r) {
    var e = r(4);
    t.exports = function (t, n) {
      return !!t && e(function () {
        n ? t.call(null, function () {
        }, 1) : t.call(null)
      })
    }
  }, function (t, n, r) {
    var e = r(53), i = r(115), o = r(17), u = r(16), c = r(203);
    t.exports = function (t, n) {
      var r = 1 == t, f = 2 == t, a = 3 == t, s = 4 == t, l = 6 == t, h = 5 == t || l, v = n || c;
      return function (n, c, p) {
        for (var d, y, g = o(n), b = i(g), m = e(c, p, 3), x = u(b.length), w = 0, S = r ? v(n, x) : f ? v(n, 0) : void 0; x > w; w++) if ((h || w in b) && (d = b[w], y = m(d, w, g), t)) if (r) S[w] = y; else if (y) switch (t) {
          case 3:
            return !0;
          case 5:
            return d;
          case 6:
            return w;
          case 2:
            S.push(d)
        } else if (s) return !1;
        return l ? -1 : a || s ? s : S
      }
    }
  }, function (t, n, r) {
    var e = r(1), i = r(52), o = r(4);
    t.exports = function (t, n) {
      var r = (i.Object || {})[t] || Object[t], u = {};
      u[t] = n(r), e(e.S + e.F * o(function () {
        r(1)
      }), "Object", u)
    }
  }, function (t, n, r) {
    var e = r(6);
    t.exports = function (t, n) {
      if (!e(t)) return t;
      var r, i;
      if (n && "function" == typeof(r = t.toString) && !e(i = r.call(t))) return i;
      if ("function" == typeof(r = t.valueOf) && !e(i = r.call(t))) return i;
      if (!n && "function" == typeof(r = t.toString) && !e(i = r.call(t))) return i;
      throw TypeError("Can't convert object to primitive value")
    }
  }, function (t, n, r) {
    var e = r(5), i = r(25), o = r(91), u = r(13), c = "prototype", f = function (t, n, r) {
      var a, s, l, h = t & f.F, v = t & f.G, p = t & f.S, d = t & f.P, y = t & f.B, g = t & f.W,
        b = v ? i : i[n] || (i[n] = {}), m = b[c], x = v ? e : p ? e[n] : (e[n] || {})[c];
      v && (r = n);
      for (a in r) (s = !h && x && void 0 !== x[a]) && a in b || (l = s ? x[a] : r[a], b[a] = v && "function" != typeof x[a] ? r[a] : y && s ? o(l, e) : g && x[a] == l ? function (t) {
        var n = function (n, r, e) {
          if (this instanceof t) {
            switch (arguments.length) {
              case 0:
                return new t;
              case 1:
                return new t(n);
              case 2:
                return new t(n, r)
            }
            return new t(n, r, e)
          }
          return t.apply(this, arguments)
        };
        return n[c] = t[c], n
      }(l) : d && "function" == typeof l ? o(Function.call, l) : l, d && ((b.virtual || (b.virtual = {}))[a] = l, t & f.R && m && !m[a] && u(m, a, l)))
    };
    f.F = 1, f.G = 2, f.S = 4, f.P = 8, f.B = 16, f.W = 32, f.U = 64, f.R = 128, t.exports = f
  }, function (t, n) {
    var r = t.exports = {version: "2.4.0"};
    "number" == typeof __e && (__e = r)
  }, function (t, n, r) {
    var e = r(26);
    t.exports = function (t, n, r) {
      if (e(t), void 0 === n) return t;
      switch (r) {
        case 1:
          return function (r) {
            return t.call(n, r)
          };
        case 2:
          return function (r, e) {
            return t.call(n, r, e)
          };
        case 3:
          return function (r, e, i) {
            return t.call(n, r, e, i)
          }
      }
      return function () {
        return t.apply(n, arguments)
      }
    }
  }, function (t, n, r) {
    var e = r(183), i = r(1), o = r(126)("metadata"), u = o.store || (o.store = new (r(186))), c = function (t, n, r) {
      var i = u.get(t);
      if (!i) {
        if (!r) return;
        u.set(t, i = new e)
      }
      var o = i.get(n);
      if (!o) {
        if (!r) return;
        i.set(n, o = new e)
      }
      return o
    }, f = function (t, n, r) {
      var e = c(n, r, !1);
      return void 0 !== e && e.has(t)
    }, a = function (t, n, r) {
      var e = c(n, r, !1);
      return void 0 === e ? void 0 : e.get(t)
    }, s = function (t, n, r, e) {
      c(r, e, !0).set(t, n)
    }, l = function (t, n) {
      var r = c(t, n, !1), e = [];
      return r && r.forEach(function (t, n) {
        e.push(n)
      }), e
    }, h = function (t) {
      return void 0 === t || "symbol" == typeof t ? t : String(t)
    }, v = function (t) {
      i(i.S, "Reflect", t)
    };
    t.exports = {store: u, map: c, has: f, get: a, set: s, keys: l, key: h, exp: v}
  }, function (t, n, r) {
    "use strict";
    if (r(10)) {
      var e = r(69), i = r(3), o = r(4), u = r(1), c = r(127), f = r(152), a = r(53), s = r(68), l = r(66), h = r(27),
        v = r(73), p = r(67), d = r(16), y = r(75), g = r(50), b = r(24), m = r(180), x = r(114), w = r(6), S = r(17),
        _ = r(137), O = r(70), E = r(32), P = r(71).f, j = r(154), F = r(76), M = r(7), A = r(48), N = r(117),
        T = r(146), I = r(155), k = r(80), L = r(123), R = r(74), C = r(130), D = r(160), U = r(11), W = r(31), G = U.f,
        B = W.f, V = i.RangeError, z = i.TypeError, q = i.Uint8Array, K = "ArrayBuffer", J = "Shared" + K,
        Y = "BYTES_PER_ELEMENT", H = "prototype", $ = Array[H], X = f.ArrayBuffer, Q = f.DataView, Z = A(0), tt = A(2),
        nt = A(3), rt = A(4), et = A(5), it = A(6), ot = N(!0), ut = N(!1), ct = I.values, ft = I.keys, at = I.entries,
        st = $.lastIndexOf, lt = $.reduce, ht = $.reduceRight, vt = $.join, pt = $.sort, dt = $.slice, yt = $.toString,
        gt = $.toLocaleString, bt = M("iterator"), mt = M("toStringTag"), xt = F("typed_constructor"),
        wt = F("def_constructor"), St = c.CONSTR, _t = c.TYPED, Ot = c.VIEW, Et = "Wrong length!",
        Pt = A(1, function (t, n) {
          return Tt(T(t, t[wt]), n)
        }), jt = o(function () {
          return 1 === new q(new Uint16Array([1]).buffer)[0]
        }), Ft = !!q && !!q[H].set && o(function () {
          new q(1).set({})
        }), Mt = function (t, n) {
          if (void 0 === t) throw z(Et);
          var r = +t, e = d(t);
          if (n && !m(r, e)) throw V(Et);
          return e
        }, At = function (t, n) {
          var r = p(t);
          if (r < 0 || r % n) throw V("Wrong offset!");
          return r
        }, Nt = function (t) {
          if (w(t) && _t in t) return t;
          throw z(t + " is not a typed array!")
        }, Tt = function (t, n) {
          if (!(w(t) && xt in t)) throw z("It is not a typed array constructor!");
          return new t(n)
        }, It = function (t, n) {
          return kt(T(t, t[wt]), n)
        }, kt = function (t, n) {
          for (var r = 0, e = n.length, i = Tt(t, e); e > r;) i[r] = n[r++];
          return i
        }, Lt = function (t, n, r) {
          G(t, n, {
            get: function () {
              return this._d[r]
            }
          })
        }, Rt = function (t) {
          var n, r, e, i, o, u, c = S(t), f = arguments.length, s = f > 1 ? arguments[1] : void 0, l = void 0 !== s,
            h = j(c);
          if (void 0 != h && !_(h)) {
            for (u = h.call(c), e = [], n = 0; !(o = u.next()).done; n++) e.push(o.value);
            c = e
          }
          for (l && f > 2 && (s = a(s, arguments[2], 2)), n = 0, r = d(c.length), i = Tt(this, r); r > n; n++) i[n] = l ? s(c[n], n) : c[n];
          return i
        }, Ct = function () {
          for (var t = 0, n = arguments.length, r = Tt(this, n); n > t;) r[t] = arguments[t++];
          return r
        }, Dt = !!q && o(function () {
          gt.call(new q(1))
        }), Ut = function () {
          return gt.apply(Dt ? dt.call(Nt(this)) : Nt(this), arguments)
        }, Wt = {
          copyWithin: function (t, n) {
            return D.call(Nt(this), t, n, arguments.length > 2 ? arguments[2] : void 0)
          }, every: function (t) {
            return rt(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, fill: function (t) {
            return C.apply(Nt(this), arguments)
          }, filter: function (t) {
            return It(this, tt(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0))
          }, find: function (t) {
            return et(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, findIndex: function (t) {
            return it(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, forEach: function (t) {
            Z(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, indexOf: function (t) {
            return ut(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, includes: function (t) {
            return ot(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, join: function (t) {
            return vt.apply(Nt(this), arguments)
          }, lastIndexOf: function (t) {
            return st.apply(Nt(this), arguments)
          }, map: function (t) {
            return Pt(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, reduce: function (t) {
            return lt.apply(Nt(this), arguments)
          }, reduceRight: function (t) {
            return ht.apply(Nt(this), arguments)
          }, reverse: function () {
            for (var t, n = this, r = Nt(n).length, e = Math.floor(r / 2), i = 0; i < e;) t = n[i], n[i++] = n[--r], n[r] = t;
            return n
          }, some: function (t) {
            return nt(Nt(this), t, arguments.length > 1 ? arguments[1] : void 0)
          }, sort: function (t) {
            return pt.call(Nt(this), t)
          }, subarray: function (t, n) {
            var r = Nt(this), e = r.length, i = y(t, e);
            return new (T(r, r[wt]))(r.buffer, r.byteOffset + i * r.BYTES_PER_ELEMENT, d((void 0 === n ? e : y(n, e)) - i))
          }
        }, Gt = function (t, n) {
          return It(this, dt.call(Nt(this), t, n))
        }, Bt = function (t) {
          Nt(this);
          var n = At(arguments[1], 1), r = this.length, e = S(t), i = d(e.length), o = 0;
          if (i + n > r) throw V(Et);
          for (; o < i;) this[n + o] = e[o++]
        }, Vt = {
          entries: function () {
            return at.call(Nt(this))
          }, keys: function () {
            return ft.call(Nt(this))
          }, values: function () {
            return ct.call(Nt(this))
          }
        }, zt = function (t, n) {
          return w(t) && t[_t] && "symbol" != typeof n && n in t && String(+n) == String(n)
        }, qt = function (t, n) {
          return zt(t, n = g(n, !0)) ? l(2, t[n]) : B(t, n)
        }, Kt = function (t, n, r) {
          return !(zt(t, n = g(n, !0)) && w(r) && b(r, "value")) || b(r, "get") || b(r, "set") || r.configurable || b(r, "writable") && !r.writable || b(r, "enumerable") && !r.enumerable ? G(t, n, r) : (t[n] = r.value, t)
        };
      St || (W.f = qt, U.f = Kt), u(u.S + u.F * !St, "Object", {
        getOwnPropertyDescriptor: qt,
        defineProperty: Kt
      }), o(function () {
        yt.call({})
      }) && (yt = gt = function () {
        return vt.call(this)
      });
      var Jt = v({}, Wt);
      v(Jt, Vt), h(Jt, bt, Vt.values), v(Jt, {
        slice: Gt, set: Bt, constructor: function () {
        }, toString: yt, toLocaleString: Ut
      }), Lt(Jt, "buffer", "b"), Lt(Jt, "byteOffset", "o"), Lt(Jt, "byteLength", "l"), Lt(Jt, "length", "e"), G(Jt, mt, {
        get: function () {
          return this[_t]
        }
      }), t.exports = function (t, n, r, f) {
        f = !!f;
        var a = t + (f ? "Clamped" : "") + "Array", l = "Uint8Array" != a, v = "get" + t, p = "set" + t, y = i[a],
          g = y || {}, b = y && E(y), m = !y || !c.ABV, S = {}, _ = y && y[H], j = function (t, r) {
            var e = t._d;
            return e.v[v](r * n + e.o, jt)
          }, F = function (t, r, e) {
            var i = t._d;
            f && (e = (e = Math.round(e)) < 0 ? 0 : e > 255 ? 255 : 255 & e), i.v[p](r * n + i.o, e, jt)
          }, M = function (t, n) {
            G(t, n, {
              get: function () {
                return j(this, n)
              }, set: function (t) {
                return F(this, n, t)
              }, enumerable: !0
            })
          };
        m ? (y = r(function (t, r, e, i) {
          s(t, y, a, "_d");
          var o, u, c, f, l = 0, v = 0;
          if (w(r)) {
            if (!(r instanceof X || (f = x(r)) == K || f == J)) return _t in r ? kt(y, r) : Rt.call(y, r);
            o = r, v = At(e, n);
            var p = r.byteLength;
            if (void 0 === i) {
              if (p % n) throw V(Et);
              if ((u = p - v) < 0) throw V(Et)
            } else if ((u = d(i) * n) + v > p) throw V(Et);
            c = u / n
          } else c = Mt(r, !0), u = c * n, o = new X(u);
          for (h(t, "_d", {b: o, o: v, l: u, e: c, v: new Q(o)}); l < c;) M(t, l++)
        }), _ = y[H] = O(Jt), h(_, "constructor", y)) : L(function (t) {
          new y(null), new y(t)
        }, !0) || (y = r(function (t, r, e, i) {
          s(t, y, a);
          var o;
          return w(r) ? r instanceof X || (o = x(r)) == K || o == J ? void 0 !== i ? new g(r, At(e, n), i) : void 0 !== e ? new g(r, At(e, n)) : new g(r) : _t in r ? kt(y, r) : Rt.call(y, r) : new g(Mt(r, l))
        }), Z(b !== Function.prototype ? P(g).concat(P(b)) : P(g), function (t) {
          t in y || h(y, t, g[t])
        }), y[H] = _, e || (_.constructor = y));
        var A = _[bt], N = !!A && ("values" == A.name || void 0 == A.name), T = Vt.values;
        h(y, xt, !0), h(_, _t, a), h(_, Ot, !0), h(_, wt, y), (f ? new y(1)[mt] == a : mt in _) || G(_, mt, {
          get: function () {
            return a
          }
        }), S[a] = y, u(u.G + u.W + u.F * (y != g), S), u(u.S, a, {
          BYTES_PER_ELEMENT: n,
          from: Rt,
          of: Ct
        }), Y in _ || h(_, Y, n), u(u.P, a, Wt), R(a), u(u.P + u.F * Ft, a, {set: Bt}), u(u.P + u.F * !N, a, Vt), u(u.P + u.F * (_.toString != yt), a, {toString: yt}), u(u.P + u.F * o(function () {
          new y(1).slice()
        }), a, {slice: Gt}), u(u.P + u.F * (o(function () {
          return [1, 2].toLocaleString() != new y([1, 2]).toLocaleString()
        }) || !o(function () {
          _.toLocaleString.call([1, 2])
        })), a, {toLocaleString: Ut}), k[a] = N ? A : T, e || N || h(_, bt, T)
      }
    } else t.exports = function () {
    }
  }, function (t, n) {
    var r = {}.toString;
    t.exports = function (t) {
      return r.call(t).slice(8, -1)
    }
  }, function (t, n, r) {
    var e = r(21), i = r(5).document, o = e(i) && e(i.createElement);
    t.exports = function (t) {
      return o ? i.createElement(t) : {}
    }
  }, function (t, n, r) {
    t.exports = !r(12) && !r(18)(function () {
      return 7 != Object.defineProperty(r(57)("div"), "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(36), i = r(51), o = r(64), u = r(13), c = r(8), f = r(35), a = r(96), s = r(38), l = r(103),
      h = r(15)("iterator"), v = !([].keys && "next" in [].keys()), p = "keys", d = "values", y = function () {
        return this
      };
    t.exports = function (t, n, r, g, b, m, x) {
      a(r, n, g);
      var w, S, _, O = function (t) {
          if (!v && t in F) return F[t];
          switch (t) {
            case p:
            case d:
              return function () {
                return new r(this, t)
              }
          }
          return function () {
            return new r(this, t)
          }
        }, E = n + " Iterator", P = b == d, j = !1, F = t.prototype, M = F[h] || F["@@iterator"] || b && F[b],
        A = M || O(b), N = b ? P ? O("entries") : A : void 0, T = "Array" == n ? F.entries || M : M;
      if (T && (_ = l(T.call(new t))) !== Object.prototype && (s(_, E, !0), e || c(_, h) || u(_, h, y)), P && M && M.name !== d && (j = !0, A = function () {
          return M.call(this)
        }), e && !x || !v && !j && F[h] || u(F, h, A), f[n] = A, f[E] = y, b) if (w = {
          values: P ? A : O(d),
          keys: m ? A : O(p),
          entries: N
        }, x) for (S in w) S in F || o(F, S, w[S]); else i(i.P + i.F * (v || j), n, w);
      return w
    }
  }, function (t, n, r) {
    var e = r(20), i = r(100), o = r(34), u = r(39)("IE_PROTO"), c = function () {
    }, f = "prototype", a = function () {
      var t, n = r(57)("iframe"), e = o.length;
      for (n.style.display = "none", r(93).appendChild(n), n.src = "javascript:", t = n.contentWindow.document, t.open(), t.write("<script>document.F=Object<\/script>"), t.close(), a = t.F; e--;) delete a[f][o[e]];
      return a()
    };
    t.exports = Object.create || function (t, n) {
      var r;
      return null !== t ? (c[f] = e(t), r = new c, c[f] = null, r[u] = t) : r = a(), void 0 === n ? r : i(r, n)
    }
  }, function (t, n, r) {
    var e = r(63), i = r(34).concat("length", "prototype");
    n.f = Object.getOwnPropertyNames || function (t) {
      return e(t, i)
    }
  }, function (t, n) {
    n.f = Object.getOwnPropertySymbols
  }, function (t, n, r) {
    var e = r(8), i = r(9), o = r(90)(!1), u = r(39)("IE_PROTO");
    t.exports = function (t, n) {
      var r, c = i(t), f = 0, a = [];
      for (r in c) r != u && e(c, r) && a.push(r);
      for (; n.length > f;) e(c, r = n[f++]) && (~o(a, r) || a.push(r));
      return a
    }
  }, function (t, n, r) {
    t.exports = r(13)
  }, function (t, n, r) {
    var e = r(76)("meta"), i = r(6), o = r(24), u = r(11).f, c = 0, f = Object.isExtensible || function () {
      return !0
    }, a = !r(4)(function () {
      return f(Object.preventExtensions({}))
    }), s = function (t) {
      u(t, e, {value: {i: "O" + ++c, w: {}}})
    }, l = function (t, n) {
      if (!i(t)) return "symbol" == typeof t ? t : ("string" == typeof t ? "S" : "P") + t;
      if (!o(t, e)) {
        if (!f(t)) return "F";
        if (!n) return "E";
        s(t)
      }
      return t[e].i
    }, h = function (t, n) {
      if (!o(t, e)) {
        if (!f(t)) return !0;
        if (!n) return !1;
        s(t)
      }
      return t[e].w
    }, v = function (t) {
      return a && p.NEED && f(t) && !o(t, e) && s(t), t
    }, p = t.exports = {KEY: e, NEED: !1, fastKey: l, getWeak: h, onFreeze: v}
  }, function (t, n) {
    t.exports = function (t, n) {
      return {enumerable: !(1 & t), configurable: !(2 & t), writable: !(4 & t), value: n}
    }
  }, function (t, n) {
    var r = Math.ceil, e = Math.floor;
    t.exports = function (t) {
      return isNaN(t = +t) ? 0 : (t > 0 ? e : r)(t)
    }
  }, function (t, n) {
    t.exports = function (t, n, r, e) {
      if (!(t instanceof n) || void 0 !== e && e in t) throw TypeError(r + ": incorrect invocation!");
      return t
    }
  }, function (t, n) {
    t.exports = !1
  }, function (t, n, r) {
    var e = r(2), i = r(173), o = r(133), u = r(145)("IE_PROTO"), c = function () {
    }, f = "prototype", a = function () {
      var t, n = r(132)("iframe"), e = o.length;
      for (n.style.display = "none", r(135).appendChild(n), n.src = "javascript:", t = n.contentWindow.document, t.open(), t.write("<script>document.F=Object<\/script>"), t.close(), a = t.F; e--;) delete a[f][o[e]];
      return a()
    };
    t.exports = Object.create || function (t, n) {
      var r;
      return null !== t ? (c[f] = e(t), r = new c, c[f] = null, r[u] = t) : r = a(), void 0 === n ? r : i(r, n)
    }
  }, function (t, n, r) {
    var e = r(175), i = r(133).concat("length", "prototype");
    n.f = Object.getOwnPropertyNames || function (t) {
      return e(t, i)
    }
  }, function (t, n, r) {
    var e = r(175), i = r(133);
    t.exports = Object.keys || function (t) {
      return e(t, i)
    }
  }, function (t, n, r) {
    var e = r(28);
    t.exports = function (t, n, r) {
      for (var i in n) e(t, i, n[i], r);
      return t
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(3), i = r(11), o = r(10), u = r(7)("species");
    t.exports = function (t) {
      var n = e[t];
      o && n && !n[u] && i.f(n, u, {
        configurable: !0, get: function () {
          return this
        }
      })
    }
  }, function (t, n, r) {
    var e = r(67), i = Math.max, o = Math.min;
    t.exports = function (t, n) {
      return t = e(t), t < 0 ? i(t + n, 0) : o(t, n)
    }
  }, function (t, n) {
    var r = 0, e = Math.random();
    t.exports = function (t) {
      return "Symbol(".concat(void 0 === t ? "" : t, ")_", (++r + e).toString(36))
    }
  }, function (t, n, r) {
    var e = r(33);
    t.exports = function (t) {
      return Object(e(t))
    }
  }, function (t, n, r) {
    var e = r(7)("unscopables"), i = Array.prototype;
    void 0 == i[e] && r(27)(i, e, {}), t.exports = function (t) {
      i[e][t] = !0
    }
  }, function (t, n, r) {
    var e = r(53), i = r(169), o = r(137), u = r(2), c = r(16), f = r(154), a = {}, s = {},
      n = t.exports = function (t, n, r, l, h) {
        var v, p, d, y, g = h ? function () {
          return t
        } : f(t), b = e(r, l, n ? 2 : 1), m = 0;
        if ("function" != typeof g) throw TypeError(t + " is not iterable!");
        if (o(g)) {
          for (v = c(t.length); v > m; m++) if ((y = n ? b(u(p = t[m])[0], p[1]) : b(t[m])) === a || y === s) return y
        } else for (d = g.call(t); !(p = d.next()).done;) if ((y = i(d, b, p.value, n)) === a || y === s) return y
      };
    n.BREAK = a, n.RETURN = s
  }, function (t, n) {
    t.exports = {}
  }, function (t, n, r) {
    var e = r(11).f, i = r(24), o = r(7)("toStringTag");
    t.exports = function (t, n, r) {
      t && !i(t = r ? t : t.prototype, o) && e(t, o, {configurable: !0, value: n})
    }
  }, function (t, n, r) {
    var e = r(1), i = r(46), o = r(4), u = r(150), c = "[" + u + "]", f = "​", a = RegExp("^" + c + c + "*"),
      s = RegExp(c + c + "*$"), l = function (t, n, r) {
        var i = {}, c = o(function () {
          return !!u[t]() || f[t]() != f
        }), a = i[t] = c ? n(h) : u[t];
        r && (i[r] = a), e(e.P + e.F * c, "String", i)
      }, h = l.trim = function (t, n) {
        return t = String(i(t)), 1 & n && (t = t.replace(a, "")), 2 & n && (t = t.replace(s, "")), t
      };
    t.exports = l
  }, function (t, n, r) {
    t.exports = {default: r(86), __esModule: !0}
  }, function (t, n, r) {
    t.exports = {default: r(87), __esModule: !0}
  }, function (t, n, r) {
    "use strict";

    function e(t) {
      return t && t.__esModule ? t : {default: t}
    }

    n.__esModule = !0;
    var i = r(84), o = e(i), u = r(83), c = e(u),
      f = "function" == typeof c.default && "symbol" == typeof o.default ? function (t) {
        return typeof t
      } : function (t) {
        return t && "function" == typeof c.default && t.constructor === c.default && t !== c.default.prototype ? "symbol" : typeof t
      };
    n.default = "function" == typeof c.default && "symbol" === f(o.default) ? function (t) {
      return void 0 === t ? "undefined" : f(t)
    } : function (t) {
      return t && "function" == typeof c.default && t.constructor === c.default && t !== c.default.prototype ? "symbol" : void 0 === t ? "undefined" : f(t)
    }
  }, function (t, n, r) {
    r(110), r(108), r(111), r(112), t.exports = r(25).Symbol
  }, function (t, n, r) {
    r(109), r(113), t.exports = r(44).f("iterator")
  }, function (t, n) {
    t.exports = function (t) {
      if ("function" != typeof t) throw TypeError(t + " is not a function!");
      return t
    }
  }, function (t, n) {
    t.exports = function () {
    }
  }, function (t, n, r) {
    var e = r(9), i = r(106), o = r(105);
    t.exports = function (t) {
      return function (n, r, u) {
        var c, f = e(n), a = i(f.length), s = o(u, a);
        if (t && r != r) {
          for (; a > s;) if ((c = f[s++]) != c) return !0
        } else for (; a > s; s++) if ((t || s in f) && f[s] === r) return t || s || 0;
        return !t && -1
      }
    }
  }, function (t, n, r) {
    var e = r(88);
    t.exports = function (t, n, r) {
      if (e(t), void 0 === n) return t;
      switch (r) {
        case 1:
          return function (r) {
            return t.call(n, r)
          };
        case 2:
          return function (r, e) {
            return t.call(n, r, e)
          };
        case 3:
          return function (r, e, i) {
            return t.call(n, r, e, i)
          }
      }
      return function () {
        return t.apply(n, arguments)
      }
    }
  }, function (t, n, r) {
    var e = r(19), i = r(62), o = r(37);
    t.exports = function (t) {
      var n = e(t), r = i.f;
      if (r) for (var u, c = r(t), f = o.f, a = 0; c.length > a;) f.call(t, u = c[a++]) && n.push(u);
      return n
    }
  }, function (t, n, r) {
    t.exports = r(5).document && document.documentElement
  }, function (t, n, r) {
    var e = r(56);
    t.exports = Object("z").propertyIsEnumerable(0) ? Object : function (t) {
      return "String" == e(t) ? t.split("") : Object(t)
    }
  }, function (t, n, r) {
    var e = r(56);
    t.exports = Array.isArray || function (t) {
      return "Array" == e(t)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(60), i = r(22), o = r(38), u = {};
    r(13)(u, r(15)("iterator"), function () {
      return this
    }), t.exports = function (t, n, r) {
      t.prototype = e(u, {next: i(1, r)}), o(t, n + " Iterator")
    }
  }, function (t, n) {
    t.exports = function (t, n) {
      return {value: n, done: !!t}
    }
  }, function (t, n, r) {
    var e = r(19), i = r(9);
    t.exports = function (t, n) {
      for (var r, o = i(t), u = e(o), c = u.length, f = 0; c > f;) if (o[r = u[f++]] === n) return r
    }
  }, function (t, n, r) {
    var e = r(23)("meta"), i = r(21), o = r(8), u = r(14).f, c = 0, f = Object.isExtensible || function () {
      return !0
    }, a = !r(18)(function () {
      return f(Object.preventExtensions({}))
    }), s = function (t) {
      u(t, e, {value: {i: "O" + ++c, w: {}}})
    }, l = function (t, n) {
      if (!i(t)) return "symbol" == typeof t ? t : ("string" == typeof t ? "S" : "P") + t;
      if (!o(t, e)) {
        if (!f(t)) return "F";
        if (!n) return "E";
        s(t)
      }
      return t[e].i
    }, h = function (t, n) {
      if (!o(t, e)) {
        if (!f(t)) return !0;
        if (!n) return !1;
        s(t)
      }
      return t[e].w
    }, v = function (t) {
      return a && p.NEED && f(t) && !o(t, e) && s(t), t
    }, p = t.exports = {KEY: e, NEED: !1, fastKey: l, getWeak: h, onFreeze: v}
  }, function (t, n, r) {
    var e = r(14), i = r(20), o = r(19);
    t.exports = r(12) ? Object.defineProperties : function (t, n) {
      i(t);
      for (var r, u = o(n), c = u.length, f = 0; c > f;) e.f(t, r = u[f++], n[r]);
      return t
    }
  }, function (t, n, r) {
    var e = r(37), i = r(22), o = r(9), u = r(42), c = r(8), f = r(58), a = Object.getOwnPropertyDescriptor;
    n.f = r(12) ? a : function (t, n) {
      if (t = o(t), n = u(n, !0), f) try {
        return a(t, n)
      } catch (t) {
      }
      if (c(t, n)) return i(!e.f.call(t, n), t[n])
    }
  }, function (t, n, r) {
    var e = r(9), i = r(61).f, o = {}.toString,
      u = "object" == typeof window && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) : [],
      c = function (t) {
        try {
          return i(t)
        } catch (t) {
          return u.slice()
        }
      };
    t.exports.f = function (t) {
      return u && "[object Window]" == o.call(t) ? c(t) : i(e(t))
    }
  }, function (t, n, r) {
    var e = r(8), i = r(77), o = r(39)("IE_PROTO"), u = Object.prototype;
    t.exports = Object.getPrototypeOf || function (t) {
      return t = i(t), e(t, o) ? t[o] : "function" == typeof t.constructor && t instanceof t.constructor ? t.constructor.prototype : t instanceof Object ? u : null
    }
  }, function (t, n, r) {
    var e = r(41), i = r(33);
    t.exports = function (t) {
      return function (n, r) {
        var o, u, c = String(i(n)), f = e(r), a = c.length;
        return f < 0 || f >= a ? t ? "" : void 0 : (o = c.charCodeAt(f), o < 55296 || o > 56319 || f + 1 === a || (u = c.charCodeAt(f + 1)) < 56320 || u > 57343 ? t ? c.charAt(f) : o : t ? c.slice(f, f + 2) : u - 56320 + (o - 55296 << 10) + 65536)
      }
    }
  }, function (t, n, r) {
    var e = r(41), i = Math.max, o = Math.min;
    t.exports = function (t, n) {
      return t = e(t), t < 0 ? i(t + n, 0) : o(t, n)
    }
  }, function (t, n, r) {
    var e = r(41), i = Math.min;
    t.exports = function (t) {
      return t > 0 ? i(e(t), 9007199254740991) : 0
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(89), i = r(97), o = r(35), u = r(9);
    t.exports = r(59)(Array, "Array", function (t, n) {
      this._t = u(t), this._i = 0, this._k = n
    }, function () {
      var t = this._t, n = this._k, r = this._i++;
      return !t || r >= t.length ? (this._t = void 0, i(1)) : "keys" == n ? i(0, r) : "values" == n ? i(0, t[r]) : i(0, [r, t[r]])
    }, "values"), o.Arguments = o.Array, e("keys"), e("values"), e("entries")
  }, function (t, n) {
  }, function (t, n, r) {
    "use strict";
    var e = r(104)(!0);
    r(59)(String, "String", function (t) {
      this._t = String(t), this._i = 0
    }, function () {
      var t, n = this._t, r = this._i;
      return r >= n.length ? {value: void 0, done: !0} : (t = e(n, r), this._i += t.length, {value: t, done: !1})
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(5), i = r(8), o = r(12), u = r(51), c = r(64), f = r(99).KEY, a = r(18), s = r(40), l = r(38), h = r(23),
      v = r(15), p = r(44), d = r(43), y = r(98), g = r(92), b = r(95), m = r(20), x = r(9), w = r(42), S = r(22),
      _ = r(60), O = r(102), E = r(101), P = r(14), j = r(19), F = E.f, M = P.f, A = O.f, N = e.Symbol, T = e.JSON,
      I = T && T.stringify, k = "prototype", L = v("_hidden"), R = v("toPrimitive"), C = {}.propertyIsEnumerable,
      D = s("symbol-registry"), U = s("symbols"), W = s("op-symbols"), G = Object[k], B = "function" == typeof N,
      V = e.QObject, z = !V || !V[k] || !V[k].findChild, q = o && a(function () {
        return 7 != _(M({}, "a", {
          get: function () {
            return M(this, "a", {value: 7}).a
          }
        })).a
      }) ? function (t, n, r) {
        var e = F(G, n);
        e && delete G[n], M(t, n, r), e && t !== G && M(G, n, e)
      } : M, K = function (t) {
        var n = U[t] = _(N[k]);
        return n._k = t, n
      }, J = B && "symbol" == typeof N.iterator ? function (t) {
        return "symbol" == typeof t
      } : function (t) {
        return t instanceof N
      }, Y = function (t, n, r) {
        return t === G && Y(W, n, r), m(t), n = w(n, !0), m(r), i(U, n) ? (r.enumerable ? (i(t, L) && t[L][n] && (t[L][n] = !1), r = _(r, {enumerable: S(0, !1)})) : (i(t, L) || M(t, L, S(1, {})), t[L][n] = !0), q(t, n, r)) : M(t, n, r)
      }, H = function (t, n) {
        m(t);
        for (var r, e = g(n = x(n)), i = 0, o = e.length; o > i;) Y(t, r = e[i++], n[r]);
        return t
      }, $ = function (t, n) {
        return void 0 === n ? _(t) : H(_(t), n)
      }, X = function (t) {
        var n = C.call(this, t = w(t, !0));
        return !(this === G && i(U, t) && !i(W, t)) && (!(n || !i(this, t) || !i(U, t) || i(this, L) && this[L][t]) || n)
      }, Q = function (t, n) {
        if (t = x(t), n = w(n, !0), t !== G || !i(U, n) || i(W, n)) {
          var r = F(t, n);
          return !r || !i(U, n) || i(t, L) && t[L][n] || (r.enumerable = !0), r
        }
      }, Z = function (t) {
        for (var n, r = A(x(t)), e = [], o = 0; r.length > o;) i(U, n = r[o++]) || n == L || n == f || e.push(n);
        return e
      }, tt = function (t) {
        for (var n, r = t === G, e = A(r ? W : x(t)), o = [], u = 0; e.length > u;) !i(U, n = e[u++]) || r && !i(G, n) || o.push(U[n]);
        return o
      };
    B || (N = function () {
      if (this instanceof N) throw TypeError("Symbol is not a constructor!");
      var t = h(arguments.length > 0 ? arguments[0] : void 0), n = function (r) {
        this === G && n.call(W, r), i(this, L) && i(this[L], t) && (this[L][t] = !1), q(this, t, S(1, r))
      };
      return o && z && q(G, t, {configurable: !0, set: n}), K(t)
    }, c(N[k], "toString", function () {
      return this._k
    }), E.f = Q, P.f = Y, r(61).f = O.f = Z, r(37).f = X, r(62).f = tt, o && !r(36) && c(G, "propertyIsEnumerable", X, !0), p.f = function (t) {
      return K(v(t))
    }), u(u.G + u.W + u.F * !B, {Symbol: N});
    for (var nt = "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","), rt = 0; nt.length > rt;) v(nt[rt++]);
    for (var nt = j(v.store), rt = 0; nt.length > rt;) d(nt[rt++]);
    u(u.S + u.F * !B, "Symbol", {
      for: function (t) {
        return i(D, t += "") ? D[t] : D[t] = N(t)
      }, keyFor: function (t) {
        if (J(t)) return y(D, t);
        throw TypeError(t + " is not a symbol!")
      }, useSetter: function () {
        z = !0
      }, useSimple: function () {
        z = !1
      }
    }), u(u.S + u.F * !B, "Object", {
      create: $,
      defineProperty: Y,
      defineProperties: H,
      getOwnPropertyDescriptor: Q,
      getOwnPropertyNames: Z,
      getOwnPropertySymbols: tt
    }), T && u(u.S + u.F * (!B || a(function () {
      var t = N();
      return "[null]" != I([t]) || "{}" != I({a: t}) || "{}" != I(Object(t))
    })), "JSON", {
      stringify: function (t) {
        if (void 0 !== t && !J(t)) {
          for (var n, r, e = [t], i = 1; arguments.length > i;) e.push(arguments[i++]);
          return n = e[1], "function" == typeof n && (r = n), !r && b(n) || (n = function (t, n) {
            if (r && (n = r.call(this, t, n)), !J(n)) return n
          }), e[1] = n, I.apply(T, e)
        }
      }
    }), N[k][R] || r(13)(N[k], R, N[k].valueOf), l(N, "Symbol"), l(Math, "Math", !0), l(e.JSON, "JSON", !0)
  }, function (t, n, r) {
    r(43)("asyncIterator")
  }, function (t, n, r) {
    r(43)("observable")
  }, function (t, n, r) {
    r(107);
    for (var e = r(5), i = r(13), o = r(35), u = r(15)("toStringTag"), c = ["NodeList", "DOMTokenList", "MediaList", "StyleSheetList", "CSSRuleList"], f = 0; f < 5; f++) {
      var a = c[f], s = e[a], l = s && s.prototype;
      l && !l[u] && i(l, u, a), o[a] = o.Array
    }
  }, function (t, n, r) {
    var e = r(45), i = r(7)("toStringTag"), o = "Arguments" == e(function () {
      return arguments
    }()), u = function (t, n) {
      try {
        return t[n]
      } catch (t) {
      }
    };
    t.exports = function (t) {
      var n, r, c;
      return void 0 === t ? "Undefined" : null === t ? "Null" : "string" == typeof(r = u(n = Object(t), i)) ? r : o ? e(n) : "Object" == (c = e(n)) && "function" == typeof n.callee ? "Arguments" : c
    }
  }, function (t, n, r) {
    var e = r(45);
    t.exports = Object("z").propertyIsEnumerable(0) ? Object : function (t) {
      return "String" == e(t) ? t.split("") : Object(t)
    }
  }, function (t, n) {
    n.f = {}.propertyIsEnumerable
  }, function (t, n, r) {
    var e = r(30), i = r(16), o = r(75);
    t.exports = function (t) {
      return function (n, r, u) {
        var c, f = e(n), a = i(f.length), s = o(u, a);
        if (t && r != r) {
          for (; a > s;) if ((c = f[s++]) != c) return !0
        } else for (; a > s; s++) if ((t || s in f) && f[s] === r) return t || s || 0;
        return !t && -1
      }
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(3), i = r(1), o = r(28), u = r(73), c = r(65), f = r(79), a = r(68), s = r(6), l = r(4), h = r(123),
      v = r(81), p = r(136);
    t.exports = function (t, n, r, d, y, g) {
      var b = e[t], m = b, x = y ? "set" : "add", w = m && m.prototype, S = {}, _ = function (t) {
        var n = w[t];
        o(w, t, "delete" == t ? function (t) {
          return !(g && !s(t)) && n.call(this, 0 === t ? 0 : t)
        } : "has" == t ? function (t) {
          return !(g && !s(t)) && n.call(this, 0 === t ? 0 : t)
        } : "get" == t ? function (t) {
          return g && !s(t) ? void 0 : n.call(this, 0 === t ? 0 : t)
        } : "add" == t ? function (t) {
          return n.call(this, 0 === t ? 0 : t), this
        } : function (t, r) {
          return n.call(this, 0 === t ? 0 : t, r), this
        })
      };
      if ("function" == typeof m && (g || w.forEach && !l(function () {
          (new m).entries().next()
        }))) {
        var O = new m, E = O[x](g ? {} : -0, 1) != O, P = l(function () {
          O.has(1)
        }), j = h(function (t) {
          new m(t)
        }), F = !g && l(function () {
          for (var t = new m, n = 5; n--;) t[x](n, n);
          return !t.has(-0)
        });
        j || (m = n(function (n, r) {
          a(n, m, t);
          var e = p(new b, n, m);
          return void 0 != r && f(r, y, e[x], e), e
        }), m.prototype = w, w.constructor = m), (P || F) && (_("delete"), _("has"), y && _("get")), (F || E) && _(x), g && w.clear && delete w.clear
      } else m = d.getConstructor(n, t, y, x), u(m.prototype, r), c.NEED = !0;
      return v(m, t), S[t] = m, i(i.G + i.W + i.F * (m != b), S), g || d.setStrong(m, t, y), m
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(27), i = r(28), o = r(4), u = r(46), c = r(7);
    t.exports = function (t, n, r) {
      var f = c(t), a = r(u, f, ""[t]), s = a[0], l = a[1];
      o(function () {
        var n = {};
        return n[f] = function () {
          return 7
        }, 7 != ""[t](n)
      }) && (i(String.prototype, t, s), e(RegExp.prototype, f, 2 == n ? function (t, n) {
        return l.call(t, this, n)
      } : function (t) {
        return l.call(t, this)
      }))
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(2);
    t.exports = function () {
      var t = e(this), n = "";
      return t.global && (n += "g"), t.ignoreCase && (n += "i"), t.multiline && (n += "m"), t.unicode && (n += "u"), t.sticky && (n += "y"), n
    }
  }, function (t, n) {
    t.exports = function (t, n, r) {
      var e = void 0 === r;
      switch (n.length) {
        case 0:
          return e ? t() : t.call(r);
        case 1:
          return e ? t(n[0]) : t.call(r, n[0]);
        case 2:
          return e ? t(n[0], n[1]) : t.call(r, n[0], n[1]);
        case 3:
          return e ? t(n[0], n[1], n[2]) : t.call(r, n[0], n[1], n[2]);
        case 4:
          return e ? t(n[0], n[1], n[2], n[3]) : t.call(r, n[0], n[1], n[2], n[3])
      }
      return t.apply(r, n)
    }
  }, function (t, n, r) {
    var e = r(6), i = r(45), o = r(7)("match");
    t.exports = function (t) {
      var n;
      return e(t) && (void 0 !== (n = t[o]) ? !!n : "RegExp" == i(t))
    }
  }, function (t, n, r) {
    var e = r(7)("iterator"), i = !1;
    try {
      var o = [7][e]();
      o.return = function () {
        i = !0
      }, Array.from(o, function () {
        throw 2
      })
    } catch (t) {
    }
    t.exports = function (t, n) {
      if (!n && !i) return !1;
      var r = !1;
      try {
        var o = [7], u = o[e]();
        u.next = function () {
          return {done: r = !0}
        }, o[e] = function () {
          return u
        }, t(o)
      } catch (t) {
      }
      return r
    }
  }, function (t, n, r) {
    t.exports = r(69) || !r(4)(function () {
      var t = Math.random();
      __defineSetter__.call(null, t, function () {
      }), delete r(3)[t]
    })
  }, function (t, n) {
    n.f = Object.getOwnPropertySymbols
  }, function (t, n, r) {
    var e = r(3), i = "__core-js_shared__", o = e[i] || (e[i] = {});
    t.exports = function (t) {
      return o[t] || (o[t] = {})
    }
  }, function (t, n, r) {
    for (var e, i = r(3), o = r(27), u = r(76), c = u("typed_array"), f = u("view"), a = !(!i.ArrayBuffer || !i.DataView), s = a, l = 0, h = "Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(","); l < 9;) (e = i[h[l++]]) ? (o(e.prototype, c, !0), o(e.prototype, f, !0)) : s = !1;
    t.exports = {ABV: a, CONSTR: s, TYPED: c, VIEW: f}
  }, function (t, n) {
    "use strict";
    var r = {
      versions: function () {
        var t = window.navigator.userAgent;
        return {
          trident: t.indexOf("Trident") > -1,
          presto: t.indexOf("Presto") > -1,
          webKit: t.indexOf("AppleWebKit") > -1,
          gecko: t.indexOf("Gecko") > -1 && -1 == t.indexOf("KHTML"),
          mobile: !!t.match(/AppleWebKit.*Mobile.*/),
          ios: !!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),
          android: t.indexOf("Android") > -1 || t.indexOf("Linux") > -1,
          iPhone: t.indexOf("iPhone") > -1 || t.indexOf("Mac") > -1,
          iPad: t.indexOf("iPad") > -1,
          webApp: -1 == t.indexOf("Safari"),
          weixin: -1 == t.indexOf("MicroMessenger")
        }
      }()
    };
    t.exports = r
  }, function (t, n, r) {
    "use strict";
    var e = r(85), i = function (t) {
      return t && t.__esModule ? t : {default: t}
    }(e), o = function () {
      function t(t, n, e) {
        return n || e ? String.fromCharCode(n || e) : r[t] || t
      }

      function n(t) {
        return e[t]
      }

      var r = {"&quot;": '"', "&lt;": "<", "&gt;": ">", "&amp;": "&", "&nbsp;": " "}, e = {};
      for (var u in r) e[r[u]] = u;
      return r["&apos;"] = "'", e["'"] = "&#39;", {
        encode: function (t) {
          return t ? ("" + t).replace(/['<> "&]/g, n).replace(/\r?\n/g, "<br/>").replace(/\s/g, "&nbsp;") : ""
        }, decode: function (n) {
          return n ? ("" + n).replace(/<br\s*\/?>/gi, "\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g, t).replace(/\u00a0/g, " ") : ""
        }, encodeBase16: function (t) {
          if (!t) return t;
          t += "";
          for (var n = [], r = 0, e = t.length; e > r; r++) n.push(t.charCodeAt(r).toString(16).toUpperCase());
          return n.join("")
        }, encodeBase16forJSON: function (t) {
          if (!t) return t;
          t = t.replace(/[\u4E00-\u9FBF]/gi, function (t) {
            return escape(t).replace("%u", "\\u")
          });
          for (var n = [], r = 0, e = t.length; e > r; r++) n.push(t.charCodeAt(r).toString(16).toUpperCase());
          return n.join("")
        }, decodeBase16: function (t) {
          if (!t) return t;
          t += "";
          for (var n = [], r = 0, e = t.length; e > r; r += 2) n.push(String.fromCharCode("0x" + t.slice(r, r + 2)));
          return n.join("")
        }, encodeObject: function (t) {
          if (t instanceof Array) for (var n = 0, r = t.length; r > n; n++) t[n] = o.encodeObject(t[n]); else if ("object" == (void 0 === t ? "undefined" : (0, i.default)(t))) for (var e in t) t[e] = o.encodeObject(t[e]); else if ("string" == typeof t) return o.encode(t);
          return t
        }, loadScript: function (t) {
          var n = document.createElement("script");
          document.getElementsByTagName("body")[0].appendChild(n), n.setAttribute("src", t)
        }, addLoadEvent: function (t) {
          var n = window.onload;
          "function" != typeof window.onload ? window.onload = t : window.onload = function () {
            n(), t()
          }
        }
      }
    }();
    t.exports = o
  }, function (t, n, r) {
    "use strict";
    var e = r(17), i = r(75), o = r(16);
    t.exports = function (t) {
      for (var n = e(this), r = o(n.length), u = arguments.length, c = i(u > 1 ? arguments[1] : void 0, r), f = u > 2 ? arguments[2] : void 0, a = void 0 === f ? r : i(f, r); a > c;) n[c++] = t;
      return n
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(11), i = r(66);
    t.exports = function (t, n, r) {
      n in t ? e.f(t, n, i(0, r)) : t[n] = r
    }
  }, function (t, n, r) {
    var e = r(6), i = r(3).document, o = e(i) && e(i.createElement);
    t.exports = function (t) {
      return o ? i.createElement(t) : {}
    }
  }, function (t, n) {
    t.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")
  }, function (t, n, r) {
    var e = r(7)("match");
    t.exports = function (t) {
      var n = /./;
      try {
        "/./"[t](n)
      } catch (r) {
        try {
          return n[e] = !1, !"/./"[t](n)
        } catch (t) {
        }
      }
      return !0
    }
  }, function (t, n, r) {
    t.exports = r(3).document && document.documentElement
  }, function (t, n, r) {
    var e = r(6), i = r(144).set;
    t.exports = function (t, n, r) {
      var o, u = n.constructor;
      return u !== r && "function" == typeof u && (o = u.prototype) !== r.prototype && e(o) && i && i(t, o), t
    }
  }, function (t, n, r) {
    var e = r(80), i = r(7)("iterator"), o = Array.prototype;
    t.exports = function (t) {
      return void 0 !== t && (e.Array === t || o[i] === t)
    }
  }, function (t, n, r) {
    var e = r(45);
    t.exports = Array.isArray || function (t) {
      return "Array" == e(t)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(70), i = r(66), o = r(81), u = {};
    r(27)(u, r(7)("iterator"), function () {
      return this
    }), t.exports = function (t, n, r) {
      t.prototype = e(u, {next: i(1, r)}), o(t, n + " Iterator")
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(69), i = r(1), o = r(28), u = r(27), c = r(24), f = r(80), a = r(139), s = r(81), l = r(32),
      h = r(7)("iterator"), v = !([].keys && "next" in [].keys()), p = "keys", d = "values", y = function () {
        return this
      };
    t.exports = function (t, n, r, g, b, m, x) {
      a(r, n, g);
      var w, S, _, O = function (t) {
          if (!v && t in F) return F[t];
          switch (t) {
            case p:
            case d:
              return function () {
                return new r(this, t)
              }
          }
          return function () {
            return new r(this, t)
          }
        }, E = n + " Iterator", P = b == d, j = !1, F = t.prototype, M = F[h] || F["@@iterator"] || b && F[b],
        A = M || O(b), N = b ? P ? O("entries") : A : void 0, T = "Array" == n ? F.entries || M : M;
      if (T && (_ = l(T.call(new t))) !== Object.prototype && (s(_, E, !0), e || c(_, h) || u(_, h, y)), P && M && M.name !== d && (j = !0, A = function () {
          return M.call(this)
        }), e && !x || !v && !j && F[h] || u(F, h, A), f[n] = A, f[E] = y, b) if (w = {
          values: P ? A : O(d),
          keys: m ? A : O(p),
          entries: N
        }, x) for (S in w) S in F || o(F, S, w[S]); else i(i.P + i.F * (v || j), n, w);
      return w
    }
  }, function (t, n) {
    var r = Math.expm1;
    t.exports = !r || r(10) > 22025.465794806718 || r(10) < 22025.465794806718 || -2e-17 != r(-2e-17) ? function (t) {
      return 0 == (t = +t) ? t : t > -1e-6 && t < 1e-6 ? t + t * t / 2 : Math.exp(t) - 1
    } : r
  }, function (t, n) {
    t.exports = Math.sign || function (t) {
      return 0 == (t = +t) || t != t ? t : t < 0 ? -1 : 1
    }
  }, function (t, n, r) {
    var e = r(3), i = r(151).set, o = e.MutationObserver || e.WebKitMutationObserver, u = e.process, c = e.Promise,
      f = "process" == r(45)(u);
    t.exports = function () {
      var t, n, r, a = function () {
        var e, i;
        for (f && (e = u.domain) && e.exit(); t;) {
          i = t.fn, t = t.next;
          try {
            i()
          } catch (e) {
            throw t ? r() : n = void 0, e
          }
        }
        n = void 0, e && e.enter()
      };
      if (f) r = function () {
        u.nextTick(a)
      }; else if (o) {
        var s = !0, l = document.createTextNode("");
        new o(a).observe(l, {characterData: !0}), r = function () {
          l.data = s = !s
        }
      } else if (c && c.resolve) {
        var h = c.resolve();
        r = function () {
          h.then(a)
        }
      } else r = function () {
        i.call(e, a)
      };
      return function (e) {
        var i = {fn: e, next: void 0};
        n && (n.next = i), t || (t = i, r()), n = i
      }
    }
  }, function (t, n, r) {
    var e = r(6), i = r(2), o = function (t, n) {
      if (i(t), !e(n) && null !== n) throw TypeError(n + ": can't set as prototype!")
    };
    t.exports = {
      set: Object.setPrototypeOf || ("__proto__" in {} ? function (t, n, e) {
        try {
          e = r(53)(Function.call, r(31).f(Object.prototype, "__proto__").set, 2), e(t, []), n = !(t instanceof Array)
        } catch (t) {
          n = !0
        }
        return function (t, r) {
          return o(t, r), n ? t.__proto__ = r : e(t, r), t
        }
      }({}, !1) : void 0), check: o
    }
  }, function (t, n, r) {
    var e = r(126)("keys"), i = r(76);
    t.exports = function (t) {
      return e[t] || (e[t] = i(t))
    }
  }, function (t, n, r) {
    var e = r(2), i = r(26), o = r(7)("species");
    t.exports = function (t, n) {
      var r, u = e(t).constructor;
      return void 0 === u || void 0 == (r = e(u)[o]) ? n : i(r)
    }
  }, function (t, n, r) {
    var e = r(67), i = r(46);
    t.exports = function (t) {
      return function (n, r) {
        var o, u, c = String(i(n)), f = e(r), a = c.length;
        return f < 0 || f >= a ? t ? "" : void 0 : (o = c.charCodeAt(f), o < 55296 || o > 56319 || f + 1 === a || (u = c.charCodeAt(f + 1)) < 56320 || u > 57343 ? t ? c.charAt(f) : o : t ? c.slice(f, f + 2) : u - 56320 + (o - 55296 << 10) + 65536)
      }
    }
  }, function (t, n, r) {
    var e = r(122), i = r(46);
    t.exports = function (t, n, r) {
      if (e(n)) throw TypeError("String#" + r + " doesn't accept regex!");
      return String(i(t))
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(67), i = r(46);
    t.exports = function (t) {
      var n = String(i(this)), r = "", o = e(t);
      if (o < 0 || o == 1 / 0) throw RangeError("Count can't be negative");
      for (; o > 0; (o >>>= 1) && (n += n)) 1 & o && (r += n);
      return r
    }
  }, function (t, n) {
    t.exports = "\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"
  }, function (t, n, r) {
    var e, i, o, u = r(53), c = r(121), f = r(135), a = r(132), s = r(3), l = s.process, h = s.setImmediate,
      v = s.clearImmediate, p = s.MessageChannel, d = 0, y = {}, g = "onreadystatechange", b = function () {
        var t = +this;
        if (y.hasOwnProperty(t)) {
          var n = y[t];
          delete y[t], n()
        }
      }, m = function (t) {
        b.call(t.data)
      };
    h && v || (h = function (t) {
      for (var n = [], r = 1; arguments.length > r;) n.push(arguments[r++]);
      return y[++d] = function () {
        c("function" == typeof t ? t : Function(t), n)
      }, e(d), d
    }, v = function (t) {
      delete y[t]
    }, "process" == r(45)(l) ? e = function (t) {
      l.nextTick(u(b, t, 1))
    } : p ? (i = new p, o = i.port2, i.port1.onmessage = m, e = u(o.postMessage, o, 1)) : s.addEventListener && "function" == typeof postMessage && !s.importScripts ? (e = function (t) {
      s.postMessage(t + "", "*")
    }, s.addEventListener("message", m, !1)) : e = g in a("script") ? function (t) {
      f.appendChild(a("script"))[g] = function () {
        f.removeChild(this), b.call(t)
      }
    } : function (t) {
      setTimeout(u(b, t, 1), 0)
    }), t.exports = {set: h, clear: v}
  }, function (t, n, r) {
    "use strict";
    var e = r(3), i = r(10), o = r(69), u = r(127), c = r(27), f = r(73), a = r(4), s = r(68), l = r(67), h = r(16),
      v = r(71).f, p = r(11).f, d = r(130), y = r(81), g = "ArrayBuffer", b = "DataView", m = "prototype",
      x = "Wrong length!", w = "Wrong index!", S = e[g], _ = e[b], O = e.Math, E = e.RangeError, P = e.Infinity, j = S,
      F = O.abs, M = O.pow, A = O.floor, N = O.log, T = O.LN2, I = "buffer", k = "byteLength", L = "byteOffset",
      R = i ? "_b" : I, C = i ? "_l" : k, D = i ? "_o" : L, U = function (t, n, r) {
        var e, i, o, u = Array(r), c = 8 * r - n - 1, f = (1 << c) - 1, a = f >> 1,
          s = 23 === n ? M(2, -24) - M(2, -77) : 0, l = 0, h = t < 0 || 0 === t && 1 / t < 0 ? 1 : 0;
        for (t = F(t), t != t || t === P ? (i = t != t ? 1 : 0, e = f) : (e = A(N(t) / T), t * (o = M(2, -e)) < 1 && (e--, o *= 2), t += e + a >= 1 ? s / o : s * M(2, 1 - a), t * o >= 2 && (e++, o /= 2), e + a >= f ? (i = 0, e = f) : e + a >= 1 ? (i = (t * o - 1) * M(2, n), e += a) : (i = t * M(2, a - 1) * M(2, n), e = 0)); n >= 8; u[l++] = 255 & i, i /= 256, n -= 8) ;
        for (e = e << n | i, c += n; c > 0; u[l++] = 255 & e, e /= 256, c -= 8) ;
        return u[--l] |= 128 * h, u
      }, W = function (t, n, r) {
        var e, i = 8 * r - n - 1, o = (1 << i) - 1, u = o >> 1, c = i - 7, f = r - 1, a = t[f--], s = 127 & a;
        for (a >>= 7; c > 0; s = 256 * s + t[f], f--, c -= 8) ;
        for (e = s & (1 << -c) - 1, s >>= -c, c += n; c > 0; e = 256 * e + t[f], f--, c -= 8) ;
        if (0 === s) s = 1 - u; else {
          if (s === o) return e ? NaN : a ? -P : P;
          e += M(2, n), s -= u
        }
        return (a ? -1 : 1) * e * M(2, s - n)
      }, G = function (t) {
        return t[3] << 24 | t[2] << 16 | t[1] << 8 | t[0]
      }, B = function (t) {
        return [255 & t]
      }, V = function (t) {
        return [255 & t, t >> 8 & 255]
      }, z = function (t) {
        return [255 & t, t >> 8 & 255, t >> 16 & 255, t >> 24 & 255]
      }, q = function (t) {
        return U(t, 52, 8)
      }, K = function (t) {
        return U(t, 23, 4)
      }, J = function (t, n, r) {
        p(t[m], n, {
          get: function () {
            return this[r]
          }
        })
      }, Y = function (t, n, r, e) {
        var i = +r, o = l(i);
        if (i != o || o < 0 || o + n > t[C]) throw E(w);
        var u = t[R]._b, c = o + t[D], f = u.slice(c, c + n);
        return e ? f : f.reverse()
      }, H = function (t, n, r, e, i, o) {
        var u = +r, c = l(u);
        if (u != c || c < 0 || c + n > t[C]) throw E(w);
        for (var f = t[R]._b, a = c + t[D], s = e(+i), h = 0; h < n; h++) f[a + h] = s[o ? h : n - h - 1]
      }, $ = function (t, n) {
        s(t, S, g);
        var r = +n, e = h(r);
        if (r != e) throw E(x);
        return e
      };
    if (u.ABV) {
      if (!a(function () {
          new S
        }) || !a(function () {
          new S(.5)
        })) {
        S = function (t) {
          return new j($(this, t))
        };
        for (var X, Q = S[m] = j[m], Z = v(j), tt = 0; Z.length > tt;) (X = Z[tt++]) in S || c(S, X, j[X]);
        o || (Q.constructor = S)
      }
      var nt = new _(new S(2)), rt = _[m].setInt8;
      nt.setInt8(0, 2147483648), nt.setInt8(1, 2147483649), !nt.getInt8(0) && nt.getInt8(1) || f(_[m], {
        setInt8: function (t, n) {
          rt.call(this, t, n << 24 >> 24)
        }, setUint8: function (t, n) {
          rt.call(this, t, n << 24 >> 24)
        }
      }, !0)
    } else S = function (t) {
      var n = $(this, t);
      this._b = d.call(Array(n), 0), this[C] = n
    }, _ = function (t, n, r) {
      s(this, _, b), s(t, S, b);
      var e = t[C], i = l(n);
      if (i < 0 || i > e) throw E("Wrong offset!");
      if (r = void 0 === r ? e - i : h(r), i + r > e) throw E(x);
      this[R] = t, this[D] = i, this[C] = r
    }, i && (J(S, k, "_l"), J(_, I, "_b"), J(_, k, "_l"), J(_, L, "_o")), f(_[m], {
      getInt8: function (t) {
        return Y(this, 1, t)[0] << 24 >> 24
      }, getUint8: function (t) {
        return Y(this, 1, t)[0]
      }, getInt16: function (t) {
        var n = Y(this, 2, t, arguments[1]);
        return (n[1] << 8 | n[0]) << 16 >> 16
      }, getUint16: function (t) {
        var n = Y(this, 2, t, arguments[1]);
        return n[1] << 8 | n[0]
      }, getInt32: function (t) {
        return G(Y(this, 4, t, arguments[1]))
      }, getUint32: function (t) {
        return G(Y(this, 4, t, arguments[1])) >>> 0
      }, getFloat32: function (t) {
        return W(Y(this, 4, t, arguments[1]), 23, 4)
      }, getFloat64: function (t) {
        return W(Y(this, 8, t, arguments[1]), 52, 8)
      }, setInt8: function (t, n) {
        H(this, 1, t, B, n)
      }, setUint8: function (t, n) {
        H(this, 1, t, B, n)
      }, setInt16: function (t, n) {
        H(this, 2, t, V, n, arguments[2])
      }, setUint16: function (t, n) {
        H(this, 2, t, V, n, arguments[2])
      }, setInt32: function (t, n) {
        H(this, 4, t, z, n, arguments[2])
      }, setUint32: function (t, n) {
        H(this, 4, t, z, n, arguments[2])
      }, setFloat32: function (t, n) {
        H(this, 4, t, K, n, arguments[2])
      }, setFloat64: function (t, n) {
        H(this, 8, t, q, n, arguments[2])
      }
    });
    y(S, g), y(_, b), c(_[m], u.VIEW, !0), n[g] = S, n[b] = _
  }, function (t, n, r) {
    var e = r(3), i = r(52), o = r(69), u = r(182), c = r(11).f;
    t.exports = function (t) {
      var n = i.Symbol || (i.Symbol = o ? {} : e.Symbol || {});
      "_" == t.charAt(0) || t in n || c(n, t, {value: u.f(t)})
    }
  }, function (t, n, r) {
    var e = r(114), i = r(7)("iterator"), o = r(80);
    t.exports = r(52).getIteratorMethod = function (t) {
      if (void 0 != t) return t[i] || t["@@iterator"] || o[e(t)]
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(78), i = r(170), o = r(80), u = r(30);
    t.exports = r(140)(Array, "Array", function (t, n) {
      this._t = u(t), this._i = 0, this._k = n
    }, function () {
      var t = this._t, n = this._k, r = this._i++;
      return !t || r >= t.length ? (this._t = void 0, i(1)) : "keys" == n ? i(0, r) : "values" == n ? i(0, t[r]) : i(0, [r, t[r]])
    }, "values"), o.Arguments = o.Array, e("keys"), e("values"), e("entries")
  }, function (t, n) {
    function r(t, n) {
      t.classList ? t.classList.add(n) : t.className += " " + n
    }

    t.exports = r
  }, function (t, n) {
    function r(t, n) {
      if (t.classList) t.classList.remove(n); else {
        var r = new RegExp("(^|\\b)" + n.split(" ").join("|") + "(\\b|$)", "gi");
        t.className = t.className.replace(r, " ")
      }
    }

    t.exports = r
  }, function (t, n) {
    function r() {
      throw new Error("setTimeout has not been defined")
    }

    function e() {
      throw new Error("clearTimeout has not been defined")
    }

    function i(t) {
      if (s === setTimeout) return setTimeout(t, 0);
      if ((s === r || !s) && setTimeout) return s = setTimeout, setTimeout(t, 0);
      try {
        return s(t, 0)
      } catch (n) {
        try {
          return s.call(null, t, 0)
        } catch (n) {
          return s.call(this, t, 0)
        }
      }
    }

    function o(t) {
      if (l === clearTimeout) return clearTimeout(t);
      if ((l === e || !l) && clearTimeout) return l = clearTimeout, clearTimeout(t);
      try {
        return l(t)
      } catch (n) {
        try {
          return l.call(null, t)
        } catch (n) {
          return l.call(this, t)
        }
      }
    }

    function u() {
      d && v && (d = !1, v.length ? p = v.concat(p) : y = -1, p.length && c())
    }

    function c() {
      if (!d) {
        var t = i(u);
        d = !0;
        for (var n = p.length; n;) {
          for (v = p, p = []; ++y < n;) v && v[y].run();
          y = -1, n = p.length
        }
        v = null, d = !1, o(t)
      }
    }

    function f(t, n) {
      this.fun = t, this.array = n
    }

    function a() {
    }

    var s, l, h = t.exports = {};
    !function () {
      try {
        s = "function" == typeof setTimeout ? setTimeout : r
      } catch (t) {
        s = r
      }
      try {
        l = "function" == typeof clearTimeout ? clearTimeout : e
      } catch (t) {
        l = e
      }
    }();
    var v, p = [], d = !1, y = -1;
    h.nextTick = function (t) {
      var n = new Array(arguments.length - 1);
      if (arguments.length > 1) for (var r = 1; r < arguments.length; r++) n[r - 1] = arguments[r];
      p.push(new f(t, n)), 1 !== p.length || d || i(c)
    }, f.prototype.run = function () {
      this.fun.apply(null, this.array)
    }, h.title = "browser", h.browser = !0, h.env = {}, h.argv = [], h.version = "", h.versions = {}, h.on = a, h.addListener = a, h.once = a, h.off = a, h.removeListener = a, h.removeAllListeners = a, h.emit = a, h.prependListener = a, h.prependOnceListener = a, h.listeners = function (t) {
      return []
    }, h.binding = function (t) {
      throw new Error("process.binding is not supported")
    }, h.cwd = function () {
      return "/"
    }, h.chdir = function (t) {
      throw new Error("process.chdir is not supported")
    }, h.umask = function () {
      return 0
    }
  }, function (t, n, r) {
    var e = r(45);
    t.exports = function (t, n) {
      if ("number" != typeof t && "Number" != e(t)) throw TypeError(n);
      return +t
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(17), i = r(75), o = r(16);
    t.exports = [].copyWithin || function (t, n) {
      var r = e(this), u = o(r.length), c = i(t, u), f = i(n, u), a = arguments.length > 2 ? arguments[2] : void 0,
        s = Math.min((void 0 === a ? u : i(a, u)) - f, u - c), l = 1;
      for (f < c && c < f + s && (l = -1, f += s - 1, c += s - 1); s-- > 0;) f in r ? r[c] = r[f] : delete r[c], c += l, f += l;
      return r
    }
  }, function (t, n, r) {
    var e = r(79);
    t.exports = function (t, n) {
      var r = [];
      return e(t, !1, r.push, r, n), r
    }
  }, function (t, n, r) {
    var e = r(26), i = r(17), o = r(115), u = r(16);
    t.exports = function (t, n, r, c, f) {
      e(n);
      var a = i(t), s = o(a), l = u(a.length), h = f ? l - 1 : 0, v = f ? -1 : 1;
      if (r < 2) for (; ;) {
        if (h in s) {
          c = s[h], h += v;
          break
        }
        if (h += v, f ? h < 0 : l <= h) throw TypeError("Reduce of empty array with no initial value")
      }
      for (; f ? h >= 0 : l > h; h += v) h in s && (c = n(c, s[h], h, a));
      return c
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(26), i = r(6), o = r(121), u = [].slice, c = {}, f = function (t, n, r) {
      if (!(n in c)) {
        for (var e = [], i = 0; i < n; i++) e[i] = "a[" + i + "]";
        c[n] = Function("F,a", "return new F(" + e.join(",") + ")")
      }
      return c[n](t, r)
    };
    t.exports = Function.bind || function (t) {
      var n = e(this), r = u.call(arguments, 1), c = function () {
        var e = r.concat(u.call(arguments));
        return this instanceof c ? f(n, e.length, e) : o(n, e, t)
      };
      return i(n.prototype) && (c.prototype = n.prototype), c
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(11).f, i = r(70), o = r(73), u = r(53), c = r(68), f = r(46), a = r(79), s = r(140), l = r(170),
      h = r(74), v = r(10), p = r(65).fastKey, d = v ? "_s" : "size", y = function (t, n) {
        var r, e = p(n);
        if ("F" !== e) return t._i[e];
        for (r = t._f; r; r = r.n) if (r.k == n) return r
      };
    t.exports = {
      getConstructor: function (t, n, r, s) {
        var l = t(function (t, e) {
          c(t, l, n, "_i"), t._i = i(null), t._f = void 0, t._l = void 0, t[d] = 0, void 0 != e && a(e, r, t[s], t)
        });
        return o(l.prototype, {
          clear: function () {
            for (var t = this, n = t._i, r = t._f; r; r = r.n) r.r = !0, r.p && (r.p = r.p.n = void 0), delete n[r.i];
            t._f = t._l = void 0, t[d] = 0
          }, delete: function (t) {
            var n = this, r = y(n, t);
            if (r) {
              var e = r.n, i = r.p;
              delete n._i[r.i], r.r = !0, i && (i.n = e), e && (e.p = i), n._f == r && (n._f = e), n._l == r && (n._l = i), n[d]--
            }
            return !!r
          }, forEach: function (t) {
            c(this, l, "forEach");
            for (var n, r = u(t, arguments.length > 1 ? arguments[1] : void 0, 3); n = n ? n.n : this._f;) for (r(n.v, n.k, this); n && n.r;) n = n.p
          }, has: function (t) {
            return !!y(this, t)
          }
        }), v && e(l.prototype, "size", {
          get: function () {
            return f(this[d])
          }
        }), l
      }, def: function (t, n, r) {
        var e, i, o = y(t, n);
        return o ? o.v = r : (t._l = o = {
          i: i = p(n, !0),
          k: n,
          v: r,
          p: e = t._l,
          n: void 0,
          r: !1
        }, t._f || (t._f = o), e && (e.n = o), t[d]++, "F" !== i && (t._i[i] = o)), t
      }, getEntry: y, setStrong: function (t, n, r) {
        s(t, n, function (t, n) {
          this._t = t, this._k = n, this._l = void 0
        }, function () {
          for (var t = this, n = t._k, r = t._l; r && r.r;) r = r.p;
          return t._t && (t._l = r = r ? r.n : t._t._f) ? "keys" == n ? l(0, r.k) : "values" == n ? l(0, r.v) : l(0, [r.k, r.v]) : (t._t = void 0, l(1))
        }, r ? "entries" : "values", !r, !0), h(n)
      }
    }
  }, function (t, n, r) {
    var e = r(114), i = r(161);
    t.exports = function (t) {
      return function () {
        if (e(this) != t) throw TypeError(t + "#toJSON isn't generic");
        return i(this)
      }
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(73), i = r(65).getWeak, o = r(2), u = r(6), c = r(68), f = r(79), a = r(48), s = r(24), l = a(5),
      h = a(6), v = 0, p = function (t) {
        return t._l || (t._l = new d)
      }, d = function () {
        this.a = []
      }, y = function (t, n) {
        return l(t.a, function (t) {
          return t[0] === n
        })
      };
    d.prototype = {
      get: function (t) {
        var n = y(this, t);
        if (n) return n[1]
      }, has: function (t) {
        return !!y(this, t)
      }, set: function (t, n) {
        var r = y(this, t);
        r ? r[1] = n : this.a.push([t, n])
      }, delete: function (t) {
        var n = h(this.a, function (n) {
          return n[0] === t
        });
        return ~n && this.a.splice(n, 1), !!~n
      }
    }, t.exports = {
      getConstructor: function (t, n, r, o) {
        var a = t(function (t, e) {
          c(t, a, n, "_i"), t._i = v++, t._l = void 0, void 0 != e && f(e, r, t[o], t)
        });
        return e(a.prototype, {
          delete: function (t) {
            if (!u(t)) return !1;
            var n = i(t);
            return !0 === n ? p(this).delete(t) : n && s(n, this._i) && delete n[this._i]
          }, has: function (t) {
            if (!u(t)) return !1;
            var n = i(t);
            return !0 === n ? p(this).has(t) : n && s(n, this._i)
          }
        }), a
      }, def: function (t, n, r) {
        var e = i(o(n), !0);
        return !0 === e ? p(t).set(n, r) : e[t._i] = r, t
      }, ufstore: p
    }
  }, function (t, n, r) {
    t.exports = !r(10) && !r(4)(function () {
      return 7 != Object.defineProperty(r(132)("div"), "a", {
        get: function () {
          return 7
        }
      }).a
    })
  }, function (t, n, r) {
    var e = r(6), i = Math.floor;
    t.exports = function (t) {
      return !e(t) && isFinite(t) && i(t) === t
    }
  }, function (t, n, r) {
    var e = r(2);
    t.exports = function (t, n, r, i) {
      try {
        return i ? n(e(r)[0], r[1]) : n(r)
      } catch (n) {
        var o = t.return;
        throw void 0 !== o && e(o.call(t)), n
      }
    }
  }, function (t, n) {
    t.exports = function (t, n) {
      return {value: n, done: !!t}
    }
  }, function (t, n) {
    t.exports = Math.log1p || function (t) {
      return (t = +t) > -1e-8 && t < 1e-8 ? t - t * t / 2 : Math.log(1 + t)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(72), i = r(125), o = r(116), u = r(17), c = r(115), f = Object.assign;
    t.exports = !f || r(4)(function () {
      var t = {}, n = {}, r = Symbol(), e = "abcdefghijklmnopqrst";
      return t[r] = 7, e.split("").forEach(function (t) {
        n[t] = t
      }), 7 != f({}, t)[r] || Object.keys(f({}, n)).join("") != e
    }) ? function (t, n) {
      for (var r = u(t), f = arguments.length, a = 1, s = i.f, l = o.f; f > a;) for (var h, v = c(arguments[a++]), p = s ? e(v).concat(s(v)) : e(v), d = p.length, y = 0; d > y;) l.call(v, h = p[y++]) && (r[h] = v[h]);
      return r
    } : f
  }, function (t, n, r) {
    var e = r(11), i = r(2), o = r(72);
    t.exports = r(10) ? Object.defineProperties : function (t, n) {
      i(t);
      for (var r, u = o(n), c = u.length, f = 0; c > f;) e.f(t, r = u[f++], n[r]);
      return t
    }
  }, function (t, n, r) {
    var e = r(30), i = r(71).f, o = {}.toString,
      u = "object" == typeof window && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) : [],
      c = function (t) {
        try {
          return i(t)
        } catch (t) {
          return u.slice()
        }
      };
    t.exports.f = function (t) {
      return u && "[object Window]" == o.call(t) ? c(t) : i(e(t))
    }
  }, function (t, n, r) {
    var e = r(24), i = r(30), o = r(117)(!1), u = r(145)("IE_PROTO");
    t.exports = function (t, n) {
      var r, c = i(t), f = 0, a = [];
      for (r in c) r != u && e(c, r) && a.push(r);
      for (; n.length > f;) e(c, r = n[f++]) && (~o(a, r) || a.push(r));
      return a
    }
  }, function (t, n, r) {
    var e = r(72), i = r(30), o = r(116).f;
    t.exports = function (t) {
      return function (n) {
        for (var r, u = i(n), c = e(u), f = c.length, a = 0, s = []; f > a;) o.call(u, r = c[a++]) && s.push(t ? [r, u[r]] : u[r]);
        return s
      }
    }
  }, function (t, n, r) {
    var e = r(71), i = r(125), o = r(2), u = r(3).Reflect;
    t.exports = u && u.ownKeys || function (t) {
      var n = e.f(o(t)), r = i.f;
      return r ? n.concat(r(t)) : n
    }
  }, function (t, n, r) {
    var e = r(3).parseFloat, i = r(82).trim;
    t.exports = 1 / e(r(150) + "-0") != -1 / 0 ? function (t) {
      var n = i(String(t), 3), r = e(n);
      return 0 === r && "-" == n.charAt(0) ? -0 : r
    } : e
  }, function (t, n, r) {
    var e = r(3).parseInt, i = r(82).trim, o = r(150), u = /^[\-+]?0[xX]/;
    t.exports = 8 !== e(o + "08") || 22 !== e(o + "0x16") ? function (t, n) {
      var r = i(String(t), 3);
      return e(r, n >>> 0 || (u.test(r) ? 16 : 10))
    } : e
  }, function (t, n) {
    t.exports = Object.is || function (t, n) {
      return t === n ? 0 !== t || 1 / t == 1 / n : t != t && n != n
    }
  }, function (t, n, r) {
    var e = r(16), i = r(149), o = r(46);
    t.exports = function (t, n, r, u) {
      var c = String(o(t)), f = c.length, a = void 0 === r ? " " : String(r), s = e(n);
      if (s <= f || "" == a) return c;
      var l = s - f, h = i.call(a, Math.ceil(l / a.length));
      return h.length > l && (h = h.slice(0, l)), u ? h + c : c + h
    }
  }, function (t, n, r) {
    n.f = r(7)
  }, function (t, n, r) {
    "use strict";
    var e = r(164);
    t.exports = r(118)("Map", function (t) {
      return function () {
        return t(this, arguments.length > 0 ? arguments[0] : void 0)
      }
    }, {
      get: function (t) {
        var n = e.getEntry(this, t);
        return n && n.v
      }, set: function (t, n) {
        return e.def(this, 0 === t ? 0 : t, n)
      }
    }, e, !0)
  }, function (t, n, r) {
    r(10) && "g" != /./g.flags && r(11).f(RegExp.prototype, "flags", {configurable: !0, get: r(120)})
  }, function (t, n, r) {
    "use strict";
    var e = r(164);
    t.exports = r(118)("Set", function (t) {
      return function () {
        return t(this, arguments.length > 0 ? arguments[0] : void 0)
      }
    }, {
      add: function (t) {
        return e.def(this, t = 0 === t ? 0 : t, t)
      }
    }, e)
  }, function (t, n, r) {
    "use strict";
    var e, i = r(48)(0), o = r(28), u = r(65), c = r(172), f = r(166), a = r(6), s = u.getWeak, l = Object.isExtensible,
      h = f.ufstore, v = {}, p = function (t) {
        return function () {
          return t(this, arguments.length > 0 ? arguments[0] : void 0)
        }
      }, d = {
        get: function (t) {
          if (a(t)) {
            var n = s(t);
            return !0 === n ? h(this).get(t) : n ? n[this._i] : void 0
          }
        }, set: function (t, n) {
          return f.def(this, t, n)
        }
      }, y = t.exports = r(118)("WeakMap", p, d, f, !0, !0);
    7 != (new y).set((Object.freeze || Object)(v), 7).get(v) && (e = f.getConstructor(p), c(e.prototype, d), u.NEED = !0, i(["delete", "has", "get", "set"], function (t) {
      var n = y.prototype, r = n[t];
      o(n, t, function (n, i) {
        if (a(n) && !l(n)) {
          this._f || (this._f = new e);
          var o = this._f[t](n, i);
          return "set" == t ? this : o
        }
        return r.call(this, n, i)
      })
    }))
  }, , , , function (t, n) {
    "use strict";

    function r() {
      var t = document.querySelector("#page-nav");
      if (t && !document.querySelector("#page-nav .extend.prev") && (t.innerHTML = '<a class="extend prev disabled" rel="prev">&laquo; Prev</a>' + t.innerHTML), t && !document.querySelector("#page-nav .extend.next") && (t.innerHTML = t.innerHTML + '<a class="extend next disabled" rel="next">Next &raquo;</a>'), yiliaConfig && yiliaConfig.open_in_new) {
        document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function (t) {
          var n = t.getAttribute("target");
          n && "" !== n || t.setAttribute("target", "_blank")
        })
      }
      if (yiliaConfig && yiliaConfig.toc_hide_index) {
        document.querySelectorAll(".toc-number").forEach(function (t) {
          t.style.display = "none"
        })
      }
      var n = document.querySelector("#js-aboutme");
      n && 0 !== n.length && (n.innerHTML = n.innerText)
    }

    t.exports = {init: r}
  }, function (t, n, r) {
    "use strict";

    function e(t) {
      return t && t.__esModule ? t : {default: t}
    }

    function i(t, n) {
      var r = /\/|index.html/g;
      return t.replace(r, "") === n.replace(r, "")
    }

    function o() {
      for (var t = document.querySelectorAll(".js-header-menu li a"), n = window.location.pathname, r = 0, e = t.length; r < e; r++) {
        var o = t[r];
        i(n, o.getAttribute("href")) && (0, h.default)(o, "active")
      }
    }

    function u(t) {
      for (var n = t.offsetLeft, r = t.offsetParent; null !== r;) n += r.offsetLeft, r = r.offsetParent;
      return n
    }

    function c(t) {
      for (var n = t.offsetTop, r = t.offsetParent; null !== r;) n += r.offsetTop, r = r.offsetParent;
      return n
    }

    function f(t, n, r, e, i) {
      var o = u(t), f = c(t) - n;
      if (f - r <= i) {
        var a = t.$newDom;
        a || (a = t.cloneNode(!0), (0, d.default)(t, a), t.$newDom = a, a.style.position = "fixed", a.style.top = (r || f) + "px", a.style.left = o + "px", a.style.zIndex = e || 2, a.style.width = "100%", a.style.color = "#fff"), a.style.visibility = "visible", t.style.visibility = "hidden"
      } else {
        t.style.visibility = "visible";
        var s = t.$newDom;
        s && (s.style.visibility = "hidden")
      }
    }

    function a() {
      var t = document.querySelector(".js-overlay"), n = document.querySelector(".js-header-menu");
      f(t, document.body.scrollTop, -63, 2, 0), f(n, document.body.scrollTop, 1, 3, 0)
    }

    function s() {
      document.querySelector("#container").addEventListener("scroll", function (t) {
        a()
      }), window.addEventListener("scroll", function (t) {
        a()
      }), a()
    }

    var l = r(156), h = e(l), v = r(157), p = (e(v), r(382)), d = e(p), y = r(128), g = e(y), b = r(190), m = e(b),
      x = r(129);
    (function () {
      g.default.versions.mobile && window.screen.width < 800 && (o(), s())
    })(), (0, x.addLoadEvent)(function () {
      m.default.init()
    }), t.exports = {}
  }, , , , function (t, n, r) {
    (function (t) {
      "use strict";

      function n(t, n, r) {
        t[n] || Object[e](t, n, {writable: !0, configurable: !0, value: r})
      }

      if (r(381), r(391), r(198), t._babelPolyfill) throw new Error("only one instance of babel-polyfill is allowed");
      t._babelPolyfill = !0;
      var e = "defineProperty";
      n(String.prototype, "padLeft", "".padStart), n(String.prototype, "padRight", "".padEnd), "pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function (t) {
        [][t] && n(Array, t, Function.call.bind([][t]))
      })
    }).call(n, function () {
      return this
    }())
  }, , , function (t, n, r) {
    r(210), t.exports = r(52).RegExp.escape
  }, , , , function (t, n, r) {
    var e = r(6), i = r(138), o = r(7)("species");
    t.exports = function (t) {
      var n;
      return i(t) && (n = t.constructor, "function" != typeof n || n !== Array && !i(n.prototype) || (n = void 0), e(n) && null === (n = n[o]) && (n = void 0)), void 0 === n ? Array : n
    }
  }, function (t, n, r) {
    var e = r(202);
    t.exports = function (t, n) {
      return new (e(t))(n)
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(2), i = r(50), o = "number";
    t.exports = function (t) {
      if ("string" !== t && t !== o && "default" !== t) throw TypeError("Incorrect hint");
      return i(e(this), t != o)
    }
  }, function (t, n, r) {
    var e = r(72), i = r(125), o = r(116);
    t.exports = function (t) {
      var n = e(t), r = i.f;
      if (r) for (var u, c = r(t), f = o.f, a = 0; c.length > a;) f.call(t, u = c[a++]) && n.push(u);
      return n
    }
  }, function (t, n, r) {
    var e = r(72), i = r(30);
    t.exports = function (t, n) {
      for (var r, o = i(t), u = e(o), c = u.length, f = 0; c > f;) if (o[r = u[f++]] === n) return r
    }
  }, function (t, n, r) {
    "use strict";
    var e = r(208), i = r(121), o = r(26);
    t.exports = function () {
      for (var t = o(this), n = arguments.length, r = Array(n), u = 0, c = e._, f = !1; n > u;) (r[u] = arguments[u++]) === c && (f = !0);
      return function () {
        var e, o = this, u = arguments.length, a = 0, s = 0;
        if (!f && !u) return i(t, r, o);
        if (e = r.slice(), f) for (; n > a; a++) e[a] === c && (e[a] = arguments[s++]);
        for (; u > s;) e.push(arguments[s++]);
        return i(t, e, o)
      }
    }
  }, function (t, n, r) {
    t.exports = r(3)
  }, function (t, n) {
    t.exports = function (t, n) {
      var r = n === Object(n) ? function (t) {
        return n[t]
      } : n;
      return function (n) {
        return String(n).replace(t, r)
      }
    }
  }, function (t, n, r) {
    var e = r(1), i = r(209)(/[\\^$*+?.()|[\]{}]/g, "\\$&");
    e(e.S, "RegExp", {
      escape: function (t) {
        return i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "Array", {copyWithin: r(160)}), r(78)("copyWithin")
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(48)(4);
    e(e.P + e.F * !r(47)([].every, !0), "Array", {
      every: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "Array", {fill: r(130)}), r(78)("fill")
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(48)(2);
    e(e.P + e.F * !r(47)([].filter, !0), "Array", {
      filter: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(48)(6), o = "findIndex", u = !0;
    o in [] && Array(1)[o](function () {
      u = !1
    }), e(e.P + e.F * u, "Array", {
      findIndex: function (t) {
        return i(this, t, arguments.length > 1 ? arguments[1] : void 0)
      }
    }), r(78)(o)
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(48)(5), o = "find", u = !0;
    o in [] && Array(1)[o](function () {
      u = !1
    }), e(e.P + e.F * u, "Array", {
      find: function (t) {
        return i(this, t, arguments.length > 1 ? arguments[1] : void 0)
      }
    }), r(78)(o)
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(48)(0), o = r(47)([].forEach, !0);
    e(e.P + e.F * !o, "Array", {
      forEach: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(53), i = r(1), o = r(17), u = r(169), c = r(137), f = r(16), a = r(131), s = r(154);
    i(i.S + i.F * !r(123)(function (t) {
      Array.from(t)
    }), "Array", {
      from: function (t) {
        var n, r, i, l, h = o(t), v = "function" == typeof this ? this : Array, p = arguments.length,
          d = p > 1 ? arguments[1] : void 0, y = void 0 !== d, g = 0, b = s(h);
        if (y && (d = e(d, p > 2 ? arguments[2] : void 0, 2)), void 0 == b || v == Array && c(b)) for (n = f(h.length), r = new v(n); n > g; g++) a(r, g, y ? d(h[g], g) : h[g]); else for (l = b.call(h), r = new v; !(i = l.next()).done; g++) a(r, g, y ? u(l, d, [i.value, g], !0) : i.value);
        return r.length = g, r
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(117)(!1), o = [].indexOf, u = !!o && 1 / [1].indexOf(1, -0) < 0;
    e(e.P + e.F * (u || !r(47)(o)), "Array", {
      indexOf: function (t) {
        return u ? o.apply(this, arguments) || 0 : i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Array", {isArray: r(138)})
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(30), o = [].join;
    e(e.P + e.F * (r(115) != Object || !r(47)(o)), "Array", {
      join: function (t) {
        return o.call(i(this), void 0 === t ? "," : t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(30), o = r(67), u = r(16), c = [].lastIndexOf, f = !!c && 1 / [1].lastIndexOf(1, -0) < 0;
    e(e.P + e.F * (f || !r(47)(c)), "Array", {
      lastIndexOf: function (t) {
        if (f) return c.apply(this, arguments) || 0;
        var n = i(this), r = u(n.length), e = r - 1;
        for (arguments.length > 1 && (e = Math.min(e, o(arguments[1]))), e < 0 && (e = r + e); e >= 0; e--) if (e in n && n[e] === t) return e || 0;
        return -1
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(48)(1);
    e(e.P + e.F * !r(47)([].map, !0), "Array", {
      map: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(131);
    e(e.S + e.F * r(4)(function () {
      function t() {
      }

      return !(Array.of.call(t) instanceof t)
    }), "Array", {
      of: function () {
        for (var t = 0, n = arguments.length, r = new ("function" == typeof this ? this : Array)(n); n > t;) i(r, t, arguments[t++]);
        return r.length = n, r
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(162);
    e(e.P + e.F * !r(47)([].reduceRight, !0), "Array", {
      reduceRight: function (t) {
        return i(this, t, arguments.length, arguments[1], !0)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(162);
    e(e.P + e.F * !r(47)([].reduce, !0), "Array", {
      reduce: function (t) {
        return i(this, t, arguments.length, arguments[1], !1)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(135), o = r(45), u = r(75), c = r(16), f = [].slice;
    e(e.P + e.F * r(4)(function () {
      i && f.call(i)
    }), "Array", {
      slice: function (t, n) {
        var r = c(this.length), e = o(this);
        if (n = void 0 === n ? r : n, "Array" == e) return f.call(this, t, n);
        for (var i = u(t, r), a = u(n, r), s = c(a - i), l = Array(s), h = 0; h < s; h++) l[h] = "String" == e ? this.charAt(i + h) : this[i + h];
        return l
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(48)(3);
    e(e.P + e.F * !r(47)([].some, !0), "Array", {
      some: function (t) {
        return i(this, t, arguments[1])
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(26), o = r(17), u = r(4), c = [].sort, f = [1, 2, 3];
    e(e.P + e.F * (u(function () {
      f.sort(void 0)
    }) || !u(function () {
      f.sort(null)
    }) || !r(47)(c)), "Array", {
      sort: function (t) {
        return void 0 === t ? c.call(o(this)) : c.call(o(this), i(t))
      }
    })
  }, function (t, n, r) {
    r(74)("Array")
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Date", {
      now: function () {
        return (new Date).getTime()
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(4), o = Date.prototype.getTime, u = function (t) {
      return t > 9 ? t : "0" + t
    };
    e(e.P + e.F * (i(function () {
      return "0385-07-25T07:06:39.999Z" != new Date(-5e13 - 1).toISOString()
    }) || !i(function () {
      new Date(NaN).toISOString()
    })), "Date", {
      toISOString: function () {
        if (!isFinite(o.call(this))) throw RangeError("Invalid time value");
        var t = this, n = t.getUTCFullYear(), r = t.getUTCMilliseconds(), e = n < 0 ? "-" : n > 9999 ? "+" : "";
        return e + ("00000" + Math.abs(n)).slice(e ? -6 : -4) + "-" + u(t.getUTCMonth() + 1) + "-" + u(t.getUTCDate()) + "T" + u(t.getUTCHours()) + ":" + u(t.getUTCMinutes()) + ":" + u(t.getUTCSeconds()) + "." + (r > 99 ? r : "0" + u(r)) + "Z"
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(17), o = r(50);
    e(e.P + e.F * r(4)(function () {
      return null !== new Date(NaN).toJSON() || 1 !== Date.prototype.toJSON.call({
        toISOString: function () {
          return 1
        }
      })
    }), "Date", {
      toJSON: function (t) {
        var n = i(this), r = o(n);
        return "number" != typeof r || isFinite(r) ? n.toISOString() : null
      }
    })
  }, function (t, n, r) {
    var e = r(7)("toPrimitive"), i = Date.prototype;
    e in i || r(27)(i, e, r(204))
  }, function (t, n, r) {
    var e = Date.prototype, i = "Invalid Date", o = "toString", u = e[o], c = e.getTime;
    new Date(NaN) + "" != i && r(28)(e, o, function () {
      var t = c.call(this);
      return t === t ? u.call(this) : i
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "Function", {bind: r(163)})
  }, function (t, n, r) {
    "use strict";
    var e = r(6), i = r(32), o = r(7)("hasInstance"), u = Function.prototype;
    o in u || r(11).f(u, o, {
      value: function (t) {
        if ("function" != typeof this || !e(t)) return !1;
        if (!e(this.prototype)) return t instanceof this;
        for (; t = i(t);) if (this.prototype === t) return !0;
        return !1
      }
    })
  }, function (t, n, r) {
    var e = r(11).f, i = r(66), o = r(24), u = Function.prototype, c = "name", f = Object.isExtensible || function () {
      return !0
    };
    c in u || r(10) && e(u, c, {
      configurable: !0, get: function () {
        try {
          var t = this, n = ("" + t).match(/^\s*function ([^ (]*)/)[1];
          return o(t, c) || !f(t) || e(t, c, i(5, n)), n
        } catch (t) {
          return ""
        }
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(171), o = Math.sqrt, u = Math.acosh;
    e(e.S + e.F * !(u && 710 == Math.floor(u(Number.MAX_VALUE)) && u(1 / 0) == 1 / 0), "Math", {
      acosh: function (t) {
        return (t = +t) < 1 ? NaN : t > 94906265.62425156 ? Math.log(t) + Math.LN2 : i(t - 1 + o(t - 1) * o(t + 1))
      }
    })
  }, function (t, n, r) {
    function e(t) {
      return isFinite(t = +t) && 0 != t ? t < 0 ? -e(-t) : Math.log(t + Math.sqrt(t * t + 1)) : t
    }

    var i = r(1), o = Math.asinh;
    i(i.S + i.F * !(o && 1 / o(0) > 0), "Math", {asinh: e})
  }, function (t, n, r) {
    var e = r(1), i = Math.atanh;
    e(e.S + e.F * !(i && 1 / i(-0) < 0), "Math", {
      atanh: function (t) {
        return 0 == (t = +t) ? t : Math.log((1 + t) / (1 - t)) / 2
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(142);
    e(e.S, "Math", {
      cbrt: function (t) {
        return i(t = +t) * Math.pow(Math.abs(t), 1 / 3)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      clz32: function (t) {
        return (t >>>= 0) ? 31 - Math.floor(Math.log(t + .5) * Math.LOG2E) : 32
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = Math.exp;
    e(e.S, "Math", {
      cosh: function (t) {
        return (i(t = +t) + i(-t)) / 2
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(141);
    e(e.S + e.F * (i != Math.expm1), "Math", {expm1: i})
  }, function (t, n, r) {
    var e = r(1), i = r(142), o = Math.pow, u = o(2, -52), c = o(2, -23), f = o(2, 127) * (2 - c), a = o(2, -126),
      s = function (t) {
        return t + 1 / u - 1 / u
      };
    e(e.S, "Math", {
      fround: function (t) {
        var n, r, e = Math.abs(t), o = i(t);
        return e < a ? o * s(e / a / c) * a * c : (n = (1 + c / u) * e, r = n - (n - e), r > f || r != r ? o * (1 / 0) : o * r)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = Math.abs;
    e(e.S, "Math", {
      hypot: function (t, n) {
        for (var r, e, o = 0, u = 0, c = arguments.length, f = 0; u < c;) r = i(arguments[u++]), f < r ? (e = f / r, o = o * e * e + 1, f = r) : r > 0 ? (e = r / f, o += e * e) : o += r;
        return f === 1 / 0 ? 1 / 0 : f * Math.sqrt(o)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = Math.imul;
    e(e.S + e.F * r(4)(function () {
      return -5 != i(4294967295, 5) || 2 != i.length
    }), "Math", {
      imul: function (t, n) {
        var r = 65535, e = +t, i = +n, o = r & e, u = r & i;
        return 0 | o * u + ((r & e >>> 16) * u + o * (r & i >>> 16) << 16 >>> 0)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      log10: function (t) {
        return Math.log(t) / Math.LN10
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {log1p: r(171)})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      log2: function (t) {
        return Math.log(t) / Math.LN2
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {sign: r(142)})
  }, function (t, n, r) {
    var e = r(1), i = r(141), o = Math.exp;
    e(e.S + e.F * r(4)(function () {
      return -2e-17 != !Math.sinh(-2e-17)
    }), "Math", {
      sinh: function (t) {
        return Math.abs(t = +t) < 1 ? (i(t) - i(-t)) / 2 : (o(t - 1) - o(-t - 1)) * (Math.E / 2)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(141), o = Math.exp;
    e(e.S, "Math", {
      tanh: function (t) {
        var n = i(t = +t), r = i(-t);
        return n == 1 / 0 ? 1 : r == 1 / 0 ? -1 : (n - r) / (o(t) + o(-t))
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      trunc: function (t) {
        return (t > 0 ? Math.floor : Math.ceil)(t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(3), i = r(24), o = r(45), u = r(136), c = r(50), f = r(4), a = r(71).f, s = r(31).f, l = r(11).f,
      h = r(82).trim, v = "Number", p = e[v], d = p, y = p.prototype, g = o(r(70)(y)) == v,
      b = "trim" in String.prototype, m = function (t) {
        var n = c(t, !1);
        if ("string" == typeof n && n.length > 2) {
          n = b ? n.trim() : h(n, 3);
          var r, e, i, o = n.charCodeAt(0);
          if (43 === o || 45 === o) {
            if (88 === (r = n.charCodeAt(2)) || 120 === r) return NaN
          } else if (48 === o) {
            switch (n.charCodeAt(1)) {
              case 66:
              case 98:
                e = 2, i = 49;
                break;
              case 79:
              case 111:
                e = 8, i = 55;
                break;
              default:
                return +n
            }
            for (var u, f = n.slice(2), a = 0, s = f.length; a < s; a++) if ((u = f.charCodeAt(a)) < 48 || u > i) return NaN;
            return parseInt(f, e)
          }
        }
        return +n
      };
    if (!p(" 0o1") || !p("0b1") || p("+0x1")) {
      p = function (t) {
        var n = arguments.length < 1 ? 0 : t, r = this;
        return r instanceof p && (g ? f(function () {
          y.valueOf.call(r)
        }) : o(r) != v) ? u(new d(m(n)), r, p) : m(n)
      };
      for (var x, w = r(10) ? a(d) : "MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","), S = 0; w.length > S; S++) i(d, x = w[S]) && !i(p, x) && l(p, x, s(d, x));
      p.prototype = y, y.constructor = p, r(28)(e, v, p)
    }
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {EPSILON: Math.pow(2, -52)})
  }, function (t, n, r) {
    var e = r(1), i = r(3).isFinite;
    e(e.S, "Number", {
      isFinite: function (t) {
        return "number" == typeof t && i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {isInteger: r(168)})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {
      isNaN: function (t) {
        return t != t
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(168), o = Math.abs;
    e(e.S, "Number", {
      isSafeInteger: function (t) {
        return i(t) && o(t) <= 9007199254740991
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {MAX_SAFE_INTEGER: 9007199254740991})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Number", {MIN_SAFE_INTEGER: -9007199254740991})
  }, function (t, n, r) {
    var e = r(1), i = r(178);
    e(e.S + e.F * (Number.parseFloat != i), "Number", {parseFloat: i})
  }, function (t, n, r) {
    var e = r(1), i = r(179);
    e(e.S + e.F * (Number.parseInt != i), "Number", {parseInt: i})
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(67), o = r(159), u = r(149), c = 1..toFixed, f = Math.floor, a = [0, 0, 0, 0, 0, 0],
      s = "Number.toFixed: incorrect invocation!", l = "0", h = function (t, n) {
        for (var r = -1, e = n; ++r < 6;) e += t * a[r], a[r] = e % 1e7, e = f(e / 1e7)
      }, v = function (t) {
        for (var n = 6, r = 0; --n >= 0;) r += a[n], a[n] = f(r / t), r = r % t * 1e7
      }, p = function () {
        for (var t = 6, n = ""; --t >= 0;) if ("" !== n || 0 === t || 0 !== a[t]) {
          var r = String(a[t]);
          n = "" === n ? r : n + u.call(l, 7 - r.length) + r
        }
        return n
      }, d = function (t, n, r) {
        return 0 === n ? r : n % 2 == 1 ? d(t, n - 1, r * t) : d(t * t, n / 2, r)
      }, y = function (t) {
        for (var n = 0, r = t; r >= 4096;) n += 12, r /= 4096;
        for (; r >= 2;) n += 1, r /= 2;
        return n
      };
    e(e.P + e.F * (!!c && ("0.000" !== 8e-5.toFixed(3) || "1" !== .9.toFixed(0) || "1.25" !== 1.255.toFixed(2) || "1000000000000000128" !== (0xde0b6b3a7640080).toFixed(0)) || !r(4)(function () {
      c.call({})
    })), "Number", {
      toFixed: function (t) {
        var n, r, e, c, f = o(this, s), a = i(t), g = "", b = l;
        if (a < 0 || a > 20) throw RangeError(s);
        if (f != f) return "NaN";
        if (f <= -1e21 || f >= 1e21) return String(f);
        if (f < 0 && (g = "-", f = -f), f > 1e-21) if (n = y(f * d(2, 69, 1)) - 69, r = n < 0 ? f * d(2, -n, 1) : f / d(2, n, 1), r *= 4503599627370496, (n = 52 - n) > 0) {
          for (h(0, r), e = a; e >= 7;) h(1e7, 0), e -= 7;
          for (h(d(10, e, 1), 0), e = n - 1; e >= 23;) v(1 << 23), e -= 23;
          v(1 << e), h(1, 1), v(2), b = p()
        } else h(0, r), h(1 << -n, 0), b = p() + u.call(l, a);
        return a > 0 ? (c = b.length, b = g + (c <= a ? "0." + u.call(l, a - c) + b : b.slice(0, c - a) + "." + b.slice(c - a))) : b = g + b, b
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(4), o = r(159), u = 1..toPrecision;
    e(e.P + e.F * (i(function () {
      return "1" !== u.call(1, void 0)
    }) || !i(function () {
      u.call({})
    })), "Number", {
      toPrecision: function (t) {
        var n = o(this, "Number#toPrecision: incorrect invocation!");
        return void 0 === t ? u.call(n) : u.call(n, t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S + e.F, "Object", {assign: r(172)})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Object", {create: r(70)})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S + e.F * !r(10), "Object", {defineProperties: r(173)})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S + e.F * !r(10), "Object", {defineProperty: r(11).f})
  }, function (t, n, r) {
    var e = r(6), i = r(65).onFreeze;
    r(49)("freeze", function (t) {
      return function (n) {
        return t && e(n) ? t(i(n)) : n
      }
    })
  }, function (t, n, r) {
    var e = r(30), i = r(31).f;
    r(49)("getOwnPropertyDescriptor", function () {
      return function (t, n) {
        return i(e(t), n)
      }
    })
  }, function (t, n, r) {
    r(49)("getOwnPropertyNames", function () {
      return r(174).f
    })
  }, function (t, n, r) {
    var e = r(17), i = r(32);
    r(49)("getPrototypeOf", function () {
      return function (t) {
        return i(e(t))
      }
    })
  }, function (t, n, r) {
    var e = r(6);
    r(49)("isExtensible", function (t) {
      return function (n) {
        return !!e(n) && (!t || t(n))
      }
    })
  }, function (t, n, r) {
    var e = r(6);
    r(49)("isFrozen", function (t) {
      return function (n) {
        return !e(n) || !!t && t(n)
      }
    })
  }, function (t, n, r) {
    var e = r(6);
    r(49)("isSealed", function (t) {
      return function (n) {
        return !e(n) || !!t && t(n)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Object", {is: r(180)})
  }, function (t, n, r) {
    var e = r(17), i = r(72);
    r(49)("keys", function () {
      return function (t) {
        return i(e(t))
      }
    })
  }, function (t, n, r) {
    var e = r(6), i = r(65).onFreeze;
    r(49)("preventExtensions", function (t) {
      return function (n) {
        return t && e(n) ? t(i(n)) : n
      }
    })
  }, function (t, n, r) {
    var e = r(6), i = r(65).onFreeze;
    r(49)("seal", function (t) {
      return function (n) {
        return t && e(n) ? t(i(n)) : n
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Object", {setPrototypeOf: r(144).set})
  }, function (t, n, r) {
    "use strict";
    var e = r(114), i = {};
    i[r(7)("toStringTag")] = "z", i + "" != "[object z]" && r(28)(Object.prototype, "toString", function () {
      return "[object " + e(this) + "]"
    }, !0)
  }, function (t, n, r) {
    var e = r(1), i = r(178);
    e(e.G + e.F * (parseFloat != i), {parseFloat: i})
  }, function (t, n, r) {
    var e = r(1), i = r(179);
    e(e.G + e.F * (parseInt != i), {parseInt: i})
  }, function (t, n, r) {
    "use strict";
    var e, i, o, u = r(69), c = r(3), f = r(53), a = r(114), s = r(1), l = r(6), h = r(26), v = r(68), p = r(79),
      d = r(146), y = r(151).set, g = r(143)(), b = "Promise", m = c.TypeError, x = c.process, w = c[b], x = c.process,
      S = "process" == a(x), _ = function () {
      }, O = !!function () {
        try {
          var t = w.resolve(1), n = (t.constructor = {})[r(7)("species")] = function (t) {
            t(_, _)
          };
          return (S || "function" == typeof PromiseRejectionEvent) && t.then(_) instanceof n
        } catch (t) {
        }
      }(), E = function (t, n) {
        return t === n || t === w && n === o
      }, P = function (t) {
        var n;
        return !(!l(t) || "function" != typeof(n = t.then)) && n
      }, j = function (t) {
        return E(w, t) ? new F(t) : new i(t)
      }, F = i = function (t) {
        var n, r;
        this.promise = new t(function (t, e) {
          if (void 0 !== n || void 0 !== r) throw m("Bad Promise constructor");
          n = t, r = e
        }), this.resolve = h(n), this.reject = h(r)
      }, M = function (t) {
        try {
          t()
        } catch (t) {
          return {error: t}
        }
      }, A = function (t, n) {
        if (!t._n) {
          t._n = !0;
          var r = t._c;
          g(function () {
            for (var e = t._v, i = 1 == t._s, o = 0; r.length > o;) !function (n) {
              var r, o, u = i ? n.ok : n.fail, c = n.resolve, f = n.reject, a = n.domain;
              try {
                u ? (i || (2 == t._h && I(t), t._h = 1), !0 === u ? r = e : (a && a.enter(), r = u(e), a && a.exit()), r === n.promise ? f(m("Promise-chain cycle")) : (o = P(r)) ? o.call(r, c, f) : c(r)) : f(e)
              } catch (t) {
                f(t)
              }
            }(r[o++]);
            t._c = [], t._n = !1, n && !t._h && N(t)
          })
        }
      }, N = function (t) {
        y.call(c, function () {
          var n, r, e, i = t._v;
          if (T(t) && (n = M(function () {
              S ? x.emit("unhandledRejection", i, t) : (r = c.onunhandledrejection) ? r({
                promise: t,
                reason: i
              }) : (e = c.console) && e.error && e.error("Unhandled promise rejection", i)
            }), t._h = S || T(t) ? 2 : 1), t._a = void 0, n) throw n.error
        })
      }, T = function (t) {
        if (1 == t._h) return !1;
        for (var n, r = t._a || t._c, e = 0; r.length > e;) if (n = r[e++], n.fail || !T(n.promise)) return !1;
        return !0
      }, I = function (t) {
        y.call(c, function () {
          var n;
          S ? x.emit("rejectionHandled", t) : (n = c.onrejectionhandled) && n({promise: t, reason: t._v})
        })
      }, k = function (t) {
        var n = this;
        n._d || (n._d = !0, n = n._w || n, n._v = t, n._s = 2, n._a || (n._a = n._c.slice()), A(n, !0))
      }, L = function (t) {
        var n, r = this;
        if (!r._d) {
          r._d = !0, r = r._w || r;
          try {
            if (r === t) throw m("Promise can't be resolved itself");
            (n = P(t)) ? g(function () {
              var e = {_w: r, _d: !1};
              try {
                n.call(t, f(L, e, 1), f(k, e, 1))
              } catch (t) {
                k.call(e, t)
              }
            }) : (r._v = t, r._s = 1, A(r, !1))
          } catch (t) {
            k.call({_w: r, _d: !1}, t)
          }
        }
      };
    O || (w = function (t) {
      v(this, w, b, "_h"), h(t), e.call(this);
      try {
        t(f(L, this, 1), f(k, this, 1))
      } catch (t) {
        k.call(this, t)
      }
    }, e = function (t) {
      this._c = [], this._a = void 0, this._s = 0, this._d = !1, this._v = void 0, this._h = 0, this._n = !1
    }, e.prototype = r(73)(w.prototype, {
      then: function (t, n) {
        var r = j(d(this, w));
        return r.ok = "function" != typeof t || t, r.fail = "function" == typeof n && n, r.domain = S ? x.domain : void 0, this._c.push(r), this._a && this._a.push(r), this._s && A(this, !1), r.promise
      }, catch: function (t) {
        return this.then(void 0, t)
      }
    }), F = function () {
      var t = new e;
      this.promise = t, this.resolve = f(L, t, 1), this.reject = f(k, t, 1)
    }), s(s.G + s.W + s.F * !O, {Promise: w}), r(81)(w, b), r(74)(b), o = r(52)[b], s(s.S + s.F * !O, b, {
      reject: function (t) {
        var n = j(this);
        return (0, n.reject)(t), n.promise
      }
    }), s(s.S + s.F * (u || !O), b, {
      resolve: function (t) {
        if (t instanceof w && E(t.constructor, this)) return t;
        var n = j(this);
        return (0, n.resolve)(t), n.promise
      }
    }), s(s.S + s.F * !(O && r(123)(function (t) {
      w.all(t).catch(_)
    })), b, {
      all: function (t) {
        var n = this, r = j(n), e = r.resolve, i = r.reject, o = M(function () {
          var r = [], o = 0, u = 1;
          p(t, !1, function (t) {
            var c = o++, f = !1;
            r.push(void 0), u++, n.resolve(t).then(function (t) {
              f || (f = !0, r[c] = t, --u || e(r))
            }, i)
          }), --u || e(r)
        });
        return o && i(o.error), r.promise
      }, race: function (t) {
        var n = this, r = j(n), e = r.reject, i = M(function () {
          p(t, !1, function (t) {
            n.resolve(t).then(r.resolve, e)
          })
        });
        return i && e(i.error), r.promise
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(26), o = r(2), u = (r(3).Reflect || {}).apply, c = Function.apply;
    e(e.S + e.F * !r(4)(function () {
      u(function () {
      })
    }), "Reflect", {
      apply: function (t, n, r) {
        var e = i(t), f = o(r);
        return u ? u(e, n, f) : c.call(e, n, f)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(70), o = r(26), u = r(2), c = r(6), f = r(4), a = r(163), s = (r(3).Reflect || {}).construct,
      l = f(function () {
        function t() {
        }

        return !(s(function () {
        }, [], t) instanceof t)
      }), h = !f(function () {
        s(function () {
        })
      });
    e(e.S + e.F * (l || h), "Reflect", {
      construct: function (t, n) {
        o(t), u(n);
        var r = arguments.length < 3 ? t : o(arguments[2]);
        if (h && !l) return s(t, n, r);
        if (t == r) {
          switch (n.length) {
            case 0:
              return new t;
            case 1:
              return new t(n[0]);
            case 2:
              return new t(n[0], n[1]);
            case 3:
              return new t(n[0], n[1], n[2]);
            case 4:
              return new t(n[0], n[1], n[2], n[3])
          }
          var e = [null];
          return e.push.apply(e, n), new (a.apply(t, e))
        }
        var f = r.prototype, v = i(c(f) ? f : Object.prototype), p = Function.apply.call(t, v, n);
        return c(p) ? p : v
      }
    })
  }, function (t, n, r) {
    var e = r(11), i = r(1), o = r(2), u = r(50);
    i(i.S + i.F * r(4)(function () {
      Reflect.defineProperty(e.f({}, 1, {value: 1}), 1, {value: 2})
    }), "Reflect", {
      defineProperty: function (t, n, r) {
        o(t), n = u(n, !0), o(r);
        try {
          return e.f(t, n, r), !0
        } catch (t) {
          return !1
        }
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(31).f, o = r(2);
    e(e.S, "Reflect", {
      deleteProperty: function (t, n) {
        var r = i(o(t), n);
        return !(r && !r.configurable) && delete t[n]
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(2), o = function (t) {
      this._t = i(t), this._i = 0;
      var n, r = this._k = [];
      for (n in t) r.push(n)
    };
    r(139)(o, "Object", function () {
      var t, n = this, r = n._k;
      do {
        if (n._i >= r.length) return {value: void 0, done: !0}
      } while (!((t = r[n._i++]) in n._t));
      return {value: t, done: !1}
    }), e(e.S, "Reflect", {
      enumerate: function (t) {
        return new o(t)
      }
    })
  }, function (t, n, r) {
    var e = r(31), i = r(1), o = r(2);
    i(i.S, "Reflect", {
      getOwnPropertyDescriptor: function (t, n) {
        return e.f(o(t), n)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(32), o = r(2);
    e(e.S, "Reflect", {
      getPrototypeOf: function (t) {
        return i(o(t))
      }
    })
  }, function (t, n, r) {
    function e(t, n) {
      var r, c, s = arguments.length < 3 ? t : arguments[2];
      return a(t) === s ? t[n] : (r = i.f(t, n)) ? u(r, "value") ? r.value : void 0 !== r.get ? r.get.call(s) : void 0 : f(c = o(t)) ? e(c, n, s) : void 0
    }

    var i = r(31), o = r(32), u = r(24), c = r(1), f = r(6), a = r(2);
    c(c.S, "Reflect", {get: e})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Reflect", {
      has: function (t, n) {
        return n in t
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(2), o = Object.isExtensible;
    e(e.S, "Reflect", {
      isExtensible: function (t) {
        return i(t), !o || o(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Reflect", {ownKeys: r(177)})
  }, function (t, n, r) {
    var e = r(1), i = r(2), o = Object.preventExtensions;
    e(e.S, "Reflect", {
      preventExtensions: function (t) {
        i(t);
        try {
          return o && o(t), !0
        } catch (t) {
          return !1
        }
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(144);
    i && e(e.S, "Reflect", {
      setPrototypeOf: function (t, n) {
        i.check(t, n);
        try {
          return i.set(t, n), !0
        } catch (t) {
          return !1
        }
      }
    })
  }, function (t, n, r) {
    function e(t, n, r) {
      var f, h, v = arguments.length < 4 ? t : arguments[3], p = o.f(s(t), n);
      if (!p) {
        if (l(h = u(t))) return e(h, n, r, v);
        p = a(0)
      }
      return c(p, "value") ? !(!1 === p.writable || !l(v) || (f = o.f(v, n) || a(0), f.value = r, i.f(v, n, f), 0)) : void 0 !== p.set && (p.set.call(v, r), !0)
    }

    var i = r(11), o = r(31), u = r(32), c = r(24), f = r(1), a = r(66), s = r(2), l = r(6);
    f(f.S, "Reflect", {set: e})
  }, function (t, n, r) {
    var e = r(3), i = r(136), o = r(11).f, u = r(71).f, c = r(122), f = r(120), a = e.RegExp, s = a, l = a.prototype,
      h = /a/g, v = /a/g, p = new a(h) !== h;
    if (r(10) && (!p || r(4)(function () {
        return v[r(7)("match")] = !1, a(h) != h || a(v) == v || "/a/i" != a(h, "i")
      }))) {
      a = function (t, n) {
        var r = this instanceof a, e = c(t), o = void 0 === n;
        return !r && e && t.constructor === a && o ? t : i(p ? new s(e && !o ? t.source : t, n) : s((e = t instanceof a) ? t.source : t, e && o ? f.call(t) : n), r ? this : l, a)
      };
      for (var d = u(s), y = 0; d.length > y;) !function (t) {
        t in a || o(a, t, {
          configurable: !0, get: function () {
            return s[t]
          }, set: function (n) {
            s[t] = n
          }
        })
      }(d[y++]);
      l.constructor = a, a.prototype = l, r(28)(e, "RegExp", a)
    }
    r(74)("RegExp")
  }, function (t, n, r) {
    r(119)("match", 1, function (t, n, r) {
      return [function (r) {
        "use strict";
        var e = t(this), i = void 0 == r ? void 0 : r[n];
        return void 0 !== i ? i.call(r, e) : new RegExp(r)[n](String(e))
      }, r]
    })
  }, function (t, n, r) {
    r(119)("replace", 2, function (t, n, r) {
      return [function (e, i) {
        "use strict";
        var o = t(this), u = void 0 == e ? void 0 : e[n];
        return void 0 !== u ? u.call(e, o, i) : r.call(String(o), e, i)
      }, r]
    })
  }, function (t, n, r) {
    r(119)("search", 1, function (t, n, r) {
      return [function (r) {
        "use strict";
        var e = t(this), i = void 0 == r ? void 0 : r[n];
        return void 0 !== i ? i.call(r, e) : new RegExp(r)[n](String(e))
      }, r]
    })
  }, function (t, n, r) {
    r(119)("split", 2, function (t, n, e) {
      "use strict";
      var i = r(122), o = e, u = [].push, c = "split", f = "length", a = "lastIndex";
      if ("c" == "abbc"[c](/(b)*/)[1] || 4 != "test"[c](/(?:)/, -1)[f] || 2 != "ab"[c](/(?:ab)*/)[f] || 4 != "."[c](/(.?)(.?)/)[f] || "."[c](/()()/)[f] > 1 || ""[c](/.?/)[f]) {
        var s = void 0 === /()??/.exec("")[1];
        e = function (t, n) {
          var r = String(this);
          if (void 0 === t && 0 === n) return [];
          if (!i(t)) return o.call(r, t, n);
          var e, c, l, h, v, p = [],
            d = (t.ignoreCase ? "i" : "") + (t.multiline ? "m" : "") + (t.unicode ? "u" : "") + (t.sticky ? "y" : ""),
            y = 0, g = void 0 === n ? 4294967295 : n >>> 0, b = new RegExp(t.source, d + "g");
          for (s || (e = new RegExp("^" + b.source + "$(?!\\s)", d)); (c = b.exec(r)) && !((l = c.index + c[0][f]) > y && (p.push(r.slice(y, c.index)), !s && c[f] > 1 && c[0].replace(e, function () {
            for (v = 1; v < arguments[f] - 2; v++) void 0 === arguments[v] && (c[v] = void 0)
          }), c[f] > 1 && c.index < r[f] && u.apply(p, c.slice(1)), h = c[0][f], y = l, p[f] >= g));) b[a] === c.index && b[a]++;
          return y === r[f] ? !h && b.test("") || p.push("") : p.push(r.slice(y)), p[f] > g ? p.slice(0, g) : p
        }
      } else "0"[c](void 0, 0)[f] && (e = function (t, n) {
        return void 0 === t && 0 === n ? [] : o.call(this, t, n)
      });
      return [function (r, i) {
        var o = t(this), u = void 0 == r ? void 0 : r[n];
        return void 0 !== u ? u.call(r, o, i) : e.call(String(o), r, i)
      }, e]
    })
  }, function (t, n, r) {
    "use strict";
    r(184);
    var e = r(2), i = r(120), o = r(10), u = "toString", c = /./[u], f = function (t) {
      r(28)(RegExp.prototype, u, t, !0)
    };
    r(4)(function () {
      return "/a/b" != c.call({source: "a", flags: "b"})
    }) ? f(function () {
      var t = e(this);
      return "/".concat(t.source, "/", "flags" in t ? t.flags : !o && t instanceof RegExp ? i.call(t) : void 0)
    }) : c.name != u && f(function () {
      return c.call(this)
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("anchor", function (t) {
      return function (n) {
        return t(this, "a", "name", n)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("big", function (t) {
      return function () {
        return t(this, "big", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("blink", function (t) {
      return function () {
        return t(this, "blink", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("bold", function (t) {
      return function () {
        return t(this, "b", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(147)(!1);
    e(e.P, "String", {
      codePointAt: function (t) {
        return i(this, t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(16), o = r(148), u = "endsWith", c = ""[u];
    e(e.P + e.F * r(134)(u), "String", {
      endsWith: function (t) {
        var n = o(this, t, u), r = arguments.length > 1 ? arguments[1] : void 0, e = i(n.length),
          f = void 0 === r ? e : Math.min(i(r), e), a = String(t);
        return c ? c.call(n, a, f) : n.slice(f - a.length, f) === a
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("fixed", function (t) {
      return function () {
        return t(this, "tt", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("fontcolor", function (t) {
      return function (n) {
        return t(this, "font", "color", n)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("fontsize", function (t) {
      return function (n) {
        return t(this, "font", "size", n)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(75), o = String.fromCharCode, u = String.fromCodePoint;
    e(e.S + e.F * (!!u && 1 != u.length), "String", {
      fromCodePoint: function (t) {
        for (var n, r = [], e = arguments.length, u = 0; e > u;) {
          if (n = +arguments[u++], i(n, 1114111) !== n) throw RangeError(n + " is not a valid code point");
          r.push(n < 65536 ? o(n) : o(55296 + ((n -= 65536) >> 10), n % 1024 + 56320))
        }
        return r.join("")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(148), o = "includes";
    e(e.P + e.F * r(134)(o), "String", {
      includes: function (t) {
        return !!~i(this, t, o).indexOf(t, arguments.length > 1 ? arguments[1] : void 0)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("italics", function (t) {
      return function () {
        return t(this, "i", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(147)(!0);
    r(140)(String, "String", function (t) {
      this._t = String(t), this._i = 0
    }, function () {
      var t, n = this._t, r = this._i;
      return r >= n.length ? {value: void 0, done: !0} : (t = e(n, r), this._i += t.length, {value: t, done: !1})
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("link", function (t) {
      return function (n) {
        return t(this, "a", "href", n)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(30), o = r(16);
    e(e.S, "String", {
      raw: function (t) {
        for (var n = i(t.raw), r = o(n.length), e = arguments.length, u = [], c = 0; r > c;) u.push(String(n[c++])), c < e && u.push(String(arguments[c]));
        return u.join("")
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P, "String", {repeat: r(149)})
  }, function (t, n, r) {
    "use strict";
    r(29)("small", function (t) {
      return function () {
        return t(this, "small", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(16), o = r(148), u = "startsWith", c = ""[u];
    e(e.P + e.F * r(134)(u), "String", {
      startsWith: function (t) {
        var n = o(this, t, u), r = i(Math.min(arguments.length > 1 ? arguments[1] : void 0, n.length)), e = String(t);
        return c ? c.call(n, e, r) : n.slice(r, r + e.length) === e
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("strike", function (t) {
      return function () {
        return t(this, "strike", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("sub", function (t) {
      return function () {
        return t(this, "sub", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(29)("sup", function (t) {
      return function () {
        return t(this, "sup", "", "")
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(82)("trim", function (t) {
      return function () {
        return t(this, 3)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(3), i = r(24), o = r(10), u = r(1), c = r(28), f = r(65).KEY, a = r(4), s = r(126), l = r(81), h = r(76),
      v = r(7), p = r(182), d = r(153), y = r(206), g = r(205), b = r(138), m = r(2), x = r(30), w = r(50), S = r(66),
      _ = r(70), O = r(174), E = r(31), P = r(11), j = r(72), F = E.f, M = P.f, A = O.f, N = e.Symbol, T = e.JSON,
      I = T && T.stringify, k = "prototype", L = v("_hidden"), R = v("toPrimitive"), C = {}.propertyIsEnumerable,
      D = s("symbol-registry"), U = s("symbols"), W = s("op-symbols"), G = Object[k], B = "function" == typeof N,
      V = e.QObject, z = !V || !V[k] || !V[k].findChild, q = o && a(function () {
        return 7 != _(M({}, "a", {
          get: function () {
            return M(this, "a", {value: 7}).a
          }
        })).a
      }) ? function (t, n, r) {
        var e = F(G, n);
        e && delete G[n], M(t, n, r), e && t !== G && M(G, n, e)
      } : M, K = function (t) {
        var n = U[t] = _(N[k]);
        return n._k = t, n
      }, J = B && "symbol" == typeof N.iterator ? function (t) {
        return "symbol" == typeof t
      } : function (t) {
        return t instanceof N
      }, Y = function (t, n, r) {
        return t === G && Y(W, n, r), m(t), n = w(n, !0), m(r), i(U, n) ? (r.enumerable ? (i(t, L) && t[L][n] && (t[L][n] = !1), r = _(r, {enumerable: S(0, !1)})) : (i(t, L) || M(t, L, S(1, {})), t[L][n] = !0), q(t, n, r)) : M(t, n, r)
      }, H = function (t, n) {
        m(t);
        for (var r, e = g(n = x(n)), i = 0, o = e.length; o > i;) Y(t, r = e[i++], n[r]);
        return t
      }, $ = function (t, n) {
        return void 0 === n ? _(t) : H(_(t), n)
      }, X = function (t) {
        var n = C.call(this, t = w(t, !0));
        return !(this === G && i(U, t) && !i(W, t)) && (!(n || !i(this, t) || !i(U, t) || i(this, L) && this[L][t]) || n)
      }, Q = function (t, n) {
        if (t = x(t), n = w(n, !0), t !== G || !i(U, n) || i(W, n)) {
          var r = F(t, n);
          return !r || !i(U, n) || i(t, L) && t[L][n] || (r.enumerable = !0), r
        }
      }, Z = function (t) {
        for (var n, r = A(x(t)), e = [], o = 0; r.length > o;) i(U, n = r[o++]) || n == L || n == f || e.push(n);
        return e
      }, tt = function (t) {
        for (var n, r = t === G, e = A(r ? W : x(t)), o = [], u = 0; e.length > u;) !i(U, n = e[u++]) || r && !i(G, n) || o.push(U[n]);
        return o
      };
    B || (N = function () {
      if (this instanceof N) throw TypeError("Symbol is not a constructor!");
      var t = h(arguments.length > 0 ? arguments[0] : void 0), n = function (r) {
        this === G && n.call(W, r), i(this, L) && i(this[L], t) && (this[L][t] = !1), q(this, t, S(1, r))
      };
      return o && z && q(G, t, {configurable: !0, set: n}), K(t)
    }, c(N[k], "toString", function () {
      return this._k
    }), E.f = Q, P.f = Y, r(71).f = O.f = Z, r(116).f = X, r(125).f = tt, o && !r(69) && c(G, "propertyIsEnumerable", X, !0), p.f = function (t) {
      return K(v(t))
    }), u(u.G + u.W + u.F * !B, {Symbol: N});
    for (var nt = "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","), rt = 0; nt.length > rt;) v(nt[rt++]);
    for (var nt = j(v.store), rt = 0; nt.length > rt;) d(nt[rt++]);
    u(u.S + u.F * !B, "Symbol", {
      for: function (t) {
        return i(D, t += "") ? D[t] : D[t] = N(t)
      }, keyFor: function (t) {
        if (J(t)) return y(D, t);
        throw TypeError(t + " is not a symbol!")
      }, useSetter: function () {
        z = !0
      }, useSimple: function () {
        z = !1
      }
    }), u(u.S + u.F * !B, "Object", {
      create: $,
      defineProperty: Y,
      defineProperties: H,
      getOwnPropertyDescriptor: Q,
      getOwnPropertyNames: Z,
      getOwnPropertySymbols: tt
    }), T && u(u.S + u.F * (!B || a(function () {
      var t = N();
      return "[null]" != I([t]) || "{}" != I({a: t}) || "{}" != I(Object(t))
    })), "JSON", {
      stringify: function (t) {
        if (void 0 !== t && !J(t)) {
          for (var n, r, e = [t], i = 1; arguments.length > i;) e.push(arguments[i++]);
          return n = e[1], "function" == typeof n && (r = n), !r && b(n) || (n = function (t, n) {
            if (r && (n = r.call(this, t, n)), !J(n)) return n
          }), e[1] = n, I.apply(T, e)
        }
      }
    }), N[k][R] || r(27)(N[k], R, N[k].valueOf), l(N, "Symbol"), l(Math, "Math", !0), l(e.JSON, "JSON", !0)
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(127), o = r(152), u = r(2), c = r(75), f = r(16), a = r(6), s = r(3).ArrayBuffer, l = r(146),
      h = o.ArrayBuffer, v = o.DataView, p = i.ABV && s.isView, d = h.prototype.slice, y = i.VIEW, g = "ArrayBuffer";
    e(e.G + e.W + e.F * (s !== h), {ArrayBuffer: h}), e(e.S + e.F * !i.CONSTR, g, {
      isView: function (t) {
        return p && p(t) || a(t) && y in t
      }
    }), e(e.P + e.U + e.F * r(4)(function () {
      return !new h(2).slice(1, void 0).byteLength
    }), g, {
      slice: function (t, n) {
        if (void 0 !== d && void 0 === n) return d.call(u(this), t);
        for (var r = u(this).byteLength, e = c(t, r), i = c(void 0 === n ? r : n, r), o = new (l(this, h))(f(i - e)), a = new v(this), s = new v(o), p = 0; e < i;) s.setUint8(p++, a.getUint8(e++));
        return o
      }
    }), r(74)(g)
  }, function (t, n, r) {
    var e = r(1);
    e(e.G + e.W + e.F * !r(127).ABV, {DataView: r(152).DataView})
  }, function (t, n, r) {
    r(55)("Float32", 4, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Float64", 8, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Int16", 2, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Int32", 4, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Int8", 1, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Uint16", 2, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Uint32", 4, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Uint8", 1, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    })
  }, function (t, n, r) {
    r(55)("Uint8", 1, function (t) {
      return function (n, r, e) {
        return t(this, n, r, e)
      }
    }, !0)
  }, function (t, n, r) {
    "use strict";
    var e = r(166);
    r(118)("WeakSet", function (t) {
      return function () {
        return t(this, arguments.length > 0 ? arguments[0] : void 0)
      }
    }, {
      add: function (t) {
        return e.def(this, t, !0)
      }
    }, e, !1, !0)
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(117)(!0);
    e(e.P, "Array", {
      includes: function (t) {
        return i(this, t, arguments.length > 1 ? arguments[1] : void 0)
      }
    }), r(78)("includes")
  }, function (t, n, r) {
    var e = r(1), i = r(143)(), o = r(3).process, u = "process" == r(45)(o);
    e(e.G, {
      asap: function (t) {
        var n = u && o.domain;
        i(n ? n.bind(t) : t)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(45);
    e(e.S, "Error", {
      isError: function (t) {
        return "Error" === i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P + e.R, "Map", {toJSON: r(165)("Map")})
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      iaddh: function (t, n, r, e) {
        var i = t >>> 0, o = n >>> 0, u = r >>> 0;
        return o + (e >>> 0) + ((i & u | (i | u) & ~(i + u >>> 0)) >>> 31) | 0
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      imulh: function (t, n) {
        var r = 65535, e = +t, i = +n, o = e & r, u = i & r, c = e >> 16, f = i >> 16,
          a = (c * u >>> 0) + (o * u >>> 16);
        return c * f + (a >> 16) + ((o * f >>> 0) + (a & r) >> 16)
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      isubh: function (t, n, r, e) {
        var i = t >>> 0, o = n >>> 0, u = r >>> 0;
        return o - (e >>> 0) - ((~i & u | ~(i ^ u) & i - u >>> 0) >>> 31) | 0
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "Math", {
      umulh: function (t, n) {
        var r = 65535, e = +t, i = +n, o = e & r, u = i & r, c = e >>> 16, f = i >>> 16,
          a = (c * u >>> 0) + (o * u >>> 16);
        return c * f + (a >>> 16) + ((o * f >>> 0) + (a & r) >>> 16)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(17), o = r(26), u = r(11);
    r(10) && e(e.P + r(124), "Object", {
      __defineGetter__: function (t, n) {
        u.f(i(this), t, {get: o(n), enumerable: !0, configurable: !0})
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(17), o = r(26), u = r(11);
    r(10) && e(e.P + r(124), "Object", {
      __defineSetter__: function (t, n) {
        u.f(i(this), t, {set: o(n), enumerable: !0, configurable: !0})
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(176)(!0);
    e(e.S, "Object", {
      entries: function (t) {
        return i(t)
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(177), o = r(30), u = r(31), c = r(131);
    e(e.S, "Object", {
      getOwnPropertyDescriptors: function (t) {
        for (var n, r = o(t), e = u.f, f = i(r), a = {}, s = 0; f.length > s;) c(a, n = f[s++], e(r, n));
        return a
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(17), o = r(50), u = r(32), c = r(31).f;
    r(10) && e(e.P + r(124), "Object", {
      __lookupGetter__: function (t) {
        var n, r = i(this), e = o(t, !0);
        do {
          if (n = c(r, e)) return n.get
        } while (r = u(r))
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(17), o = r(50), u = r(32), c = r(31).f;
    r(10) && e(e.P + r(124), "Object", {
      __lookupSetter__: function (t) {
        var n, r = i(this), e = o(t, !0);
        do {
          if (n = c(r, e)) return n.set
        } while (r = u(r))
      }
    })
  }, function (t, n, r) {
    var e = r(1), i = r(176)(!1);
    e(e.S, "Object", {
      values: function (t) {
        return i(t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(3), o = r(52), u = r(143)(), c = r(7)("observable"), f = r(26), a = r(2), s = r(68), l = r(73),
      h = r(27), v = r(79), p = v.RETURN, d = function (t) {
        return null == t ? void 0 : f(t)
      }, y = function (t) {
        var n = t._c;
        n && (t._c = void 0, n())
      }, g = function (t) {
        return void 0 === t._o
      }, b = function (t) {
        g(t) || (t._o = void 0, y(t))
      }, m = function (t, n) {
        a(t), this._c = void 0, this._o = t, t = new x(this);
        try {
          var r = n(t), e = r;
          null != r && ("function" == typeof r.unsubscribe ? r = function () {
            e.unsubscribe()
          } : f(r), this._c = r)
        } catch (n) {
          return void t.error(n)
        }
        g(this) && y(this)
      };
    m.prototype = l({}, {
      unsubscribe: function () {
        b(this)
      }
    });
    var x = function (t) {
      this._s = t
    };
    x.prototype = l({}, {
      next: function (t) {
        var n = this._s;
        if (!g(n)) {
          var r = n._o;
          try {
            var e = d(r.next);
            if (e) return e.call(r, t)
          } catch (t) {
            try {
              b(n)
            } finally {
              throw t
            }
          }
        }
      }, error: function (t) {
        var n = this._s;
        if (g(n)) throw t;
        var r = n._o;
        n._o = void 0;
        try {
          var e = d(r.error);
          if (!e) throw t;
          t = e.call(r, t)
        } catch (t) {
          try {
            y(n)
          } finally {
            throw t
          }
        }
        return y(n), t
      }, complete: function (t) {
        var n = this._s;
        if (!g(n)) {
          var r = n._o;
          n._o = void 0;
          try {
            var e = d(r.complete);
            t = e ? e.call(r, t) : void 0
          } catch (t) {
            try {
              y(n)
            } finally {
              throw t
            }
          }
          return y(n), t
        }
      }
    });
    var w = function (t) {
      s(this, w, "Observable", "_f")._f = f(t)
    };
    l(w.prototype, {
      subscribe: function (t) {
        return new m(t, this._f)
      }, forEach: function (t) {
        var n = this;
        return new (o.Promise || i.Promise)(function (r, e) {
          f(t);
          var i = n.subscribe({
            next: function (n) {
              try {
                return t(n)
              } catch (t) {
                e(t), i.unsubscribe()
              }
            }, error: e, complete: r
          })
        })
      }
    }), l(w, {
      from: function (t) {
        var n = "function" == typeof this ? this : w, r = d(a(t)[c]);
        if (r) {
          var e = a(r.call(t));
          return e.constructor === n ? e : new n(function (t) {
            return e.subscribe(t)
          })
        }
        return new n(function (n) {
          var r = !1;
          return u(function () {
            if (!r) {
              try {
                if (v(t, !1, function (t) {
                    if (n.next(t), r) return p
                  }) === p) return
              } catch (t) {
                if (r) throw t;
                return void n.error(t)
              }
              n.complete()
            }
          }), function () {
            r = !0
          }
        })
      }, of: function () {
        for (var t = 0, n = arguments.length, r = Array(n); t < n;) r[t] = arguments[t++];
        return new ("function" == typeof this ? this : w)(function (t) {
          var n = !1;
          return u(function () {
            if (!n) {
              for (var e = 0; e < r.length; ++e) if (t.next(r[e]), n) return;
              t.complete()
            }
          }), function () {
            n = !0
          }
        })
      }
    }), h(w.prototype, c, function () {
      return this
    }), e(e.G, {Observable: w}), r(74)("Observable")
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = e.key, u = e.set;
    e.exp({
      defineMetadata: function (t, n, r, e) {
        u(t, n, i(r), o(e))
      }
    })
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = e.key, u = e.map, c = e.store;
    e.exp({
      deleteMetadata: function (t, n) {
        var r = arguments.length < 3 ? void 0 : o(arguments[2]), e = u(i(n), r, !1);
        if (void 0 === e || !e.delete(t)) return !1;
        if (e.size) return !0;
        var f = c.get(n);
        return f.delete(r), !!f.size || c.delete(n)
      }
    })
  }, function (t, n, r) {
    var e = r(185), i = r(161), o = r(54), u = r(2), c = r(32), f = o.keys, a = o.key, s = function (t, n) {
      var r = f(t, n), o = c(t);
      if (null === o) return r;
      var u = s(o, n);
      return u.length ? r.length ? i(new e(r.concat(u))) : u : r
    };
    o.exp({
      getMetadataKeys: function (t) {
        return s(u(t), arguments.length < 2 ? void 0 : a(arguments[1]))
      }
    })
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = r(32), u = e.has, c = e.get, f = e.key, a = function (t, n, r) {
      if (u(t, n, r)) return c(t, n, r);
      var e = o(n);
      return null !== e ? a(t, e, r) : void 0
    };
    e.exp({
      getMetadata: function (t, n) {
        return a(t, i(n), arguments.length < 3 ? void 0 : f(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = e.keys, u = e.key;
    e.exp({
      getOwnMetadataKeys: function (t) {
        return o(i(t), arguments.length < 2 ? void 0 : u(arguments[1]))
      }
    })
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = e.get, u = e.key;
    e.exp({
      getOwnMetadata: function (t, n) {
        return o(t, i(n), arguments.length < 3 ? void 0 : u(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = r(32), u = e.has, c = e.key, f = function (t, n, r) {
      if (u(t, n, r)) return !0;
      var e = o(n);
      return null !== e && f(t, e, r)
    };
    e.exp({
      hasMetadata: function (t, n) {
        return f(t, i(n), arguments.length < 3 ? void 0 : c(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = e.has, u = e.key;
    e.exp({
      hasOwnMetadata: function (t, n) {
        return o(t, i(n), arguments.length < 3 ? void 0 : u(arguments[2]))
      }
    })
  }, function (t, n, r) {
    var e = r(54), i = r(2), o = r(26), u = e.key, c = e.set;
    e.exp({
      metadata: function (t, n) {
        return function (r, e) {
          c(t, n, (void 0 !== e ? i : o)(r), u(e))
        }
      }
    })
  }, function (t, n, r) {
    var e = r(1);
    e(e.P + e.R, "Set", {toJSON: r(165)("Set")})
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(147)(!0);
    e(e.P, "String", {
      at: function (t) {
        return i(this, t)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(46), o = r(16), u = r(122), c = r(120), f = RegExp.prototype, a = function (t, n) {
      this._r = t, this._s = n
    };
    r(139)(a, "RegExp String", function () {
      var t = this._r.exec(this._s);
      return {value: t, done: null === t}
    }), e(e.P, "String", {
      matchAll: function (t) {
        if (i(this), !u(t)) throw TypeError(t + " is not a regexp!");
        var n = String(this), r = "flags" in f ? String(t.flags) : c.call(t),
          e = new RegExp(t.source, ~r.indexOf("g") ? r : "g" + r);
        return e.lastIndex = o(t.lastIndex), new a(e, n)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(181);
    e(e.P, "String", {
      padEnd: function (t) {
        return i(this, t, arguments.length > 1 ? arguments[1] : void 0, !1)
      }
    })
  }, function (t, n, r) {
    "use strict";
    var e = r(1), i = r(181);
    e(e.P, "String", {
      padStart: function (t) {
        return i(this, t, arguments.length > 1 ? arguments[1] : void 0, !0)
      }
    })
  }, function (t, n, r) {
    "use strict";
    r(82)("trimLeft", function (t) {
      return function () {
        return t(this, 1)
      }
    }, "trimStart")
  }, function (t, n, r) {
    "use strict";
    r(82)("trimRight", function (t) {
      return function () {
        return t(this, 2)
      }
    }, "trimEnd")
  }, function (t, n, r) {
    r(153)("asyncIterator")
  }, function (t, n, r) {
    r(153)("observable")
  }, function (t, n, r) {
    var e = r(1);
    e(e.S, "System", {global: r(3)})
  }, function (t, n, r) {
    for (var e = r(155), i = r(28), o = r(3), u = r(27), c = r(80), f = r(7), a = f("iterator"), s = f("toStringTag"), l = c.Array, h = ["NodeList", "DOMTokenList", "MediaList", "StyleSheetList", "CSSRuleList"], v = 0; v < 5; v++) {
      var p, d = h[v], y = o[d], g = y && y.prototype;
      if (g) {
        g[a] || u(g, a, l), g[s] || u(g, s, d), c[d] = l;
        for (p in e) g[p] || i(g, p, e[p], !0)
      }
    }
  }, function (t, n, r) {
    var e = r(1), i = r(151);
    e(e.G + e.B, {setImmediate: i.set, clearImmediate: i.clear})
  }, function (t, n, r) {
    var e = r(3), i = r(1), o = r(121), u = r(207), c = e.navigator, f = !!c && /MSIE .\./.test(c.userAgent),
      a = function (t) {
        return f ? function (n, r) {
          return t(o(u, [].slice.call(arguments, 2), "function" == typeof n ? n : Function(n)), r)
        } : t
      };
    i(i.G + i.B + i.F * f, {setTimeout: a(e.setTimeout), setInterval: a(e.setInterval)})
  }, function (t, n, r) {
    r(330), r(269), r(271), r(270), r(273), r(275), r(280), r(274), r(272), r(282), r(281), r(277), r(278), r(276), r(268), r(279), r(283), r(284), r(236), r(238), r(237), r(286), r(285), r(256), r(266), r(267), r(257), r(258), r(259), r(260), r(261), r(262), r(263), r(264), r(265), r(239), r(240), r(241), r(242), r(243), r(244), r(245), r(246), r(247), r(248), r(249), r(250), r(251), r(252), r(253), r(254), r(255), r(317), r(322), r(329), r(320), r(312), r(313), r(318), r(323), r(325), r(308), r(309), r(310), r(311), r(314), r(315), r(316), r(319), r(321), r(324), r(326), r(327), r(328), r(231), r(233), r(232), r(235), r(234), r(220), r(218), r(224), r(221), r(227), r(229), r(217), r(223), r(214), r(228), r(212), r(226), r(225), r(219), r(222), r(211), r(213), r(216), r(215), r(230), r(155), r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports = r(52)
  }, function (t, n) {
    function r(t, n) {
      if ("string" == typeof n) return t.insertAdjacentHTML("afterend", n);
      var r = t.nextSibling;
      return r ? t.parentNode.insertBefore(n, r) : t.parentNode.appendChild(n)
    }

    t.exports = r
  }, , , , , , , , , function (t, n, r) {
    (function (n, r) {
      !function (n) {
        "use strict";

        function e(t, n, r, e) {
          var i = n && n.prototype instanceof o ? n : o, u = Object.create(i.prototype), c = new p(e || []);
          return u._invoke = s(t, r, c), u
        }

        function i(t, n, r) {
          try {
            return {type: "normal", arg: t.call(n, r)}
          } catch (t) {
            return {type: "throw", arg: t}
          }
        }

        function o() {
        }

        function u() {
        }

        function c() {
        }

        function f(t) {
          ["next", "throw", "return"].forEach(function (n) {
            t[n] = function (t) {
              return this._invoke(n, t)
            }
          })
        }

        function a(t) {
          function n(r, e, o, u) {
            var c = i(t[r], t, e);
            if ("throw" !== c.type) {
              var f = c.arg, a = f.value;
              return a && "object" == typeof a && m.call(a, "__await") ? Promise.resolve(a.__await).then(function (t) {
                n("next", t, o, u)
              }, function (t) {
                n("throw", t, o, u)
              }) : Promise.resolve(a).then(function (t) {
                f.value = t, o(f)
              }, u)
            }
            u(c.arg)
          }

          function e(t, r) {
            function e() {
              return new Promise(function (e, i) {
                n(t, r, e, i)
              })
            }

            return o = o ? o.then(e, e) : e()
          }

          "object" == typeof r && r.domain && (n = r.domain.bind(n));
          var o;
          this._invoke = e
        }

        function s(t, n, r) {
          var e = P;
          return function (o, u) {
            if (e === F) throw new Error("Generator is already running");
            if (e === M) {
              if ("throw" === o) throw u;
              return y()
            }
            for (r.method = o, r.arg = u; ;) {
              var c = r.delegate;
              if (c) {
                var f = l(c, r);
                if (f) {
                  if (f === A) continue;
                  return f
                }
              }
              if ("next" === r.method) r.sent = r._sent = r.arg; else if ("throw" === r.method) {
                if (e === P) throw e = M, r.arg;
                r.dispatchException(r.arg)
              } else "return" === r.method && r.abrupt("return", r.arg);
              e = F;
              var a = i(t, n, r);
              if ("normal" === a.type) {
                if (e = r.done ? M : j, a.arg === A) continue;
                return {value: a.arg, done: r.done}
              }
              "throw" === a.type && (e = M, r.method = "throw", r.arg = a.arg)
            }
          }
        }

        function l(t, n) {
          var r = t.iterator[n.method];
          if (r === g) {
            if (n.delegate = null, "throw" === n.method) {
              if (t.iterator.return && (n.method = "return", n.arg = g, l(t, n), "throw" === n.method)) return A;
              n.method = "throw", n.arg = new TypeError("The iterator does not provide a 'throw' method")
            }
            return A
          }
          var e = i(r, t.iterator, n.arg);
          if ("throw" === e.type) return n.method = "throw", n.arg = e.arg, n.delegate = null, A;
          var o = e.arg;
          return o ? o.done ? (n[t.resultName] = o.value, n.next = t.nextLoc, "return" !== n.method && (n.method = "next", n.arg = g), n.delegate = null, A) : o : (n.method = "throw", n.arg = new TypeError("iterator result is not an object"), n.delegate = null, A)
        }

        function h(t) {
          var n = {tryLoc: t[0]};
          1 in t && (n.catchLoc = t[1]), 2 in t && (n.finallyLoc = t[2], n.afterLoc = t[3]), this.tryEntries.push(n)
        }

        function v(t) {
          var n = t.completion || {};
          n.type = "normal", delete n.arg, t.completion = n
        }

        function p(t) {
          this.tryEntries = [{tryLoc: "root"}], t.forEach(h, this), this.reset(!0)
        }

        function d(t) {
          if (t) {
            var n = t[w];
            if (n) return n.call(t);
            if ("function" == typeof t.next) return t;
            if (!isNaN(t.length)) {
              var r = -1, e = function n() {
                for (; ++r < t.length;) if (m.call(t, r)) return n.value = t[r], n.done = !1, n;
                return n.value = g, n.done = !0, n
              };
              return e.next = e
            }
          }
          return {next: y}
        }

        function y() {
          return {value: g, done: !0}
        }

        var g, b = Object.prototype, m = b.hasOwnProperty, x = "function" == typeof Symbol ? Symbol : {},
          w = x.iterator || "@@iterator", S = x.asyncIterator || "@@asyncIterator",
          _ = x.toStringTag || "@@toStringTag", O = "object" == typeof t, E = n.regeneratorRuntime;
        if (E) return void(O && (t.exports = E));
        E = n.regeneratorRuntime = O ? t.exports : {}, E.wrap = e;
        var P = "suspendedStart", j = "suspendedYield", F = "executing", M = "completed", A = {}, N = {};
        N[w] = function () {
          return this
        };
        var T = Object.getPrototypeOf, I = T && T(T(d([])));
        I && I !== b && m.call(I, w) && (N = I);
        var k = c.prototype = o.prototype = Object.create(N);
        u.prototype = k.constructor = c, c.constructor = u, c[_] = u.displayName = "GeneratorFunction", E.isGeneratorFunction = function (t) {
          var n = "function" == typeof t && t.constructor;
          return !!n && (n === u || "GeneratorFunction" === (n.displayName || n.name))
        }, E.mark = function (t) {
          return Object.setPrototypeOf ? Object.setPrototypeOf(t, c) : (t.__proto__ = c, _ in t || (t[_] = "GeneratorFunction")), t.prototype = Object.create(k), t
        }, E.awrap = function (t) {
          return {__await: t}
        }, f(a.prototype), a.prototype[S] = function () {
          return this
        }, E.AsyncIterator = a, E.async = function (t, n, r, i) {
          var o = new a(e(t, n, r, i));
          return E.isGeneratorFunction(n) ? o : o.next().then(function (t) {
            return t.done ? t.value : o.next()
          })
        }, f(k), k[_] = "Generator", k.toString = function () {
          return "[object Generator]"
        }, E.keys = function (t) {
          var n = [];
          for (var r in t) n.push(r);
          return n.reverse(), function r() {
            for (; n.length;) {
              var e = n.pop();
              if (e in t) return r.value = e, r.done = !1, r
            }
            return r.done = !0, r
          }
        }, E.values = d, p.prototype = {
          constructor: p, reset: function (t) {
            if (this.prev = 0, this.next = 0, this.sent = this._sent = g, this.done = !1, this.delegate = null, this.method = "next", this.arg = g, this.tryEntries.forEach(v), !t) for (var n in this) "t" === n.charAt(0) && m.call(this, n) && !isNaN(+n.slice(1)) && (this[n] = g)
          }, stop: function () {
            this.done = !0;
            var t = this.tryEntries[0], n = t.completion;
            if ("throw" === n.type) throw n.arg;
            return this.rval
          }, dispatchException: function (t) {
            function n(n, e) {
              return o.type = "throw", o.arg = t, r.next = n, e && (r.method = "next", r.arg = g), !!e
            }

            if (this.done) throw t;
            for (var r = this, e = this.tryEntries.length - 1; e >= 0; --e) {
              var i = this.tryEntries[e], o = i.completion;
              if ("root" === i.tryLoc) return n("end");
              if (i.tryLoc <= this.prev) {
                var u = m.call(i, "catchLoc"), c = m.call(i, "finallyLoc");
                if (u && c) {
                  if (this.prev < i.catchLoc) return n(i.catchLoc, !0);
                  if (this.prev < i.finallyLoc) return n(i.finallyLoc)
                } else if (u) {
                  if (this.prev < i.catchLoc) return n(i.catchLoc, !0)
                } else {
                  if (!c) throw new Error("try statement without catch or finally");
                  if (this.prev < i.finallyLoc) return n(i.finallyLoc)
                }
              }
            }
          }, abrupt: function (t, n) {
            for (var r = this.tryEntries.length - 1; r >= 0; --r) {
              var e = this.tryEntries[r];
              if (e.tryLoc <= this.prev && m.call(e, "finallyLoc") && this.prev < e.finallyLoc) {
                var i = e;
                break
              }
            }
            i && ("break" === t || "continue" === t) && i.tryLoc <= n && n <= i.finallyLoc && (i = null);
            var o = i ? i.completion : {};
            return o.type = t, o.arg = n, i ? (this.method = "next", this.next = i.finallyLoc, A) : this.complete(o)
          }, complete: function (t, n) {
            if ("throw" === t.type) throw t.arg;
            return "break" === t.type || "continue" === t.type ? this.next = t.arg : "return" === t.type ? (this.rval = this.arg = t.arg, this.method = "return", this.next = "end") : "normal" === t.type && n && (this.next = n), A
          }, finish: function (t) {
            for (var n = this.tryEntries.length - 1; n >= 0; --n) {
              var r = this.tryEntries[n];
              if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), v(r), A
            }
          }, catch: function (t) {
            for (var n = this.tryEntries.length - 1; n >= 0; --n) {
              var r = this.tryEntries[n];
              if (r.tryLoc === t) {
                var e = r.completion;
                if ("throw" === e.type) {
                  var i = e.arg;
                  v(r)
                }
                return i
              }
            }
            throw new Error("illegal catch attempt")
          }, delegateYield: function (t, n, r) {
            return this.delegate = {
              iterator: d(t),
              resultName: n,
              nextLoc: r
            }, "next" === this.method && (this.arg = g), A
          }
        }
      }("object" == typeof n ? n : "object" == typeof window ? window : "object" == typeof self ? self : this)
    }).call(n, function () {
      return this
    }(), r(158))
  }])</script>
<script src="/./main.0cf68a.js"></script>
<script>!function () {
    !function (e) {
      var t = document.createElement("script");
      document.getElementsByTagName("body")[0].appendChild(t), t.setAttribute("src", e)
    }("/slider.e37972.js")
  }()</script>
  <script>pangu.spacingPage();</script>
</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 50%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
        
      
      <li style="width: 50%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="搜索文章">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">标签:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Linux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">计算机网络</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">MySQL</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">收藏</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Redis</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Spring</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">备忘录</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">读书笔记</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">密码学</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">本科毕业于电子科大，现电子科大研究生在读&lt;br&gt;坐标成都，一枚奋进的Java程序猿</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>